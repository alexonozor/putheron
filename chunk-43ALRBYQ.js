import{a as j,b as re}from"./chunk-Q4NGMJUN.js";import{A as ie,B as oe,b as q,c as Q,e as w,h as R,i as W,l as Z,m as J,p as K,r as X,s as Y,t as H,u as B,w as ee,z as te}from"./chunk-6HVQSJLB.js";import"./chunk-LIZM4CZI.js";import"./chunk-QD7SSFII.js";import{c as P}from"./chunk-CHN72C3K.js";import"./chunk-GTSDDWM5.js";import{t as $}from"./chunk-Z5YYMG7R.js";import{Aa as z,Eb as u,Fb as p,Ib as N,Jb as I,Kb as f,Lb as i,Mb as o,Nb as m,Pc as L,Ub as F,Yb as g,_a as l,_b as c,db as O,fa as T,ka as _,kc as k,la as C,lc as A,ma as y,mc as d,na as S,nc as v,oc as h,pb as G,ua as x}from"./chunk-ME5BD2TS.js";import{a as E,b as M,e as b}from"./chunk-JKOY2XUY.js";var ce=(a,t)=>t.value;function me(a,t){if(a&1&&(i(0,"div",11)(1,"div",44),y(),i(2,"svg",45),m(3,"path",46),o(),d(4),o()()),a&2){let e=c(2);l(4),h(" ",e.error()," ")}}function ge(a,t){if(a&1&&(i(0,"p",16),d(1),o()),a&2){let e=c(2);l(),v(e.getFieldError("name"))}}function ue(a,t){if(a&1&&(i(0,"p",16),d(1),o()),a&2){let e=c(2);l(),v(e.getFieldError("slug"))}}function pe(a,t){if(a&1&&(i(0,"p",16),d(1),o()),a&2){let e=c(2);l(),v(e.getFieldError("description"))}}function _e(a,t){if(a&1&&(i(0,"option",25),d(1),o()),a&2){let e=t.$implicit;f("value",e.value),l(),v(e.label)}}function Ce(a,t){if(a&1&&(i(0,"div",26),m(1,"i",47),i(2,"span"),d(3,"Preview"),o()()),a&2){let e,r=c(2);l(),A((e=r.categoryForm.get("icon"))==null?null:e.value)}}function ye(a,t){if(a&1&&(i(0,"p",16),d(1),o()),a&2){let e=c(2);l(),v(e.getFieldError("sort_order"))}}function xe(a,t){if(a&1&&(i(0,"p",16),d(1),o()),a&2){let e=c(2);l(),v(e.getFieldError("meta_title"))}}function ve(a,t){if(a&1&&(i(0,"p",16),d(1),o()),a&2){let e=c(2);l(),v(e.getFieldError("meta_description"))}}function be(a,t){if(a&1&&(i(0,"div",43),m(1,"div",48),d(2),o()),a&2){let e=c(2);l(2),h(" ",e.submitButtonText," ")}}function fe(a,t){if(a&1&&d(0),a&2){let e=c(2);h(" ",e.submitButtonText," ")}}function he(a,t){if(a&1){let e=F();i(0,"div",0)(1,"div",1),g("click",function(){_(e);let n=c();return C(n.closeModal())}),o(),i(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h3",6),d(7),o(),i(8,"button",7),g("click",function(){_(e);let n=c();return C(n.closeModal())}),y(),i(9,"svg",8),m(10,"path",9),o()()()(),S(),i(11,"form",10),g("ngSubmit",function(){_(e);let n=c();return C(n.onSubmit())}),u(12,me,5,1,"div",11),i(13,"div",12)(14,"div",13)(15,"div")(16,"label",14),d(17," Category Name * "),o(),i(18,"input",15),g("input",function(){_(e);let n=c();return C(n.onNameChange())}),o(),u(19,ge,2,1,"p",16),o(),i(20,"div")(21,"label",17),d(22," Slug * "),o(),m(23,"input",18),u(24,ue,2,1,"p",16),i(25,"p",19),d(26,"URL-friendly version of the category name"),o()()(),i(27,"div")(28,"label",20),d(29," Description "),o(),m(30,"textarea",21),u(31,pe,2,1,"p",16),o(),i(32,"div",22)(33,"div")(34,"label",23),d(35," Icon "),o(),i(36,"select",24),N(37,_e,2,2,"option",25,ce),o(),u(39,Ce,4,2,"div",26),o(),i(40,"div")(41,"label",27),d(42," Sort Order "),o(),m(43,"input",28),u(44,ye,2,1,"p",16),o(),i(45,"div")(46,"label",29),d(47," Status "),o(),i(48,"div",30),m(49,"input",31),i(50,"label",32),d(51," Active "),o()(),i(52,"p",19),d(53,"Active categories are visible to users"),o()()(),i(54,"div",33)(55,"h4",34),d(56,"SEO Information"),o(),i(57,"div",35)(58,"div")(59,"label",36),d(60," Meta Title "),o(),m(61,"input",37),u(62,xe,2,1,"p",16),i(63,"p",19),d(64),o()(),i(65,"div")(66,"label",38),d(67," Meta Description "),o(),m(68,"textarea",39),u(69,ve,2,1,"p",16),i(70,"p",19),d(71),o()()()()(),i(72,"div",40)(73,"button",41),g("click",function(){_(e);let n=c();return C(n.closeModal())}),d(74," Cancel "),o(),i(75,"button",42),u(76,be,3,1,"div",43)(77,fe,1,1),o()()()()()()}if(a&2){let e,r,n,s=c();l(7),v(s.modalTitle),l(4),f("formGroup",s.categoryForm),l(),p(s.error()?12:-1),l(6),k("border-red-500",s.getFieldError("name")),l(),p(s.getFieldError("name")?19:-1),l(4),k("border-red-500",s.getFieldError("slug")),l(),p(s.getFieldError("slug")?24:-1),l(6),k("border-red-500",s.getFieldError("description")),l(),p(s.getFieldError("description")?31:-1),l(6),I(s.iconOptions),l(2),p((e=s.categoryForm.get("icon"))!=null&&e.value?39:-1),l(4),k("border-red-500",s.getFieldError("sort_order")),l(),p(s.getFieldError("sort_order")?44:-1),l(17),k("border-red-500",s.getFieldError("meta_title")),l(),p(s.getFieldError("meta_title")?62:-1),l(2),h(" Characters: ",((r=s.categoryForm.get("meta_title"))==null||r.value==null?null:r.value.length)||0,"/200 "),l(4),k("border-red-500",s.getFieldError("meta_description")),l(),p(s.getFieldError("meta_description")?69:-1),l(2),h(" Characters: ",((n=s.categoryForm.get("meta_description"))==null||n.value==null?null:n.value.length)||0,"/300 "),l(2),f("disabled",s.loading()),l(2),f("disabled",s.categoryForm.invalid||s.loading()),l(),p(s.loading()?76:77)}}var U=class a{categoriesService=T(j);fb=T(te);isOpen=!1;category=null;isSubmitting=!1;close=new O;categoryCreated=new O;categoryUpdated=new O;categoryForm;loading=x(!1);error=x(null);iconOptions=[{value:"",label:"No Icon"},{value:"fas fa-laptop-code",label:"Technology"},{value:"fas fa-briefcase",label:"Business & Finance"},{value:"fas fa-paint-brush",label:"Creative Arts"},{value:"fas fa-heart",label:"Health & Wellness"},{value:"fas fa-graduation-cap",label:"Education & Training"},{value:"fas fa-home",label:"Home & Garden"},{value:"fas fa-car",label:"Automotive"},{value:"fas fa-utensils",label:"Food & Beverage"},{value:"fas fa-plane",label:"Travel & Tourism"},{value:"fas fa-music",label:"Entertainment"},{value:"fas fa-dumbbell",label:"Sports & Fitness"},{value:"fas fa-shopping-bag",label:"Retail & Shopping"}];constructor(){this.categoryForm=this.fb.group({name:["",[w.required,w.minLength(2),w.maxLength(100)]],slug:["",[w.required,w.minLength(2),w.maxLength(100)]],description:["",[w.maxLength(500)]],icon:[""],is_active:[!0],sort_order:[0,[w.min(0)]],meta_title:["",[w.maxLength(200)]],meta_description:["",[w.maxLength(300)]]})}ngOnInit(){this.setupForm()}ngOnChanges(t){(t.category||t.isOpen)&&this.setupForm()}setupForm(){this.category?this.categoryForm.patchValue({name:this.category.name,slug:this.category.slug,description:this.category.description||"",icon:this.category.icon||"",is_active:this.category.is_active,sort_order:this.category.sort_order||0,meta_title:this.category.meta_title||"",meta_description:this.category.meta_description||""}):this.categoryForm.reset({name:"",slug:"",description:"",icon:"",is_active:!0,sort_order:0,meta_title:"",meta_description:""}),this.error.set(null)}onNameChange(){let t=this.categoryForm.get("name"),e=this.categoryForm.get("slug");if(t&&e&&t.value&&!this.category){let r=this.categoriesService.generateSlug(t.value);e.setValue(r)}}onSubmit(){return b(this,null,function*(){if(this.categoryForm.invalid){this.categoryForm.markAllAsTouched();return}this.loading.set(!0),this.error.set(null);try{let t=this.categoryForm.value;if(this.category){let e=yield this.categoriesService.updateCategoryAsync(this.category._id,t);this.categoryUpdated.emit(e)}else{let e=yield this.categoriesService.createCategoryAsync(t);this.categoryCreated.emit(e)}this.closeModal()}catch(t){console.error("Error saving category:",t),this.error.set(t.error?.message||`Failed to ${this.category?"update":"create"} category. Please try again.`)}finally{this.loading.set(!1)}})}closeModal(){this.categoryForm.reset(),this.error.set(null),this.close.emit()}getFieldError(t){let e=this.categoryForm.get(t);if(e&&e.errors&&e.touched){if(e.errors.required)return`${this.getFieldDisplayName(t)} is required`;if(e.errors.minlength)return`${this.getFieldDisplayName(t)} must be at least ${e.errors.minlength.requiredLength} characters`;if(e.errors.maxlength)return`${this.getFieldDisplayName(t)} must not exceed ${e.errors.maxlength.requiredLength} characters`;if(e.errors.min)return`${this.getFieldDisplayName(t)} must be at least ${e.errors.min.min}`}return null}getFieldDisplayName(t){return{name:"Category name",slug:"Slug",description:"Description",sort_order:"Sort order",meta_title:"Meta title",meta_description:"Meta description"}[t]||t}get isEditMode(){return!!this.category}get modalTitle(){return this.isEditMode?"Edit Category":"Create New Category"}get submitButtonText(){return this.loading()?this.isEditMode?"Updating...":"Creating...":this.isEditMode?"Update Category":"Create Category"}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=G({type:a,selectors:[["app-category-form-modal"]],inputs:{isOpen:"isOpen",category:"category",isSubmitting:"isSubmitting"},outputs:{close:"close",categoryCreated:"categoryCreated",categoryUpdated:"categoryUpdated"},features:[z],decls:1,vars:1,consts:[["role","dialog","aria-modal","true",1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"fixed","inset-0","bg-black","bg-opacity-50","transition-opacity",3,"click"],[1,"flex","min-h-full","items-end","justify-center","p-4","text-center","sm:items-center","sm:p-0"],[1,"relative","transform","overflow-hidden","rounded-xl","bg-white","shadow-2xl","transition-all","w-full","max-w-2xl"],[1,"bg-gradient-to-r","from-blue-600","to-indigo-600","px-6","py-4"],[1,"flex","items-center","justify-between"],[1,"text-xl","font-semibold","text-white"],[1,"text-white","hover:text-gray-200","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-6",3,"ngSubmit","formGroup"],[1,"mb-6","bg-red-50","border","border-red-200","text-red-700","px-4","py-3","rounded-lg"],[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["for","name",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","id","name","formControlName","name","placeholder","Enter category name",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"input"],[1,"mt-1","text-sm","text-red-600"],["for","slug",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","id","slug","formControlName","slug","placeholder","category-slug",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all","font-mono","text-sm"],[1,"mt-1","text-xs","text-gray-500"],["for","description",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","description","formControlName","description","rows","3","placeholder","Describe this category...",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],["for","icon",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","icon","formControlName","icon",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all"],[3,"value"],[1,"mt-2","flex","items-center","gap-2","text-sm","text-gray-600"],["for","sort_order",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","number","id","sort_order","formControlName","sort_order","min","0",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"flex","items-center","pt-3"],["type","checkbox","id","is_active","formControlName","is_active",1,"w-5","h-5","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["for","is_active",1,"ml-3","text-sm","text-gray-700"],[1,"border-t","border-gray-200","pt-6"],[1,"text-lg","font-medium","text-gray-900","mb-4"],[1,"space-y-4"],["for","meta_title",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","id","meta_title","formControlName","meta_title","placeholder","SEO title for search engines",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all"],["for","meta_description",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","meta_description","formControlName","meta_description","rows","3","placeholder","SEO description for search engines",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all"],[1,"flex","items-center","justify-end","gap-4","pt-6","border-t","border-gray-200","mt-6"],["type","button",1,"px-6","py-3","border","border-gray-300","text-gray-700","rounded-lg","hover:bg-gray-50","transition-colors","font-medium",3,"click","disabled"],["type","submit",1,"px-6","py-3","bg-gradient-to-r","from-blue-600","to-indigo-600","text-white","rounded-lg","hover:shadow-lg","transition-all","duration-200","font-semibold","disabled:opacity-50","disabled:cursor-not-allowed","min-w-[140px]",3,"disabled"],[1,"flex","items-center","justify-center"],[1,"flex","items-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","mr-2"],["fill-rule","evenodd","d","M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule","evenodd"],[1,"text-lg"],[1,"animate-spin","rounded-full","h-5","w-5","border-b-2","border-white","mr-2"]],template:function(e,r){e&1&&u(0,he,78,27,"div",0),e&2&&p(r.isOpen?0:-1)},dependencies:[$,oe,Z,H,B,Q,J,q,Y,R,W,ee,K,X],encapsulation:2})};var ae=(a,t)=>t._id;function Se(a,t){if(a&1){let e=F();i(0,"div",41)(1,"button",50),g("click",function(){_(e);let n=c();return C(n.bulkToggleStatus())}),d(2),o(),i(3,"button",51),g("click",function(){_(e);let n=c();return C(n.bulkDelete())}),d(4),o(),i(5,"button",52),g("click",function(){_(e);let n=c();return C(n.deselectAllCategories())}),d(6," Clear Selection "),o()()}if(a&2){let e=c();l(2),h(" Toggle Status (",e.selectedCategories().size,") "),l(2),h(" Delete (",e.selectedCategories().size,") ")}}function we(a,t){if(a&1&&(i(0,"div",42)(1,"div",53),y(),i(2,"svg",54),m(3,"path",55),o(),d(4),o()()),a&2){let e=c();l(4),h(" ",e.error()," ")}}function Ee(a,t){a&1&&(i(0,"div",43),m(1,"div",56),i(2,"span",57),d(3,"Loading categories..."),o()())}function Me(a,t){if(a&1){let e=F();i(0,"button",64),g("click",function(){_(e);let n=c(2);return C(n.selectedCategories().size===n.filteredCategories().length?n.deselectAllCategories():n.selectAllCategories())}),d(1),o()}if(a&2){let e=c(2);l(),h(" ",e.selectedCategories().size===e.filteredCategories().length?"Deselect All":"Select All"," ")}}function Fe(a,t){if(a&1&&(i(0,"div",68),m(1,"i",85),o()),a&2){let e=c().$implicit;l(),A(e.icon)}}function ke(a,t){a&1&&(i(0,"div",68),y(),i(1,"svg",86),m(2,"path",15),o()())}function Ae(a,t){if(a&1&&(i(0,"p",69),d(1),o()),a&2){let e=c().$implicit;l(),v(e.description)}}function Te(a,t){a&1&&(y(),i(0,"svg",75),m(1,"path",87),o())}function Le(a,t){a&1&&(y(),i(0,"svg",75),m(1,"path",19),o())}function Ve(a,t){if(a&1&&(i(0,"p",94),d(1),o()),a&2){let e=c().$implicit;l(),v(e.description)}}function De(a,t){if(a&1){let e=F();i(0,"div",91)(1,"div",3)(2,"div",92)(3,"h6",93),d(4),o(),u(5,Ve,2,1,"p",94),o(),i(6,"div",95),m(7,"span"),i(8,"button",96),g("click",function(){let n=_(e).$implicit,s=c(4);return C(s.openEditSubcategoryModal(n))}),y(),i(9,"svg",97),m(10,"path",79),o()(),S(),i(11,"button",98),g("click",function(){let n=_(e).$implicit,s=c(4);return C(s.toggleSubcategoryStatus(n))}),y(),i(12,"svg",97),m(13,"path",99),o()(),S(),i(14,"button",100),g("click",function(){let n=_(e).$implicit,s=c(4);return C(s.deleteSubcategory(n._id))}),y(),i(15,"svg",97),m(16,"path",83),o()()()()()}if(a&2){let e=t.$implicit;l(4),v(e.name),l(),p(e.description?5:-1),l(2),A(e.is_active?"w-2 h-2 bg-green-400 rounded-full":"w-2 h-2 bg-red-400 rounded-full"),l(4),f("title",e.is_active?"Deactivate":"Activate")}}function Ne(a,t){if(a&1&&(i(0,"div",84)(1,"div",88)(2,"h5",89),d(3),o(),i(4,"div",90),N(5,De,17,5,"div",91,ae),o()()()),a&2){let e=c().$implicit;l(3),h(" Subcategories (",e.subcategories.length,") "),l(2),I(e.subcategories)}}function Ie(a,t){if(a&1){let e=F();i(0,"div",63)(1,"div",65)(2,"div",3)(3,"div",66)(4,"input",67),g("change",function(){let n=_(e).$implicit,s=c(2);return C(s.toggleCategorySelection(n._id))}),o(),i(5,"div",66),u(6,Fe,2,2,"div",68)(7,ke,3,0,"div",68),i(8,"div")(9,"h4",59),d(10),o(),u(11,Ae,2,1,"p",69),i(12,"div",70)(13,"span",71),d(14),o(),i(15,"span",71),d(16),o(),i(17,"span",71),d(18),o()()()()(),i(19,"div",72)(20,"span"),d(21),o(),i(22,"div",73)(23,"button",74),g("click",function(){let n=_(e).$implicit,s=c(2);return C(s.viewCategoryDetails(n._id))}),y(),i(24,"svg",75),m(25,"path",76)(26,"path",77),o()(),S(),i(27,"button",78),g("click",function(){let n=_(e).$implicit,s=c(2);return C(s.openEditCategoryModal(n))}),y(),i(28,"svg",75),m(29,"path",79),o()(),S(),i(30,"button",80),g("click",function(){let n=_(e).$implicit,s=c(2);return C(s.openCreateSubcategoryModal(n._id))}),y(),i(31,"svg",75),m(32,"path",8),o()(),S(),i(33,"button",81),g("click",function(){let n=_(e).$implicit,s=c(2);return C(s.toggleCategoryStatus(n))}),u(34,Te,2,0,":svg:svg",75)(35,Le,2,0,":svg:svg",75),o(),i(36,"button",82),g("click",function(){let n=_(e).$implicit,s=c(2);return C(s.deleteCategory(n._id))}),y(),i(37,"svg",75),m(38,"path",83),o()()()()()(),u(39,Ne,7,1,"div",84),o()}if(a&2){let e=t.$implicit,r=c(2);l(4),f("checked",r.selectedCategories().has(e._id)),l(2),p(e.icon?6:7),l(4),v(e.name),l(),p(e.description?11:-1),l(3),v(e.slug),l(2),v(r.formatDate(e.createdAt)),l(2),h("",(e.subcategories==null?null:e.subcategories.length)||0," subcategories"),l(2),A(e.is_active?"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800":"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800"),l(),h(" ",e.is_active?"Active":"Inactive"," "),l(12),A(e.is_active?"p-2 text-red-400 hover:text-red-600 transition-colors":"p-2 text-green-400 hover:text-green-600 transition-colors"),f("title",e.is_active?"Deactivate":"Activate"),l(),p(e.is_active?34:35),l(5),p(e.subcategories&&e.subcategories.length>0?39:-1)}}function Oe(a,t){if(a&1&&(i(0,"div",44)(1,"div",58)(2,"div",3)(3,"h3",59),d(4),o(),i(5,"div",60),u(6,Me,2,1,"button",61),o()()(),i(7,"div",62),N(8,Ie,40,15,"div",63,ae),o()()),a&2){let e=c();l(4),h(" Categories (",e.filteredCategories().length,") "),l(2),p(e.filteredCategories().length>0?6:-1),l(2),I(e.filteredCategories())}}function Ge(a,t){if(a&1){let e=F();i(0,"div",45),y(),i(1,"svg",101),m(2,"path",15),o(),S(),i(3,"h3",102),d(4,"No categories found"),o(),i(5,"p",103),d(6,"Get started by creating your first category."),o(),i(7,"button",104),g("click",function(){_(e);let n=c();return C(n.showCreateModal.set(!0))}),d(8," Create First Category "),o()()}}var ne=class a{categoriesService=T(j);router=T(P);categories=x([]);loading=x(!1);error=x(null);searchQuery=x("");statusFilter=x("all");sortBy=x("name");sortOrder=x("asc");selectedCategories=x(new Set);showCreateModal=x(!1);showEditModal=x(!1);showCreateSubcategoryModal=x(!1);showEditSubcategoryModal=x(!1);selectedCategoryForSub=x(null);selectedCategoryForEdit=x(null);selectedSubcategoryForEdit=x(null);filteredCategories=L(()=>{let t=this.categories();if(this.searchQuery()){let n=this.searchQuery().toLowerCase();t=t.filter(s=>s.name.toLowerCase().includes(n)||s.description?.toLowerCase().includes(n)||s.slug.toLowerCase().includes(n))}if(this.statusFilter()!=="all"){let n=this.statusFilter()==="active";t=t.filter(s=>s.is_active===n)}let e=this.sortBy(),r=this.sortOrder();return t.sort((n,s)=>{let V,D;switch(e){case"name":V=n.name.toLowerCase(),D=s.name.toLowerCase();break;case"createdAt":V=new Date(n.createdAt).getTime(),D=new Date(s.createdAt).getTime();break;case"subcategory_count":V=n.subcategories?.length||0,D=s.subcategories?.length||0;break;default:return 0}return V<D?r==="asc"?-1:1:V>D?r==="asc"?1:-1:0}),t});totalCategories=L(()=>this.categories().length);activeCategories=L(()=>this.categories().filter(t=>t.is_active).length);totalSubcategories=L(()=>this.categories().reduce((t,e)=>t+(e.subcategories?.length||0),0));categoriesForDropdown=L(()=>this.categories().map(t=>({_id:t._id,name:t.name,slug:t.slug,is_active:t.is_active,createdAt:t.createdAt,updatedAt:t.updatedAt,description:t.description,icon:t.icon,sort_order:t.sort_order,meta_title:t.meta_title,meta_description:t.meta_description})));ngOnInit(){return b(this,null,function*(){yield this.loadCategories()})}loadCategories(){return b(this,null,function*(){this.loading.set(!0),this.error.set(null);try{let t=yield this.categoriesService.getCategoriesWithSubcategories();this.categories.set(t)}catch(t){console.error("Error loading categories:",t),this.error.set("Failed to load categories. Please try again.")}finally{this.loading.set(!1)}})}viewCategoryDetails(t){this.router.navigate(["/admin/dashboard/categories",t])}openEditCategoryModal(t){this.selectedCategoryForEdit.set(t),this.showEditModal.set(!0)}onCategoryCreated(t){return b(this,null,function*(){yield this.loadCategories()})}onCategoryUpdated(t){return b(this,null,function*(){this.categories.update(e=>e.map(r=>r._id===t._id?M(E({},t),{subcategories:r.subcategories}):r))})}toggleCategoryStatus(t){return b(this,null,function*(){try{let e=yield this.categoriesService.updateCategoryAsync(t._id,{is_active:!t.is_active});this.categories.update(r=>r.map(n=>n._id===t._id?M(E({},n),{is_active:e.is_active}):n))}catch(e){console.error("Error updating category status:",e),this.error.set("Failed to update category status.")}})}deleteCategory(t){return b(this,null,function*(){if(confirm("Are you sure you want to delete this category? This action cannot be undone."))try{yield this.categoriesService.deleteCategoryAsync(t),this.categories.update(e=>e.filter(r=>r._id!==t))}catch(e){console.error("Error deleting category:",e),this.error.set("Failed to delete category. Make sure there are no associated subcategories.")}})}openCreateSubcategoryModal(t){this.selectedCategoryForSub.set(t),this.showCreateSubcategoryModal.set(!0)}openEditSubcategoryModal(t){this.selectedSubcategoryForEdit.set(t),this.showEditSubcategoryModal.set(!0)}onSubcategoryCreated(t){return b(this,null,function*(){let e=typeof t.category_id=="string"?t.category_id:t.category_id._id;this.categories.update(r=>r.map(n=>n._id===e?M(E({},n),{subcategories:[...n.subcategories||[],t]}):n))})}onSubcategoryUpdated(t){return b(this,null,function*(){let e=typeof t.category_id=="string"?t.category_id:t.category_id._id;this.categories.update(r=>r.map(n=>n._id===e?M(E({},n),{subcategories:n.subcategories?.map(s=>s._id===t._id?t:s)}):n))})}toggleSubcategoryStatus(t){return b(this,null,function*(){try{let e=yield this.categoriesService.updateSubcategoryAsync(t._id,{is_active:!t.is_active});this.categories.update(r=>r.map(n=>M(E({},n),{subcategories:n.subcategories?.map(s=>s._id===t._id?M(E({},s),{is_active:e.is_active}):s)})))}catch(e){console.error("Error updating subcategory status:",e),this.error.set("Failed to update subcategory status.")}})}deleteSubcategory(t){return b(this,null,function*(){if(confirm("Are you sure you want to delete this subcategory? This action cannot be undone."))try{yield this.categoriesService.deleteSubcategoryAsync(t),this.categories.update(e=>e.map(r=>M(E({},r),{subcategories:r.subcategories?.filter(n=>n._id!==t)})))}catch(e){console.error("Error deleting subcategory:",e),this.error.set("Failed to delete subcategory.")}})}toggleCategorySelection(t){let e=new Set(this.selectedCategories());e.has(t)?e.delete(t):e.add(t),this.selectedCategories.set(e)}selectAllCategories(){let t=this.filteredCategories().map(e=>e._id);this.selectedCategories.set(new Set(t))}deselectAllCategories(){this.selectedCategories.set(new Set)}bulkToggleStatus(){return b(this,null,function*(){let t=Array.from(this.selectedCategories());if(t.length!==0)try{let e=t.map(r=>b(this,null,function*(){let n=this.categories().find(s=>s._id===r);return n?this.categoriesService.updateCategoryAsync(r,{is_active:!n.is_active}):Promise.resolve()}));yield Promise.all(e),yield this.loadCategories(),this.selectedCategories.set(new Set)}catch(e){console.error("Error bulk updating categories:",e),this.error.set("Failed to update categories.")}})}bulkDelete(){return b(this,null,function*(){let t=Array.from(this.selectedCategories());if(t.length!==0&&confirm(`Are you sure you want to delete ${t.length} categories? This action cannot be undone.`))try{let e=t.map(r=>this.categoriesService.deleteCategoryAsync(r));yield Promise.all(e),yield this.loadCategories(),this.selectedCategories.set(new Set)}catch(e){console.error("Error bulk deleting categories:",e),this.error.set("Failed to delete categories.")}})}formatDate(t){return t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}getCategoryName(t){return this.categories().find(r=>r._id===t)?.name||"Unknown Category"}onSearchChange(t){let e=t.target;this.searchQuery.set(e.value)}onStatusFilterChange(t){let e=t.target;this.statusFilter.set(e.value)}onSortChange(t){let e=t.target,[r,n]=e.value.split("-");this.sortBy.set(r),this.sortOrder.set(n)}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=G({type:a,selectors:[["app-admin-categories-list"]],decls:80,vars:23,consts:[[1,"min-h-screen","bg-gradient-to-br","from-slate-50","via-blue-50","to-indigo-50"],[1,"p-6","max-w-7xl","mx-auto"],[1,"mb-8"],[1,"flex","items-center","justify-between"],[1,"text-3xl","font-bold","bg-gradient-to-r","from-slate-900","to-slate-700","bg-clip-text","text-transparent"],[1,"text-slate-600","mt-2"],[1,"bg-gradient-to-r","from-blue-600","to-indigo-600","text-white","px-6","py-3","rounded-xl","font-semibold","shadow-lg","hover:shadow-xl","transition-all","duration-200","transform","hover:scale-105",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","inline-block","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6","mb-8"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-6"],[1,"text-gray-500","text-sm","font-medium"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-blue-100","p-3","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"],[1,"text-3xl","font-bold","text-green-600"],[1,"bg-green-100","p-3","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-3xl","font-bold","text-purple-600"],[1,"bg-purple-100","p-3","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-purple-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 10h16M4 14h16M4 18h16"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-6","mb-6"],[1,"flex","flex-col","lg:flex-row","lg:items-center","lg:justify-between","gap-4"],[1,"flex","flex-col","sm:flex-row","gap-4","flex-1"],[1,"relative","flex-1","max-w-md"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"absolute","left-3","top-1/2","transform","-translate-y-1/2","w-5","h-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["type","text","placeholder","Search categories...",1,"pl-10","pr-4","py-3","w-full","border","border-gray-200","rounded-xl","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"input","value"],[1,"px-4","py-3","border","border-gray-200","rounded-xl","focus:ring-2","focus:ring-blue-500","focus:border-transparent","transition-all",3,"change","value"],["value","all"],["value","active"],["value","inactive"],["value","name-asc"],["value","name-desc"],["value","createdAt-desc"],["value","createdAt-asc"],["value","subcategory_count-desc"],["value","subcategory_count-asc"],[1,"flex","gap-2"],[1,"bg-red-50","border","border-red-200","text-red-700","px-4","py-3","rounded-xl","mb-6"],[1,"flex","items-center","justify-center","py-12"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","overflow-hidden"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-12","text-center"],[3,"close","categoryCreated","isOpen","category"],[3,"close","categoryUpdated","isOpen","category"],[3,"close","subcategoryCreated","isOpen","subcategory","categories","selectedCategoryId"],[3,"close","subcategoryUpdated","isOpen","subcategory","categories","selectedCategoryId"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition-all","duration-200","text-sm","font-medium",3,"click"],[1,"px-4","py-2","bg-red-600","text-white","rounded-lg","hover:bg-red-700","transition-all","duration-200","text-sm","font-medium",3,"click"],[1,"px-4","py-2","border","border-gray-300","text-gray-700","rounded-lg","hover:bg-gray-50","transition-all","duration-200","text-sm","font-medium",3,"click"],[1,"flex","items-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","mr-2"],["fill-rule","evenodd","d","M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule","evenodd"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-blue-600"],[1,"ml-3","text-gray-600"],[1,"bg-gray-50","px-6","py-4","border-b","border-gray-200"],[1,"text-lg","font-semibold","text-gray-900"],[1,"flex","items-center","gap-3"],[1,"text-sm","text-blue-600","hover:text-blue-700","font-medium","transition-colors"],[1,"overflow-x-auto"],[1,"border-b","border-gray-100","last:border-b-0"],[1,"text-sm","text-blue-600","hover:text-blue-700","font-medium","transition-colors",3,"click"],[1,"px-6","py-4","hover:bg-gray-50","transition-colors"],[1,"flex","items-center","gap-4"],["type","checkbox",1,"w-5","h-5","text-blue-600","border-gray-300","rounded","focus:ring-blue-500",3,"change","checked"],[1,"w-12","h-12","bg-gray-100","rounded-lg","flex","items-center","justify-center"],[1,"text-sm","text-gray-500","mt-1"],[1,"flex","items-center","gap-4","mt-2"],[1,"text-xs","text-gray-400"],[1,"flex","items-center","gap-2"],[1,"flex","items-center","gap-1"],["title","View Details",1,"p-2","text-gray-400","hover:text-blue-600","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["title","Edit Category",1,"p-2","text-gray-400","hover:text-green-600","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["title","Add Subcategory",1,"p-2","text-gray-400","hover:text-purple-600","transition-colors",3,"click"],[3,"click","title"],["title","Delete Category",1,"p-2","text-gray-400","hover:text-red-600","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"bg-gray-50","border-t","border-gray-100"],[1,"text-2xl","text-gray-600"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636M5.636 18.364l12.728-12.728"],[1,"px-6","py-3"],[1,"text-sm","font-medium","text-gray-700","mb-3"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-3"],[1,"bg-white","border","border-gray-200","rounded-lg","p-3","hover:border-gray-300","transition-colors"],[1,"flex-1","min-w-0"],[1,"text-sm","font-medium","text-gray-900","truncate"],[1,"text-xs","text-gray-500","mt-1","line-clamp-2"],[1,"flex","items-center","gap-1","ml-2"],["title","Edit Subcategory",1,"p-1","text-gray-400","hover:text-blue-600","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],[1,"p-1","text-gray-400","hover:text-gray-600","transition-colors",3,"click","title"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],["title","Delete Subcategory",1,"p-1","text-gray-400","hover:text-red-600","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","text-gray-300","mx-auto","mb-4"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"text-gray-500","mb-6"],[1,"bg-gradient-to-r","from-blue-600","to-indigo-600","text-white","px-6","py-3","rounded-xl","font-semibold","shadow-lg","hover:shadow-xl","transition-all","duration-200",3,"click"]],template:function(e,r){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"h1",4),d(6," Categories Management "),o(),i(7,"p",5),d(8,"Manage categories and subcategories for your platform"),o()(),i(9,"button",6),g("click",function(){return r.showCreateModal.set(!0)}),y(),i(10,"svg",7),m(11,"path",8),o(),d(12," Add Category "),o()()(),S(),i(13,"div",9)(14,"div",10)(15,"div",3)(16,"div")(17,"p",11),d(18,"Total Categories"),o(),i(19,"p",12),d(20),o()(),i(21,"div",13),y(),i(22,"svg",14),m(23,"path",15),o()()()(),S(),i(24,"div",10)(25,"div",3)(26,"div")(27,"p",11),d(28,"Active Categories"),o(),i(29,"p",16),d(30),o()(),i(31,"div",17),y(),i(32,"svg",18),m(33,"path",19),o()()()(),S(),i(34,"div",10)(35,"div",3)(36,"div")(37,"p",11),d(38,"Total Subcategories"),o(),i(39,"p",20),d(40),o()(),i(41,"div",21),y(),i(42,"svg",22),m(43,"path",23),o()()()()(),S(),i(44,"div",24)(45,"div",25)(46,"div",26)(47,"div",27),y(),i(48,"svg",28),m(49,"path",29),o(),S(),i(50,"input",30),g("input",function(s){return r.onSearchChange(s)}),o()(),i(51,"select",31),g("change",function(s){return r.onStatusFilterChange(s)}),i(52,"option",32),d(53,"All Status"),o(),i(54,"option",33),d(55,"Active Only"),o(),i(56,"option",34),d(57,"Inactive Only"),o()(),i(58,"select",31),g("change",function(s){return r.onSortChange(s)}),i(59,"option",35),d(60,"Name A-Z"),o(),i(61,"option",36),d(62,"Name Z-A"),o(),i(63,"option",37),d(64,"Newest First"),o(),i(65,"option",38),d(66,"Oldest First"),o(),i(67,"option",39),d(68,"Most Subcategories"),o(),i(69,"option",40),d(70,"Least Subcategories"),o()()(),u(71,Se,7,2,"div",41),o()(),u(72,we,5,1,"div",42),u(73,Ee,4,0,"div",43),u(74,Oe,10,2,"div",44),u(75,Ge,9,0,"div",45),o()(),i(76,"app-category-form-modal",46),g("close",function(){return r.showCreateModal.set(!1)})("categoryCreated",function(s){return r.onCategoryCreated(s)}),o(),i(77,"app-category-form-modal",47),g("close",function(){return r.showEditModal.set(!1)})("categoryUpdated",function(s){return r.onCategoryUpdated(s)}),o(),i(78,"app-subcategory-form-modal",48),g("close",function(){return r.showCreateSubcategoryModal.set(!1)})("subcategoryCreated",function(s){return r.onSubcategoryCreated(s)}),o(),i(79,"app-subcategory-form-modal",49),g("close",function(){return r.showEditSubcategoryModal.set(!1)})("subcategoryUpdated",function(s){return r.onSubcategoryUpdated(s)}),o()),e&2&&(l(20),v(r.totalCategories()),l(10),v(r.activeCategories()),l(10),v(r.totalSubcategories()),l(10),f("value",r.searchQuery()),l(),f("value",r.statusFilter()),l(7),f("value",r.sortBy()+"-"+r.sortOrder()),l(13),p(r.selectedCategories().size>0?71:-1),l(),p(r.error()?72:-1),l(),p(r.loading()?73:-1),l(),p(!r.loading()&&r.filteredCategories().length>0?74:-1),l(),p(!r.loading()&&r.filteredCategories().length===0?75:-1),l(),f("isOpen",r.showCreateModal())("category",null),l(),f("isOpen",r.showEditModal())("category",r.selectedCategoryForEdit()),l(),f("isOpen",r.showCreateSubcategoryModal())("subcategory",null)("categories",r.categoriesForDropdown())("selectedCategoryId",r.selectedCategoryForSub()),l(),f("isOpen",r.showEditSubcategoryModal())("subcategory",r.selectedSubcategoryForEdit())("categories",r.categoriesForDropdown())("selectedCategoryId",null))},dependencies:[$,ie,H,B,U,re],encapsulation:2})};export{ne as AdminCategoriesListComponent};
