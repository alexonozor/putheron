import{a as d}from"./chunk-QD7SSFII.js";import{A as u,z as i}from"./chunk-Z5YYMG7R.js";import{Y as o,aa as l,fa as b,g as s,q as a}from"./chunk-ME5BD2TS.js";var m=class n{http=b(u);apiUrl=`${d.api.baseUrl}/admin`;_dashboardStats=new s(null);_loading=new s(!1);_error=new s(null);dashboardStats$=this._dashboardStats.asObservable();loading$=this._loading.asObservable();error$=this._error.asObservable();lastFetchTime=0;CACHE_DURATION=300*1e3;getDashboardStats(t=!1){let e=Date.now();return!t&&this._dashboardStats.value&&e-this.lastFetchTime<this.CACHE_DURATION?this._dashboardStats.asObservable().pipe(a(r=>r)):(this._loading.next(!0),this._error.next(null),this.http.get(`${this.apiUrl}/dashboard/stats`).pipe(a(r=>r.data),o(r=>{this._dashboardStats.next(r),this.lastFetchTime=e,this._loading.next(!1)})))}getTransactionAnalytics(t){let e=new i;return t?.dateFrom&&(e=e.set("dateFrom",t.dateFrom)),t?.dateTo&&(e=e.set("dateTo",t.dateTo)),this.http.get(`${this.apiUrl}/transactions/analytics`,{params:e})}getBusinessStats(){return this.http.get(`${this.apiUrl}/businesses/stats`).pipe(a(t=>t.data))}getUserStats(){return this.http.get(`${this.apiUrl}/users/stats`).pipe(a(t=>t.data))}getTransactionStats(t){let e=new i;return t?.dateFrom&&(e=e.set("dateFrom",t.dateFrom)),t?.dateTo&&(e=e.set("dateTo",t.dateTo)),this.http.get(`${this.apiUrl}/transactions/stats`,{params:e}).pipe(a(r=>r.data))}refreshStats(){return this.getDashboardStats(!0)}clearCache(){this._dashboardStats.next(null),this._loading.next(!1),this._error.next(null),this.lastFetchTime=0}handleError(t){console.error("AdminDashboardService error:",t),this._error.next(t?.message||"An error occurred"),this._loading.next(!1)}setError(t){this._error.next(t),this._loading.next(!1)}getCurrentStats(){return this._dashboardStats.value}isLoading(){return this._loading.value}getCurrentError(){return this._error.value}static \u0275fac=function(e){return new(e||n)};static \u0275prov=l({token:n,factory:n.\u0275fac,providedIn:"root"})};export{m as a};
