import{a as G}from"./chunk-44CMDTXL.js";import{a as O}from"./chunk-K32BIE37.js";import{b as q}from"./chunk-RC2R7CIF.js";import{c as H}from"./chunk-4BKKR6JB.js";import"./chunk-5CVB4WWM.js";import{a as N,b as z}from"./chunk-E7JOZ5TQ.js";import{a as U,c as L,e as R,g as Y}from"./chunk-N47DSYNN.js";import"./chunk-ANF6FURW.js";import"./chunk-55W6K65S.js";import"./chunk-SGYCFQGT.js";import"./chunk-OSOLOF7I.js";import{c as P,e as A}from"./chunk-MHGTRRB4.js";import{a as j}from"./chunk-GIOQFYBX.js";import{G as $,H as D}from"./chunk-NG2F65WG.js";import"./chunk-RQP5UGHG.js";import"./chunk-YYV7O7JP.js";import{e as V}from"./chunk-BOFJA5JL.js";import{$a as m,Ba as C,Cb as x,Fb as M,Gb as k,Hb as i,Hc as T,Ib as n,Jb as f,Nb as g,Pb as _,Qb as c,Za as h,ac as a,bc as w,cc as v,cd as I,da as b,dc as F,la as d,lb as B,ma as u,qb as p,xb as y}from"./chunk-QKXNVIL2.js";import{d as E}from"./chunk-QEZ3K4DX.js";var K=(o,r)=>r._id;function Q(o,r){if(o&1){let e=g();i(0,"div",7)(1,"span",12),a(2),n(),i(3,"button",13),_("click",function(){d(e);let t=c();return u(t.searchBusinesses())}),i(4,"mat-icon",14),a(5,"search"),n(),a(6," Find More Businesses "),n()()}if(o&2){let e=c();m(2),F(" ",e.validFavorites().length," ",e.validFavorites().length===1?"favorite":"favorites"," ")}}function W(o,r){o&1&&(i(0,"div",9),f(1,"mat-spinner",15),i(2,"span",16),a(3,"Loading your favorites..."),n()())}function X(o,r){if(o&1){let e=g();i(0,"div",10)(1,"mat-icon",17),a(2,"error_outline"),n(),i(3,"h3",18),a(4,"Failed to load favorites"),n(),i(5,"p",19),a(6),n(),i(7,"button",20),_("click",function(){d(e);let t=c();return u(t.loadFavorites())}),i(8,"mat-icon",14),a(9,"refresh"),n(),a(10," Try Again "),n()()}if(o&2){let e=c();m(6),w(e.error())}}function Z(o,r){if(o&1){let e=g();i(0,"div",10)(1,"mat-icon",17),a(2,"favorite_border"),n(),i(3,"h3",18),a(4,"No favorites yet"),n(),i(5,"p",19),a(6," Start exploring and save businesses you're interested in for easy access later. "),n(),i(7,"button",20),_("click",function(){d(e);let t=c();return u(t.searchBusinesses())}),i(8,"mat-icon",14),a(9,"search"),n(),a(10," Explore Businesses "),n()()}}function ee(o,r){if(o&1&&f(0,"img",24),o&2){let e,l,t=c().$implicit,s=c(2);y("src",(e=s.getBusiness(t))==null?null:e.banner_url,h)("alt",((l=s.getBusiness(t))==null?null:l.name)+" banner")}}function te(o,r){o&1&&(i(0,"div",25)(1,"mat-icon",43),a(2,"business"),n()())}function ie(o,r){if(o&1&&f(0,"img",30),o&2){let e,l,t=c().$implicit,s=c(2);y("src",(e=s.getBusiness(t))==null?null:e.logo_url,h)("alt",((l=s.getBusiness(t))==null?null:l.name)+" logo")}}function ne(o,r){o&1&&(i(0,"div",31)(1,"mat-icon",44),a(2,"business"),n()())}function oe(o,r){if(o&1&&(i(0,"p",35)(1,"mat-icon",45),a(2,"location_on"),n(),a(3),n()),o&2){let e=c().$implicit,l=c(2);m(3),F(" ",l.getBusiness(e).city,", ",l.getBusiness(e).state," ")}}function re(o,r){if(o&1&&(i(0,"div",38)(1,"mat-icon",46),a(2,"star"),n(),i(3,"span",47),a(4),n(),i(5,"span",48),a(6),n()()),o&2){let e=c().$implicit,l=c(2);m(4),w(l.getBusiness(e).rating.toFixed(1)),m(2),v("(",l.getBusiness(e).review_count||0," reviews)")}}function ae(o,r){o&1&&(i(0,"span",39),a(1,"New business"),n())}function se(o,r){if(o&1){let e=g();i(0,"mat-card",22),_("click",function(){let t=d(e).$implicit,s=c(2);return u(s.viewBusiness(s.getBusiness(t)))}),i(1,"div",23),p(2,ee,1,2,"img",24)(3,te,3,0,"div",25),i(4,"div",26),_("click",function(t){return d(e),u(t.stopPropagation())}),f(5,"app-favorite-button",27),n()(),i(6,"div",28)(7,"div",29),p(8,ie,1,2,"img",30)(9,ne,3,0,"div",31),n()(),i(10,"mat-card-content",32)(11,"h3",33),a(12),n(),i(13,"p",34),a(14),n(),p(15,oe,4,2,"p",35),i(16,"p",36),a(17),n(),i(18,"div",37),p(19,re,7,2,"div",38)(20,ae,2,0,"span",39),n(),i(21,"div",40),a(22),n()(),i(23,"mat-card-actions",41)(24,"button",42),_("click",function(t){let s=d(e).$implicit,S=c(2);return t.stopPropagation(),u(S.viewBusiness(S.getBusiness(s)))}),i(25,"mat-icon",14),a(26,"visibility"),n(),a(27," View Details "),n()()()}if(o&2){let e,l,t=r.$implicit,s=c(2);m(2),x((e=s.getBusiness(t))!=null&&e.banner_url?2:3),m(3),y("businessId",s.getBusiness(t)._id)("businessName",s.getBusiness(t).name),m(3),x((l=s.getBusiness(t))!=null&&l.logo_url?8:9),m(4),v(" ",s.getBusiness(t).name," "),m(2),v(" ",s.getBusiness(t).category_id?s.getBusiness(t).category_id.name:"Business"," "),m(),x(s.getBusiness(t).city&&s.getBusiness(t).state?15:-1),m(2),v(" ",s.getBusiness(t).description||"Professional service provider"," "),m(2),x(s.getBusiness(t).rating&&s.getBusiness(t).rating>0?19:20),m(3),v(" Added ",s.formatDate(t.createdAt)," ")}}function le(o,r){if(o&1&&(i(0,"div",11),M(1,se,28,10,"mat-card",21,K),n()),o&2){let e=c();m(),k(e.validFavorites())}}var J=class o{favoritesService=b(O);authService=b(j);router=b(V);loading=C(!1);error=C("");favorites=this.favoritesService.userFavorites;isAuthenticated=this.authService.isAuthenticated;currentUser=this.authService.user;validFavorites=T(()=>this.favorites().filter(r=>typeof r.business_id=="object"&&r.business_id._id?!0:r.business&&r.business._id));getBusiness(r){return typeof r.business_id=="object"?r.business_id:r.business}ngOnInit(){if(!this.isAuthenticated()){this.error.set("You must be logged in to view favorites");return}this.loadFavorites()}loadFavorites(){return E(this,null,function*(){this.loading.set(!0),this.error.set("");try{yield this.favoritesService.refreshFavorites()}catch(r){console.error("Error loading favorites:",r),this.error.set(r.message||"Failed to load favorites")}finally{this.loading.set(!1)}})}viewBusiness(r){this.router.navigate(["/business",r.slug])}searchBusinesses(){this.router.navigate(["/search"])}formatDate(r){let e=new Date(r),t=Math.floor((new Date().getTime()-e.getTime())/(1e3*60*60*24));if(t===0)return"today";if(t===1)return"yesterday";if(t<7)return`${t} days ago`;if(t<30){let s=Math.floor(t/7);return`${s} ${s===1?"week":"weeks"} ago`}else return e.toLocaleDateString()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=B({type:o,selectors:[["app-favorites"]],decls:17,vars:2,consts:[[1,"min-h-screen","bg-gray-50"],[1,"bg-white","border-b","border-gray-200"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-6"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-gray-900","flex","items-center"],[1,"mr-3","text-red-500"],[1,"mt-1","text-gray-600"],[1,"flex","items-center","space-x-4"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"flex","justify-center","items-center","py-20"],[1,"text-center","py-20"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],[1,"text-sm","text-gray-500"],["mat-button","","color","primary",1,"text-blue-600","hover:text-blue-700",3,"click"],[1,"mr-2"],["diameter","40"],[1,"ml-4","text-gray-600"],[1,"text-gray-400","text-6xl","mb-4"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-600","mb-6"],["mat-raised-button","","color","primary",3,"click"],[1,"h-full","hover:shadow-lg","transition-shadow","duration-200","cursor-pointer","group"],[1,"h-full","hover:shadow-lg","transition-shadow","duration-200","cursor-pointer","group",3,"click"],[1,"relative","h-32","bg-gradient-to-br","from-gray-100","to-gray-200","overflow-hidden"],[1,"w-full","h-full","object-cover","group-hover:scale-105","transition-transform","duration-300",3,"src","alt"],[1,"w-full","h-full","bg-gradient-to-br","from-blue-400","to-purple-500","flex","items-center","justify-center"],[1,"absolute","top-3","right-3",3,"click"],["buttonClass","bg-white bg-opacity-90 hover:bg-opacity-100 rounded-full p-2 shadow-md",3,"businessId","businessName"],[1,"flex","justify-center","-mt-8","mb-4","relative","z-10"],[1,"w-16","h-16","rounded-full","bg-white","shadow-lg","ring-2","ring-white","overflow-hidden"],[1,"w-full","h-full","object-cover",3,"src","alt"],[1,"w-full","h-full","bg-gray-100","flex","items-center","justify-center"],[1,"text-center"],[1,"text-lg","font-semibold","text-gray-900","mb-1","group-hover:text-blue-600","transition-colors"],[1,"text-sm","text-gray-600","mb-2"],[1,"text-xs","text-gray-500","flex","items-center","justify-center","mb-3"],[1,"text-sm","text-gray-600","mb-4","line-clamp-2"],[1,"flex","items-center","justify-center","mb-4"],[1,"flex","items-center","gap-1"],[1,"text-xs","text-gray-500","bg-gray-100","px-2","py-1","rounded-full"],[1,"text-xs","text-gray-500","bg-gray-50","px-3","py-1","rounded-full","inline-block"],[1,"flex","justify-between","px-4","pb-4"],["mat-button","","color","primary",1,"flex-1",3,"click"],[1,"text-white","text-4xl","opacity-60"],[1,"text-gray-400"],[1,"w-4","h-4","mr-1"],[1,"text-yellow-400","text-sm"],[1,"text-sm","font-bold","text-gray-900"],[1,"text-xs","text-gray-500"]],template:function(e,l){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"h1",4)(6,"mat-icon",5),a(7,"favorite"),n(),a(8," My Favorite Businesses "),n(),i(9,"p",6),a(10," Businesses you've saved for easy access "),n()(),p(11,Q,7,2,"div",7),n()()(),i(12,"div",8),p(13,W,4,0,"div",9)(14,X,11,1,"div",10)(15,Z,11,0,"div",10)(16,le,3,0,"div",11),n()()),e&2&&(m(11),x(l.validFavorites().length>0?11:-1),m(2),x(l.loading()?13:l.error()?14:l.validFavorites().length===0?15:16))},dependencies:[I,D,$,A,P,Y,U,R,L,z,N,q,H,G],styles:[".line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}mat-card[_ngcontent-%COMP%]{border-radius:12px;overflow:hidden}mat-card-content[_ngcontent-%COMP%]{padding:0 16px 16px!important}mat-card-actions[_ngcontent-%COMP%]{margin:0!important;padding:0!important}"]})};export{J as FavoritesComponent};
