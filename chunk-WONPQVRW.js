import{h as G,k as B,r as H,s as Y,t as W,z as Q}from"./chunk-WJ56MMNB.js";import{a as $}from"./chunk-WGYCHB2O.js";import"./chunk-ZSXFIASO.js";import"./chunk-YYV7O7JP.js";import{c as J,g as U}from"./chunk-OR6HLL36.js";import"./chunk-OBTVALAJ.js";import{t as F}from"./chunk-KJIZDUX4.js";import{Bb as E,Db as V,Ea as j,Eb as T,Gb as m,Ib as D,Jb as w,Kb as k,Lb as n,Mb as o,Nb as b,Oc as v,Rb as h,Vb as p,Wb as d,cb as l,fa as P,gc as r,hc as x,ic as f,kc as R,lc as L,mc as A,na as _,nc as I,oa as g,ob as O,pa as y,qa as M,ub as u}from"./chunk-OEBJLLDW.js";import{e as C}from"./chunk-JKOY2XUY.js";var q=(a,t)=>t._id;function z(a,t){if(a&1){let e=h();n(0,"button",34),p("click",function(){_(e);let s=d();return g(s.markAllAsRead())}),r(1),o()}if(a&2){let e=d();E("disabled",e.isMarkingAllRead),l(),f(" ",e.isMarkingAllRead?"Marking...":"Mark All Read"," ")}}function K(a,t){a&1&&(n(0,"div",30),b(1,"div",35),o())}function X(a,t){if(a&1&&(n(0,"div",31),y(),n(1,"svg",36),b(2,"path",37),o(),M(),n(3,"h3",38),r(4,"No notifications found"),o(),n(5,"p",3),r(6),o()()),a&2){let e=d();l(6),x(e.getEmptyMessage())}}function Z(a,t){if(a&1&&(n(0,"span",62),r(1),o()),a&2){let e=d().$implicit,i=d(2);T(i.getPriorityBadgeClass(e.priority)),l(),f(" ",e.priority.toUpperCase()," ")}}function ee(a,t){if(a&1&&(n(0,"div",52)(1,"div",63),r(2),o(),n(3,"div",64),r(4),o()()),a&2){let e=d().$implicit;l(2),f("Project: ",e.project_id.title,""),l(2),x(e.project_id.description)}}function te(a,t){if(a&1&&(n(0,"div",53)(1,"div",65),r(2),o()()),a&2){let e=d().$implicit;l(2),f("Business: ",e.business_id.name,"")}}function ie(a,t){if(a&1&&(n(0,"div",54),r(1),o()),a&2){let e=d().$implicit;l(),R(" From: ",e.sender_id.first_name," ",e.sender_id.last_name," (",e.sender_id.email,") ")}}function ne(a,t){if(a&1&&(n(0,"span"),r(1),o()),a&2){let e=d().$implicit,i=d(2);l(),f("\u2022 Read ",i.formatTimeAgo(e.read_at),"")}}function oe(a,t){if(a&1){let e=h();n(0,"button",66),p("click",function(s){_(e);let c=d().$implicit,S=d(2);return g(S.markAsRead(c,s))}),y(),n(1,"svg",59),b(2,"path",67),o()()}}function ae(a,t){a&1&&b(0,"div",61)}function re(a,t){if(a&1){let e=h();n(0,"div",40),p("click",function(){let s=_(e).$implicit,c=d(2);return g(c.handleNotificationClick(s))}),n(1,"div",41)(2,"div",42)(3,"div",43),r(4),o()(),n(5,"div",44)(6,"div",45)(7,"div",46)(8,"div",47)(9,"h3",48),r(10),o(),u(11,Z,2,3,"span",49),n(12,"span",50),r(13),o()(),n(14,"p",51),r(15),o(),u(16,ee,5,2,"div",52)(17,te,3,1,"div",53)(18,ie,2,3,"div",54),n(19,"div",55)(20,"span"),r(21),o(),u(22,ne,2,1,"span"),o()(),n(23,"div",56),u(24,oe,3,0,"button",57),n(25,"button",58),p("click",function(s){let c=_(e).$implicit,S=d(2);return g(S.deleteNotification(c,s))}),y(),n(26,"svg",59),b(27,"path",60),o()(),u(28,ae,1,0,"div",61),o()()()()()}if(a&2){let e=t.$implicit,i=d(2);T(i.getNotificationStyles(e)),l(4),f(" ",i.getNotificationIcon(e.type)," "),l(6),f(" ",e.title," "),l(),m(e.priority!=="low"?11:-1),l(2),f(" ",i.getTypeLabel(e.type)," "),l(2),x(e.message),l(),m(e.project_id?16:-1),l(),m(e.business_id?17:-1),l(),m(e.sender_id?18:-1),l(3),x(i.formatTimeAgo(e.createdAt)),l(),m(e.is_read&&e.read_at?22:-1),l(2),m(e.is_read?-1:24),l(4),m(e.is_read?-1:28)}}function le(a,t){if(a&1&&(n(0,"div",32),w(1,re,29,14,"div",39,q),o()),a&2){let e=d();l(),k(e.paginatedNotifications())}}function se(a,t){if(a&1){let e=h();n(0,"button",72),p("click",function(){let s=_(e).$implicit,c=d(2);return g(c.goToPage(s))}),r(1),o()}if(a&2){let e=t.$implicit,i=d(2);T(e===i.currentPage()?"text-white bg-blue-600":"text-gray-500 bg-white border border-gray-300 hover:bg-gray-50"),l(),f(" ",e," ")}}function de(a,t){if(a&1){let e=h();n(0,"div",33)(1,"div",68),r(2),o(),n(3,"div",69)(4,"button",70),p("click",function(){_(e);let s=d();return g(s.goToPage(s.currentPage()-1))}),r(5," Previous "),o(),w(6,se,2,3,"button",71,D),n(8,"button",70),p("click",function(){_(e);let s=d();return g(s.goToPage(s.currentPage()+1))}),r(9," Next "),o()()()}if(a&2){let e=d();l(2),R(" Showing ",(e.currentPage()-1)*e.itemsPerPage+1," to ",e.Math.min(e.currentPage()*e.itemsPerPage,e.filteredNotifications().length)," of ",e.filteredNotifications().length," notifications "),l(2),E("disabled",e.currentPage()===1),l(2),k(e.visiblePages()),l(2),E("disabled",e.currentPage()===e.totalPages())}}var N=class a{notificationService=P($);router=P(J);selectedType="";selectedStatus="";currentPage=j(1);itemsPerPage=10;isMarkingAllRead=!1;Math=Math;notifications=this.notificationService.notifications;unreadCount=this.notificationService.unreadCount;isLoading=this.notificationService.isLoading;totalCount=v(()=>this.notifications().length);readCount=v(()=>this.notifications().filter(t=>t.is_read).length);filteredNotifications=v(()=>{let t=this.notifications();return this.selectedType&&(t=t.filter(e=>e.type===this.selectedType)),this.selectedStatus==="read"?t=t.filter(e=>e.is_read):this.selectedStatus==="unread"&&(t=t.filter(e=>!e.is_read)),t});totalPages=v(()=>Math.ceil(this.filteredNotifications().length/this.itemsPerPage));paginatedNotifications=v(()=>{let t=(this.currentPage()-1)*this.itemsPerPage,e=t+this.itemsPerPage;return this.filteredNotifications().slice(t,e)});visiblePages=v(()=>{let t=this.totalPages(),e=this.currentPage(),i=[];if(t<=7)for(let s=1;s<=t;s++)i.push(s);else if(e<=4){for(let s=1;s<=5;s++)i.push(s);i.push(-1),i.push(t)}else if(e>=t-3){i.push(1),i.push(-1);for(let s=t-4;s<=t;s++)i.push(s)}else{i.push(1),i.push(-1);for(let s=e-1;s<=e+1;s++)i.push(s);i.push(-1),i.push(t)}return i});ngOnInit(){this.loadNotifications()}loadNotifications(){return C(this,null,function*(){try{yield this.notificationService.getNotifications({limit:100,page:1})}catch(t){console.error("Error loading notifications:",t)}})}refreshNotifications(){return C(this,null,function*(){yield this.loadNotifications()})}applyFilters(){this.currentPage.set(1)}goToPage(t){t>=1&&t<=this.totalPages()&&this.currentPage.set(t)}markAllAsRead(){return C(this,null,function*(){this.isMarkingAllRead=!0;try{yield this.notificationService.markAllAsRead()}catch(t){console.error("Error marking all as read:",t)}finally{this.isMarkingAllRead=!1}})}markAsRead(t,e){return C(this,null,function*(){if(e.stopPropagation(),!t.is_read)try{yield this.notificationService.markAsRead(t._id)}catch(i){console.error("Error marking notification as read:",i)}})}deleteNotification(t,e){return C(this,null,function*(){if(e.stopPropagation(),confirm("Are you sure you want to delete this notification?"))try{yield this.notificationService.deleteNotification(t._id)}catch(i){console.error("Error deleting notification:",i)}})}handleNotificationClick(t){t.is_read||this.notificationService.markAsRead(t._id).catch(e=>{console.error("Error marking notification as read:",e)}),this.navigateFromNotification(t)}navigateFromNotification(t){switch(t.type){case"project_created":case"project_accepted":case"project_rejected":case"project_started":case"project_completed":t.project_id&&this.router.navigate(["/dashboard/projects",t.project_id._id]);break;case"payment_request":case"payment_approved":case"payment_rejected":case"completion_request":case"completion_approved":case"completion_rejected":t.metadata?.chatId?this.router.navigate(["/dashboard/messages/chat",t.metadata.chatId]):t.project_id&&this.router.navigate(["/dashboard/projects",t.project_id._id]);break;case"message_received":t.metadata?.chatId&&this.router.navigate(["/dashboard/messages/chat",t.metadata.chatId]);break;default:break}}getNotificationIcon(t){return this.notificationService.getNotificationIcon(t)}getNotificationStyles(t){let e="";return t.priority==="urgent"?e+="border-l-4 border-red-400 bg-red-50 ":t.priority==="high"?e+="border-l-4 border-orange-400 bg-orange-50 ":t.is_read||(e+="bg-blue-50 "),e}getPriorityBadgeClass(t){let e={low:"bg-gray-100 text-gray-800",medium:"bg-blue-100 text-blue-800",high:"bg-orange-100 text-orange-800",urgent:"bg-red-100 text-red-800"};return e[t]||e.medium}getTypeLabel(t){return{project_created:"Project Created",project_accepted:"Project Accepted",project_rejected:"Project Rejected",project_started:"Project Started",project_completed:"Project Completed",payment_request:"Payment Request",payment_approved:"Payment Approved",payment_rejected:"Payment Rejected",completion_request:"Completion Request",completion_approved:"Completion Approved",completion_rejected:"Completion Rejected",promotion:"Promotion",system_announcement:"Announcement",message_received:"Message"}[t]||"Notification"}formatTimeAgo(t){return this.notificationService.formatTimeAgo(t)}getEmptyMessage(){return this.selectedType&&this.selectedStatus?`No ${this.selectedStatus} notifications of type "${this.getTypeLabel(this.selectedType)}" found.`:this.selectedType?`No notifications of type "${this.getTypeLabel(this.selectedType)}" found.`:this.selectedStatus?`No ${this.selectedStatus} notifications found.`:"You don't have any notifications yet."}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=O({type:a,selectors:[["app-list-notifications"]],decls:61,vars:11,consts:[[1,"max-w-4xl","mx-auto","p-6"],[1,"mb-8"],[1,"text-3xl","font-bold","text-gray-900","mb-2"],[1,"text-gray-600"],[1,"mb-6","flex","flex-col","sm:flex-row","gap-4","items-start","sm:items-center","justify-between"],[1,"flex","flex-wrap","gap-3"],[1,"px-3","py-2","border","border-gray-300","rounded-lg","text-sm","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","ngModel"],["value",""],["value","project_created"],["value","project_accepted"],["value","project_rejected"],["value","project_started"],["value","project_completed"],["value","message_received"],["value","promotion"],["value","system_announcement"],["value","unread"],["value","read"],[1,"flex","gap-2"],[1,"px-4","py-2","text-sm","font-medium","text-blue-600","bg-blue-50","border","border-blue-200","rounded-lg","hover:bg-blue-100","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[1,"px-4","py-2","text-sm","font-medium","text-gray-600","bg-white","border","border-gray-300","rounded-lg","hover:bg-gray-50","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","inline","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"mb-6","grid","grid-cols-1","sm:grid-cols-3","gap-4"],[1,"bg-white","border","border-gray-200","rounded-lg","p-4"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"text-2xl","font-bold","text-blue-600"],[1,"text-2xl","font-bold","text-green-600"],[1,"bg-white","border","border-gray-200","rounded-lg","overflow-hidden"],[1,"flex","items-center","justify-center","py-12"],[1,"text-center","py-12"],[1,"divide-y","divide-gray-200"],[1,"mt-6","flex","items-center","justify-between"],[1,"px-4","py-2","text-sm","font-medium","text-blue-600","bg-blue-50","border","border-blue-200","rounded-lg","hover:bg-blue-100","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-blue-600"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","mx-auto","mb-4","text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 17h5l-5.5-7V7a5 5 0 00-4.5-4.5A5 5 0 005.5 7v3L0 17h5m5 0v1a3 3 0 01-6 0v-1m6 0v1a3 3 0 006 0v-1"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"p-6","hover:bg-gray-50","transition-colors","duration-200","cursor-pointer",3,"class"],[1,"p-6","hover:bg-gray-50","transition-colors","duration-200","cursor-pointer",3,"click"],[1,"flex","items-start","space-x-4"],[1,"flex-shrink-0","mt-1"],[1,"w-10","h-10","rounded-full","bg-gray-100","flex","items-center","justify-center","text-lg"],[1,"flex-1","min-w-0"],[1,"flex","items-start","justify-between"],[1,"flex-1"],[1,"flex","items-center","gap-2","mb-2"],[1,"text-lg","font-medium","text-gray-900"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium",3,"class"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-gray-100","text-gray-800"],[1,"text-gray-700","mb-3"],[1,"mb-3","p-3","bg-blue-50","rounded-lg","border","border-blue-200"],[1,"mb-3","p-3","bg-green-50","rounded-lg","border","border-green-200"],[1,"text-sm","text-gray-600","mb-3"],[1,"flex","items-center","gap-4","text-sm","text-gray-500"],[1,"flex","items-center","space-x-2","ml-4"],["title","Mark as read",1,"p-2","text-blue-600","hover:text-blue-800","hover:bg-blue-50","rounded-lg","transition-colors","duration-200"],["title","Delete notification",1,"p-2","text-red-600","hover:text-red-800","hover:bg-red-50","rounded-lg","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"w-3","h-3","bg-blue-500","rounded-full"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium"],[1,"text-sm","font-medium","text-blue-900"],[1,"text-sm","text-blue-700"],[1,"text-sm","font-medium","text-green-900"],["title","Mark as read",1,"p-2","text-blue-600","hover:text-blue-800","hover:bg-blue-50","rounded-lg","transition-colors","duration-200",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"text-sm","text-gray-700"],[1,"flex","items-center","space-x-2"],[1,"px-3","py-2","text-sm","font-medium","text-gray-500","bg-white","border","border-gray-300","rounded-md","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"px-3","py-2","text-sm","font-medium","rounded-md",3,"class"],[1,"px-3","py-2","text-sm","font-medium","rounded-md",3,"click"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),r(3,"Notifications"),o(),n(4,"p",3),r(5,"Stay updated with your projects and messages"),o()(),n(6,"div",4)(7,"div",5)(8,"select",6),I("ngModelChange",function(c){return A(i.selectedType,c)||(i.selectedType=c),c}),p("ngModelChange",function(){return i.applyFilters()}),n(9,"option",7),r(10,"All Types"),o(),n(11,"option",8),r(12,"Project Created"),o(),n(13,"option",9),r(14,"Project Accepted"),o(),n(15,"option",10),r(16,"Project Rejected"),o(),n(17,"option",11),r(18,"Project Started"),o(),n(19,"option",12),r(20,"Project Completed"),o(),n(21,"option",13),r(22,"Messages"),o(),n(23,"option",14),r(24,"Promotions"),o(),n(25,"option",15),r(26,"Announcements"),o()(),n(27,"select",6),I("ngModelChange",function(c){return A(i.selectedStatus,c)||(i.selectedStatus=c),c}),p("ngModelChange",function(){return i.applyFilters()}),n(28,"option",7),r(29,"All Status"),o(),n(30,"option",16),r(31,"Unread"),o(),n(32,"option",17),r(33,"Read"),o()()(),n(34,"div",18),u(35,z,2,2,"button",19),n(36,"button",20),p("click",function(){return i.refreshNotifications()}),y(),n(37,"svg",21),b(38,"path",22),o(),r(39," Refresh "),o()()(),M(),n(40,"div",23)(41,"div",24)(42,"div",25),r(43),o(),n(44,"div",26),r(45,"Total Notifications"),o()(),n(46,"div",24)(47,"div",27),r(48),o(),n(49,"div",26),r(50,"Unread"),o()(),n(51,"div",24)(52,"div",28),r(53),o(),n(54,"div",26),r(55,"Read"),o()()(),n(56,"div",29),u(57,K,2,0,"div",30)(58,X,7,1,"div",31)(59,le,3,0,"div",32),o(),u(60,de,10,5,"div",33),o()),e&2&&(l(8),L("ngModel",i.selectedType),l(19),L("ngModel",i.selectedStatus),l(8),m(i.unreadCount()>0?35:-1),l(),E("disabled",i.isLoading()),l(),V("animate-spin",i.isLoading()),l(6),x(i.totalCount()),l(5),x(i.unreadCount()),l(5),x(i.readCount()),l(4),m(i.isLoading()&&i.filteredNotifications().length===0?57:i.filteredNotifications().length===0?58:59),l(3),m(i.filteredNotifications().length>i.itemsPerPage?60:-1))},dependencies:[F,U,Q,Y,W,H,G,B],encapsulation:2})};var Se=[{path:"",component:N},{path:"list",redirectTo:"",pathMatch:"full"}];export{Se as NOTIFICATION_ROUTES};
