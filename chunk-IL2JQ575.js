import{a as Le,b as De,c as Ne}from"./chunk-4H2N6UBF.js";import{h as ce}from"./chunk-FY37IJMK.js";import{a as Ve,b as Be}from"./chunk-4OHTWZSD.js";import"./chunk-SNNT4QTV.js";import{d as ae,h as ke,i as Oe,j as Ie,l as Te,m as Fe}from"./chunk-3E6WONAP.js";import"./chunk-U2AVJWKL.js";import"./chunk-V5XDW2Q5.js";import{d as Me,e as we,f as Ee,k as Pe}from"./chunk-K7KKK75I.js";import{A as be,B as Se,C as ye,c as de,e as D,h as me,i as ue,m as ge,n as pe,q as _e,s as ve,u as fe,v as xe,x as Ce,y as he}from"./chunk-U7A7OHU6.js";import{a as A}from"./chunk-MNGBVTM3.js";import{a as z}from"./chunk-4GWWNNYU.js";import"./chunk-EPCACDVR.js";import"./chunk-ZKKR2XMO.js";import"./chunk-LDSTDJZ6.js";import"./chunk-QD7SSFII.js";import{a as se,b as le}from"./chunk-QFHPWKDD.js";import"./chunk-O2FJLJYH.js";import{e as ne,f as re,g as j,h as oe,l as $}from"./chunk-72SEU4B5.js";import"./chunk-JFMUERLE.js";import{n as ie,t as L}from"./chunk-FI3M32ZM.js";import{$a as l,$b as c,Fb as u,Fc as ee,Gb as g,Gc as te,Ib as F,Jb as E,Kb as P,Lb as f,Mb as i,Nb as n,Ob as m,Rc as O,Sb as Y,Tb as W,Vb as M,Ya as I,Zb as p,fa as w,jc as V,ka as _,la as v,ma as C,mc as B,na as y,nc as o,oc as b,pc as h,qb as T,qc as Z,ua as x}from"./chunk-M7BUBJMW.js";import{a as K,b as X,e as k}from"./chunk-JKOY2XUY.js";var U=class r{static \u0275fac=function(e){return new(e||r)};static \u0275cmp=T({type:r,selectors:[["app-services"]],decls:1,vars:0,template:function(e,a){e&1&&m(0,"router-outlet")},dependencies:[L,re],encapsulation:2})};var Q=(r,t)=>t._id;function Ue(r,t){r&1&&(i(0,"div",9)(1,"div",31),C(),i(2,"svg",32),m(3,"path",33),n(),y(),i(4,"div")(5,"h3",34),o(6,"No businesses found"),n(),i(7,"p",35),o(8,"You need to create a business before you can add services."),n()()()())}function Ge(r,t){if(r&1){let e=M();i(0,"button",36),p("click",function(){_(e);let s=c();return v(s.clearSearch())}),C(),i(1,"svg",37),m(2,"path",38),n()()}}function He(r,t){if(r&1&&(i(0,"option",22),o(1),n()),r&2){let e=t.$implicit;f("value",e._id),l(),b(e.name)}}function Re(r,t){if(r&1&&(i(0,"div",29)(1,"div",31),C(),i(2,"svg",39),m(3,"path",40),n(),y(),i(4,"div")(5,"h3",41),o(6,"Error"),n(),i(7,"p",42),o(8),n()()()()),r&2){let e=c();l(8),b(e.error())}}function qe(r,t){r&1&&(i(0,"div",30),m(1,"div",43),i(2,"span",44),o(3,"Loading services..."),n()())}function Ye(r,t){if(r&1){let e=M();i(0,"div",46),C(),i(1,"svg",47),m(2,"path",15),n()(),y(),i(3,"h3",48),o(4,"No services found"),n(),i(5,"p",49),o(6,"Try adjusting your search term or filter to find what you're looking for."),n(),i(7,"button",50),p("click",function(){_(e);let s=c(3);return s.clearSearch(),v(s.selectedBusiness.set("all"))}),o(8," Clear Filters "),n()}}function We(r,t){if(r&1){let e=M();i(0,"div",46),C(),i(1,"svg",47),m(2,"path",51),n()(),y(),i(3,"h3",48),o(4,"Create a business first"),n(),i(5,"p",49),o(6,"You need to have at least one business before you can create services."),n(),i(7,"button",52),p("click",function(){_(e);let s=c(3);return v(s.navigateToCreateBusiness())}),C(),i(8,"svg",53),m(9,"path",8),n(),o(10," Create Business "),n()}}function Qe(r,t){if(r&1){let e=M();i(0,"div",46),C(),i(1,"svg",47),m(2,"path",54)(3,"path",55),n()(),y(),i(4,"h3",48),o(5,"No services yet"),n(),i(6,"p",49),o(7,"Get started by creating your first service for your business."),n(),i(8,"button",52),p("click",function(){_(e);let s=c(3);return v(s.navigateToCreateService())}),C(),i(9,"svg",53),m(10,"path",8),n(),o(11," Create Your First Service "),n()}}function Je(r,t){if(r&1&&(i(0,"div",45),u(1,Ye,9,0)(2,We,11,0)(3,Qe,12,0),n()),r&2){let e=c(2);l(),g(e.searchTerm()||e.selectedBusiness()!=="all"?1:e.userBusinesses().length===0?2:3)}}function Ke(r,t){if(r&1&&m(0,"img",60),r&2){let e=c().$implicit;f("src",e.images[0],I)("alt",e.name)}}function Xe(r,t){r&1&&(i(0,"div",61),C(),i(1,"svg",78),m(2,"path",54)(3,"path",55),n()())}function Ze(r,t){r&1&&(i(0,"div",64)(1,"span",79),o(2," Featured "),n()())}function et(r,t){if(r&1&&(i(0,"span",71),o(1),n()),r&2){let e=c().$implicit;l(),b(e.duration)}}function tt(r,t){if(r&1&&(i(0,"span",81),o(1),n()),r&2){let e=t.$implicit;l(),h(" ",e," ")}}function it(r,t){if(r&1&&(i(0,"span",81),o(1),n()),r&2){let e=c(2).$implicit;l(),h(" +",e.features.length-3," more ")}}function nt(r,t){if(r&1&&(i(0,"div",66)(1,"div",80),E(2,tt,2,1,"span",81,F),u(4,it,2,1,"span",81),n()()),r&2){let e=c().$implicit;l(2),P(e.features.slice(0,3)),l(2),g(e.features.length>3?4:-1)}}function rt(r,t){if(r&1){let e=M();i(0,"div",58)(1,"div",59),u(2,Ke,1,2,"img",60)(3,Xe,4,0,"div",61),i(4,"div",62)(5,"span",63),o(6),n()(),u(7,Ze,3,0,"div",64),n(),i(8,"div",65)(9,"div",66)(10,"h3",67),o(11),n(),i(12,"p",23),o(13),n()(),i(14,"p",68),o(15),n(),i(16,"div",69)(17,"span",70),o(18),n(),u(19,et,2,1,"span",71),n(),u(20,nt,5,1,"div",66),i(21,"div",72)(22,"div",73)(23,"button",74),p("click",function(){let s=_(e).$implicit,d=c(4);return v(d.editService(s._id))}),C(),i(24,"svg",26),m(25,"path",75),n()()(),y(),i(26,"button",76),p("click",function(){let s=_(e).$implicit,d=c(4);return v(d.deleteService(s._id))}),C(),i(27,"svg",26),m(28,"path",77),n()()()()()}if(r&2){let e=t.$implicit,a=c(4);l(2),g(e.images&&e.images.length>0?2:3),l(3),B(a.getStatusColor(e.is_active)),l(),h(" ",a.getStatusText(e.is_active)," "),l(),g(e.is_featured?7:-1),l(4),b(e.name),l(2),b(a.getBusinessName(e)),l(2),h(" ",e.short_description||e.description||"No description available"," "),l(3),b(a.formatPrice(e)),l(),g(e.duration?19:-1),l(),g(e.features&&e.features.length>0?20:-1)}}function ot(r,t){if(r&1&&(i(0,"div",56),E(1,rt,29,11,"div",58,Q),n()),r&2){let e=c(3);l(),P(e.filteredServices())}}function at(r,t){if(r&1&&m(0,"img",85),r&2){let e=c().$implicit;f("src",e.images[0],I)("alt",e.name)}}function st(r,t){r&1&&(C(),i(0,"svg",86),m(1,"path",54)(2,"path",55),n())}function lt(r,t){r&1&&(i(0,"span",79),o(1," Featured "),n())}function ct(r,t){if(r&1&&(i(0,"span"),o(1,"\u2022"),n(),i(2,"span"),o(3),n()),r&2){let e=c().$implicit;l(3),b(e.duration)}}function dt(r,t){if(r&1){let e=M();i(0,"div",82)(1,"div",83)(2,"div",84),u(3,at,1,2,"img",85)(4,st,3,0,":svg:svg",86),n(),i(5,"div",87)(6,"div",88)(7,"h3",89),o(8),n(),i(9,"span",63),o(10),n(),u(11,lt,2,0,"span",79),n(),i(12,"p",90),o(13),n(),i(14,"p",91),o(15),n(),i(16,"div",92)(17,"span",70),o(18),n(),u(19,ct,4,1),i(20,"span"),o(21,"\u2022"),n(),i(22,"span"),o(23),n()()(),i(24,"div",93)(25,"button",74),p("click",function(){let s=_(e).$implicit,d=c(4);return v(d.editService(s._id))}),C(),i(26,"svg",94),m(27,"path",75),n()(),y(),i(28,"button",76),p("click",function(){let s=_(e).$implicit,d=c(4);return v(d.deleteService(s._id))}),C(),i(29,"svg",94),m(30,"path",77),n()()()()()}if(r&2){let e=t.$implicit,a=c(4);l(3),g(e.images&&e.images.length>0?3:4),l(5),b(e.name),l(),B(a.getStatusColor(e.is_active)),l(),h(" ",a.getStatusText(e.is_active)," "),l(),g(e.is_featured?11:-1),l(2),b(a.getBusinessName(e)),l(2),h(" ",e.short_description||e.description||"No description available"," "),l(3),b(a.formatPrice(e)),l(),g(e.duration?19:-1),l(4),h("Created ",a.formatDate(e.createdAt))}}function mt(r,t){if(r&1&&(i(0,"div",57),E(1,dt,31,11,"div",82,Q),n()),r&2){let e=c(3);l(),P(e.filteredServices())}}function ut(r,t){if(r&1&&(u(0,ot,3,0,"div",56),u(1,mt,3,0,"div",57)),r&2){let e=c(2);g(e.viewMode()==="grid"?0:-1),l(),g(e.viewMode()==="list"?1:-1)}}function gt(r,t){if(r&1&&u(0,Je,4,1,"div",45)(1,ut,2,2),r&2){let e=c();g(e.filteredServices().length===0?0:1)}}var G=class r{authService=w(z);router=w(j);businessService=w(A);userServices=x([]);userBusinesses=x([]);loading=x(!1);error=x(null);searchTerm=x("");viewMode=x("grid");selectedBusiness=x("all");user=this.authService.user;filteredServices=O(()=>{let t=this.userServices(),e=this.searchTerm().toLowerCase().trim(),a=this.selectedBusiness();return a!=="all"&&(t=t.filter(s=>typeof s.business_id=="string"?s.business_id===a:s.business_id._id===a)),e&&(t=t.filter(s=>s.name.toLowerCase().includes(e)||s.description?.toLowerCase().includes(e)||s.short_description?.toLowerCase().includes(e)||s.tags?.some(d=>d.toLowerCase().includes(e)))),t});ngOnInit(){if(!this.user()){this.router.navigate(["/auth"]);return}this.loadData()}loadData(){return k(this,null,function*(){this.loading.set(!0),this.error.set(null);try{let t=yield this.businessService.getMyBusinessesAsync();this.userBusinesses.set(t);let e=[];for(let a of t)try{let d=(yield this.businessService.getBusinessServicesAsync(a._id)).map(S=>X(K({},S),{business_id:a}));e=[...e,...d]}catch(s){console.warn(`Failed to load services for business ${a._id}:`,s)}this.userServices.set(e)}catch(t){console.error("Error loading services:",t),this.error.set(t.message||"Failed to load services")}finally{this.loading.set(!1)}})}setViewMode(t){this.viewMode.set(t)}onSearchChange(t){let e=t.target;this.searchTerm.set(e.value)}clearSearch(){this.searchTerm.set("")}onBusinessFilterChange(t){let e=t.target;this.selectedBusiness.set(e.value)}navigateToCreateService(){this.router.navigate(["/dashboard/services/create-service"])}navigateToCreateBusiness(){this.router.navigate(["/dashboard/businesses/create-business"])}editService(t){this.router.navigate(["/dashboard/services/edit-service",t])}deleteService(t){return k(this,null,function*(){let e=this.userServices().find(s=>s._id===t);if(!(!e||!confirm(`Are you sure you want to delete "${e.name}"? This action cannot be undone.`)))try{yield this.businessService.deleteServiceAsync(t);let s=this.userServices().filter(d=>d._id!==t);this.userServices.set(s),alert("Service deleted successfully!")}catch(s){console.error("Error deleting service:",s),alert(s.message||"Failed to delete service")}})}getBusinessName(t){return typeof t.business_id=="object"&&t.business_id?.name?t.business_id.name:"Unknown Business"}formatPrice(t){if(!t.price)return"Price not set";switch(t.pricing_type){case"hourly":return`$${t.price}/hour`;case"project":return`$${t.price}/project`;case"custom":return"Custom pricing";default:return`$${t.price}`}}formatDate(t){return new Date(t).toLocaleDateString()}getStatusColor(t){return t?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}getStatusText(t){return t?"Active":"Inactive"}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=T({type:r,selectors:[["app-list-services"]],decls:45,vars:15,consts:[[1,"min-h-screen","bg-gray-50","p-6"],[1,"max-w-7xl","mx-auto"],[1,"mb-8"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-gray-600"],[1,"inline-flex","items-center","px-4","py-2","bg-gray-900","text-white","rounded-lg","transition-colors","font-medium",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"bg-yellow-50","border-l-4","border-yellow-400","p-4","rounded-r-lg","mb-6"],[1,"bg-white","rounded-lg","border","border-gray-200","p-4"],[1,"flex","flex-col","md:flex-row","md:items-center","md:justify-between","gap-4"],[1,"relative","flex-1","max-w-md"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["type","text","placeholder","Search services...",1,"block","w-full","pl-10","pr-10","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-gray-900","focus:border-transparent",3,"input","value"],[1,"absolute","inset-y-0","right-0","pr-3","flex","items-center","text-gray-400","hover:text-gray-600"],[1,"flex","items-center","space-x-2"],["for","business-filter",1,"text-sm","text-gray-600"],["id","business-filter",1,"border","border-gray-300","rounded-lg","px-3","py-2","text-sm","focus:ring-2","focus:ring-gray-900","focus:border-transparent",3,"change","value"],["value","all"],[3,"value"],[1,"text-sm","text-gray-600"],[1,"flex","bg-gray-100","rounded-lg","p-1"],[1,"p-2","rounded-md","transition-all","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 10h16M4 14h16M4 18h16"],[1,"mb-6","bg-red-50","border-l-4","border-red-400","p-4","rounded-r-lg"],[1,"flex","items-center","justify-center","py-12"],[1,"flex"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-yellow-400","mr-3"],["fill-rule","evenodd","d","M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule","evenodd"],[1,"text-sm","font-medium","text-yellow-800"],[1,"mt-1","text-sm","text-yellow-700"],[1,"absolute","inset-y-0","right-0","pr-3","flex","items-center","text-gray-400","hover:text-gray-600",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-red-400","mr-3"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule","evenodd"],[1,"text-sm","font-medium","text-red-800"],[1,"mt-1","text-sm","text-red-700"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-gray-900"],[1,"ml-3","text-gray-600"],[1,"bg-white","rounded-xl","border","border-gray-200","p-12","text-center"],[1,"p-4","bg-gray-50","rounded-full","w-20","h-20","mx-auto","mb-6","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-10","h-10","text-gray-300"],[1,"text-xl","font-medium","text-gray-900","mb-2"],[1,"text-gray-500","mb-6"],[1,"inline-flex","items-center","px-4","py-2","border","border-gray-300","text-gray-700","rounded-lg","hover:bg-gray-50","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"],[1,"inline-flex","items-center","px-6","py-3","bg-gray-900","text-white","rounded-lg","hover:bg-gray-800","transition-colors","font-medium",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],[1,"space-y-4"],[1,"bg-white","rounded-xl","border","border-gray-200","shadow-sm","hover:shadow-lg","transition-all","duration-200","overflow-hidden"],[1,"aspect-video","bg-gray-100","relative","overflow-hidden"],[1,"w-full","h-full","object-cover",3,"src","alt"],[1,"w-full","h-full","flex","items-center","justify-center","bg-gradient-to-br","from-gray-100","to-gray-200"],[1,"absolute","top-3","right-3"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium"],[1,"absolute","top-3","left-3"],[1,"p-6"],[1,"mb-4"],[1,"text-lg","font-semibold","text-gray-900","truncate"],[1,"text-sm","text-gray-600","mb-4","line-clamp-2"],[1,"flex","items-center","justify-between","text-sm","mb-4"],[1,"font-semibold","text-lg","text-gray-900"],[1,"text-gray-500"],[1,"flex","items-center","justify-between","pt-4","border-t","border-gray-200"],[1,"flex","space-x-2"],["title","Edit Service",1,"p-2","text-gray-600","hover:text-gray-900","hover:bg-gray-100","rounded-lg","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["title","Delete Service",1,"p-2","text-red-600","hover:text-red-700","hover:bg-red-50","rounded-lg","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","text-gray-400"],[1,"bg-yellow-100","text-yellow-800","inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium"],[1,"flex","flex-wrap","gap-1"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","bg-gray-100","text-gray-800"],[1,"bg-white","rounded-lg","border","border-gray-200","p-6","hover:shadow-md","transition-all","duration-200"],[1,"flex","items-center","space-x-6"],[1,"h-16","w-16","rounded-lg","bg-gray-100","flex","items-center","justify-center","flex-shrink-0","overflow-hidden"],[1,"h-full","w-full","object-cover",3,"src","alt"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-gray-400"],[1,"flex-1","min-w-0"],[1,"flex","items-center","space-x-3","mb-2"],[1,"text-xl","font-semibold","text-gray-900","truncate"],[1,"text-sm","text-gray-600","mb-2"],[1,"text-sm","text-gray-700","line-clamp-2","mb-2"],[1,"flex","items-center","space-x-4","text-sm","text-gray-500"],[1,"flex","items-center","space-x-3","flex-shrink-0"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"]],template:function(e,a){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"h1",4),o(6,"My Services"),n(),i(7,"p",5),o(8,"Manage services across all your businesses"),n()(),i(9,"button",6),p("click",function(){return a.navigateToCreateService()}),C(),i(10,"svg",7),m(11,"path",8),n(),o(12," New Service "),n()(),u(13,Ue,9,0,"div",9),y(),i(14,"div",10)(15,"div",11)(16,"div",12)(17,"div",13),C(),i(18,"svg",14),m(19,"path",15),n()(),y(),i(20,"input",16),p("input",function(d){return a.onSearchChange(d)}),n(),u(21,Ge,3,0,"button",17),n(),i(22,"div",18)(23,"label",19),o(24,"Business:"),n(),i(25,"select",20),p("change",function(d){return a.onBusinessFilterChange(d)}),i(26,"option",21),o(27,"All Businesses"),n(),E(28,He,2,2,"option",22,Q),n()(),i(30,"div",18)(31,"span",23),o(32,"View:"),n(),i(33,"div",24)(34,"button",25),p("click",function(){return a.setViewMode("grid")}),C(),i(35,"svg",26),m(36,"path",27),n()(),y(),i(37,"button",25),p("click",function(){return a.setViewMode("list")}),C(),i(38,"svg",26),m(39,"path",28),n()()()(),y(),i(40,"div",23),o(41),n()()()(),u(42,Re,9,1,"div",29),u(43,qe,4,0,"div",30)(44,gt,2,1),n()()),e&2&&(l(9),B(a.userBusinesses().length===0?"opacity-50 cursor-not-allowed":"hover:bg-gray-800"),f("disabled",a.userBusinesses().length===0),l(4),g(a.userBusinesses().length===0?13:-1),l(7),f("value",a.searchTerm()),l(),g(a.searchTerm()?21:-1),l(4),f("value",a.selectedBusiness()),l(3),P(a.userBusinesses()),l(6),B(a.viewMode()==="grid"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"),l(3),B(a.viewMode()==="list"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"),l(4),Z(" ",a.filteredServices().length," of ",a.userServices().length," services "),l(),g(a.error()?42:-1),l(),g(a.loading()?43:44))},dependencies:[L,$,Se,fe,xe],styles:[".services-container[_ngcontent-%COMP%]{max-width:80rem;margin:0 auto;padding:1.5rem}.services-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.services-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#111827;margin:0}.services-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#6b7280;margin-top:.5rem}.services-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:1rem}.search-filter-bar[_ngcontent-%COMP%]{background-color:#fff;padding:1.5rem;border-radius:.5rem;box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f;margin-bottom:2rem}.search-filter-bar[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto auto;gap:1rem;align-items:center}@media (max-width: 768px){.search-filter-bar[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}}.search-filter-bar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{display:flex;align-items:center;position:relative}.search-filter-bar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:.75rem;height:1.25rem;width:1.25rem;color:#9ca3af}.search-filter-bar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem .75rem 2.5rem;border:1px solid #d1d5db;border-radius:.375rem;font-size:.875rem}.search-filter-bar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 2px #3b82f680}.search-filter-bar[_ngcontent-%COMP%]   .business-filter[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.75rem 1rem;border:1px solid #d1d5db;border-radius:.375rem;font-size:.875rem;background-color:#fff}.search-filter-bar[_ngcontent-%COMP%]   .business-filter[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 2px #3b82f680}.search-filter-bar[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]{display:flex;border:1px solid #d1d5db;border-radius:.375rem;overflow:hidden}.search-filter-bar[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem .75rem;border:none;background-color:#fff;color:#6b7280;cursor:pointer;display:flex;align-items:center;gap:.25rem}.search-filter-bar[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.search-filter-bar[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff}.search-filter-bar[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:1rem;width:1rem}.services-grid[_ngcontent-%COMP%]{display:grid;gap:1.5rem}.services-grid.grid-view[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(350px,1fr))}.services-grid.list-view[_ngcontent-%COMP%]{grid-template-columns:1fr}.service-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:.5rem;box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f;overflow:hidden;transition:box-shadow .2s ease-in-out}.service-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f}.service-card.list-view[_ngcontent-%COMP%]{display:flex;align-items:center;padding:1rem}.service-card.list-view[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{flex:1;display:grid;grid-template-columns:2fr 1fr 1fr auto;gap:1rem;align-items:center}.service-card.grid-view[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{padding:1.5rem}.service-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1rem}.service-header[_ngcontent-%COMP%]   .service-info[_ngcontent-%COMP%]{flex:1}.service-header[_ngcontent-%COMP%]   .service-info[_ngcontent-%COMP%]   .service-name[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#111827;margin:0 0 .25rem;line-height:1.4}.service-header[_ngcontent-%COMP%]   .service-info[_ngcontent-%COMP%]   .service-business[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;margin-bottom:.5rem}.service-header[_ngcontent-%COMP%]   .service-status[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:.25rem}.service-header[_ngcontent-%COMP%]   .service-status[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:.25rem;font-size:.75rem;font-weight:500}.service-header[_ngcontent-%COMP%]   .service-status[_ngcontent-%COMP%]   .status-badge.active[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534}.service-header[_ngcontent-%COMP%]   .service-status[_ngcontent-%COMP%]   .status-badge.inactive[_ngcontent-%COMP%]{background-color:#fef2f2;color:#dc2626}.service-header[_ngcontent-%COMP%]   .service-status[_ngcontent-%COMP%]   .status-badge.featured[_ngcontent-%COMP%]{background-color:#fef3c7;color:#92400e}.service-description[_ngcontent-%COMP%]{color:#6b7280;font-size:.875rem;line-height:1.5;margin-bottom:1rem;display:-webkit-box;-webkit-line-clamp:3;line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.service-features[_ngcontent-%COMP%]{margin-bottom:1rem}.service-features[_ngcontent-%COMP%]   .features-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.service-features[_ngcontent-%COMP%]   .features-list[_ngcontent-%COMP%]   .feature-tag[_ngcontent-%COMP%]{padding:.25rem .5rem;background-color:#eff6ff;color:#1d4ed8;font-size:.75rem;border-radius:.25rem}.service-price[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:1rem}.service-price[_ngcontent-%COMP%]   .price-amount[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:#111827}.service-price[_ngcontent-%COMP%]   .price-type[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;text-transform:capitalize}.service-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.service-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:.5rem 1rem;border-radius:.375rem;font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s ease-in-out}.service-actions[_ngcontent-%COMP%]   button.btn-primary[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff;border:1px solid #3b82f6}.service-actions[_ngcontent-%COMP%]   button.btn-primary[_ngcontent-%COMP%]:hover{background-color:#2563eb}.service-actions[_ngcontent-%COMP%]   button.btn-secondary[_ngcontent-%COMP%]{background-color:#fff;color:#374151;border:1px solid #d1d5db}.service-actions[_ngcontent-%COMP%]   button.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.service-actions[_ngcontent-%COMP%]   button.btn-danger[_ngcontent-%COMP%]{background-color:#dc2626;color:#fff;border:1px solid #dc2626}.service-actions[_ngcontent-%COMP%]   button.btn-danger[_ngcontent-%COMP%]:hover{background-color:#b91c1c}.service-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{margin:0 auto 1rem;height:4rem;width:4rem;color:#9ca3af}.empty-state[_ngcontent-%COMP%]   .empty-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#111827;margin-bottom:.5rem}.empty-state[_ngcontent-%COMP%]   .empty-description[_ngcontent-%COMP%]{color:#6b7280;margin-bottom:2rem}.loading-state[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:4rem 2rem}.loading-state[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite;border-radius:50%;height:2rem;width:2rem;border:2px solid #f3f4f6;border-top:2px solid #3b82f6}.loading-state[_ngcontent-%COMP%]   .loading-text[_ngcontent-%COMP%]{margin-left:1rem;color:#6b7280}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-state[_ngcontent-%COMP%]{background-color:#fef2f2;border:1px solid #fecaca;border-radius:.375rem;padding:1rem;margin-bottom:2rem}.error-state[_ngcontent-%COMP%]   .error-title[_ngcontent-%COMP%]{font-weight:600;color:#dc2626;margin-bottom:.5rem}.error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#b91c1c}@media (max-width: 768px){.services-container[_ngcontent-%COMP%]{padding:1rem}.services-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.services-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{width:100%;justify-content:flex-start}.services-grid.grid-view[_ngcontent-%COMP%]{grid-template-columns:1fr}.service-card.list-view[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:.75rem}.service-actions[_ngcontent-%COMP%]{flex-direction:column}.service-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:none}}"]})};var pt=(r,t)=>t._id;function _t(r,t){r&1&&(i(0,"div",3),m(1,"div",6),n())}function vt(r,t){if(r&1){let e=M();i(0,"div",4)(1,"div",7)(2,"div",8)(3,"mat-icon",9),o(4,"error_outline"),n()(),i(5,"h3",10),o(6),n(),i(7,"div",11)(8,"button",12),p("click",function(){_(e);let s=c();return v(s.goBack())}),o(9," Go Back "),n(),i(10,"button",13),p("click",function(){_(e);let s=c();return v(s.loadData())}),o(11," Try Again "),n()()()()}if(r&2){let e=c();l(6),b(e.error())}}function ft(r,t){r&1&&(i(0,"div",4)(1,"div",7)(2,"div",14)(3,"mat-icon",15),o(4,"business"),n()(),i(5,"h3",10),o(6,"No businesses found"),n(),i(7,"p",16),o(8,"You need to create a business before adding services."),n(),i(9,"button",17)(10,"mat-icon",18),o(11,"add"),n(),o(12," Create Business "),n()()())}function xt(r,t){r&1&&o(0," Update your service information and settings ")}function Ct(r,t){r&1&&o(0," Create a new service for your business ")}function ht(r,t){if(r&1&&(i(0,"mat-option",42),o(1),n()),r&2){let e=t.$implicit;f("value",e._id),l(),h(" ",e.name," ")}}function bt(r,t){r&1&&(i(0,"mat-error"),o(1,"Please select a business"),n())}function St(r,t){if(r&1&&(i(0,"mat-form-field",30)(1,"mat-label"),o(2,"Business"),n(),i(3,"mat-select",60),E(4,ht,2,2,"mat-option",42,pt),n(),u(6,bt,2,0,"mat-error"),n()),r&2){let e=c(2);l(4),P(e.userBusinesses()),l(2),g(e.business_id!=null&&e.business_id.hasError("required")&&(e.business_id!=null&&e.business_id.touched)?6:-1)}}function yt(r,t){r&1&&(i(0,"mat-error"),o(1,"Service name is required"),n())}function Mt(r,t){r&1&&(i(0,"mat-error"),o(1,"Service name must be at least 2 characters"),n())}function wt(r,t){r&1&&(i(0,"mat-error"),o(1,"Service name cannot exceed 100 characters"),n())}function Et(r,t){r&1&&(i(0,"mat-error"),o(1,"Price cannot be negative"),n())}function Pt(r,t){if(r&1&&(i(0,"mat-option",42),o(1),ee(2,"titlecase"),n()),r&2){let e=t.$implicit;f("value",e),l(),h(" ",te(2,2,e)," ")}}function kt(r,t){if(r&1){let e=M();i(0,"div",62),m(1,"img",63),i(2,"button",64),p("click",function(){let s=_(e).$implicit,d=c(3);return v(d.removeExistingImage(s))}),i(3,"mat-icon",65),o(4,"close"),n()()()}if(r&2){let e=t.$implicit,a=t.$index;l(),f("src",e,I)("alt","Service image "+(a+1))}}function Ot(r,t){if(r&1&&(i(0,"div")(1,"h4",37),o(2,"Current Images"),n(),i(3,"div",61),E(4,kt,5,2,"div",62,F),n()()),r&2){let e=c(2);l(4),P(e.existingImages())}}function It(r,t){if(r&1){let e=M();i(0,"div",62),m(1,"img",63),i(2,"button",64),p("click",function(){let s=_(e).$index,d=c(3);return v(d.removeImage(s))}),i(3,"mat-icon",65),o(4,"close"),n()()()}if(r&2){let e=t.$implicit,a=t.$index;l(),f("src",e,I)("alt","Preview "+(a+1))}}function Tt(r,t){if(r&1&&(i(0,"div")(1,"h4",37),o(2,"New Images to Upload"),n(),i(3,"div",66),E(4,It,5,2,"div",62,F),n()()),r&2){let e=c(2);l(4),P(e.imagePreviewUrls())}}function Ft(r,t){r&1&&(i(0,"div",59)(1,"mat-icon",67),o(2,"refresh"),n(),i(3,"span"),o(4,"Uploading images..."),n()())}function Vt(r,t){if(r&1&&(Y(0),i(1,"mat-icon",67),o(2,"hourglass_empty"),n(),o(3),W()),r&2){let e=c(2);l(3),h(" ",e.isEditMode()?"Updating...":"Creating..."," ")}}function Bt(r,t){if(r&1&&(Y(0),i(1,"mat-icon",18),o(2),n(),o(3),W()),r&2){let e=c(2);l(2),b(e.isEditMode()?"save":"add"),l(),h(" ",e.submitButtonText()," ")}}function Lt(r,t){if(r&1){let e=M();i(0,"div",5)(1,"div",19)(2,"button",20),p("click",function(){_(e);let s=c();return v(s.goBack())}),i(3,"mat-icon",18),o(4,"arrow_back"),n(),o(5," Back to Services "),n(),i(6,"div",21)(7,"h1",22),o(8),n(),i(9,"p",23),u(10,xt,1,0)(11,Ct,1,0),n()()(),i(12,"div",24)(13,"mat-stepper",25,0)(15,"mat-step",26)(16,"form",27)(17,"div")(18,"h3",28),o(19," Service Details "),n(),i(20,"p",29),o(21," Provide basic information about your service. "),n()(),u(22,St,7,1,"mat-form-field",30),i(23,"mat-form-field",30)(24,"mat-label"),o(25,"Service Name"),n(),m(26,"input",31),u(27,yt,2,0,"mat-error"),u(28,Mt,2,0,"mat-error"),u(29,wt,2,0,"mat-error"),n(),i(30,"mat-form-field",30)(31,"mat-label"),o(32,"Full Description"),n(),m(33,"textarea",32),n(),i(34,"div",33)(35,"button",34),p("click",function(){_(e);let s=V(14),d=c();return v(d.nextStep(s))}),o(36," Next "),i(37,"mat-icon",35),o(38,"arrow_forward"),n()()()()(),i(39,"mat-step",36)(40,"form",27)(41,"div")(42,"h3",28),o(43," Pricing & Service Features "),n(),i(44,"p",29),o(45," Set your pricing and define what's included in your service. "),n()(),i(46,"div")(47,"h4",37),o(48,"Pricing Information"),n(),i(49,"div",38)(50,"mat-form-field",39)(51,"mat-label"),o(52,"Price"),n(),m(53,"input",40),u(54,Et,2,0,"mat-error"),n(),i(55,"mat-form-field",39)(56,"mat-label"),o(57,"Pricing Type"),n(),i(58,"mat-select",41),E(59,Pt,3,4,"mat-option",42,F),n()()(),i(61,"mat-form-field",30)(62,"mat-label"),o(63,"Duration"),n(),m(64,"input",43),n()(),i(65,"div")(66,"h4",37),o(67,"Service Details"),n(),i(68,"mat-form-field",30)(69,"mat-label"),o(70,"Features"),n(),m(71,"textarea",44),i(72,"mat-hint"),o(73,"Separate features with commas"),n()(),i(74,"mat-form-field",30)(75,"mat-label"),o(76,"Tags"),n(),m(77,"input",45),i(78,"mat-hint"),o(79,"Separate tags with commas"),n()()(),i(80,"div")(81,"h4",37),o(82,"Service Status"),n(),i(83,"div",46)(84,"mat-checkbox",47),o(85," Active (visible to customers) "),n(),i(86,"mat-checkbox",48),o(87," Featured service "),n()()(),i(88,"div",49)(89,"button",50),p("click",function(){_(e);let s=V(14),d=c();return v(d.previousStep(s))}),i(90,"mat-icon",18),o(91,"arrow_back"),n(),o(92," Previous "),n(),i(93,"button",34),p("click",function(){_(e);let s=V(14),d=c();return v(d.nextStep(s))}),o(94," Next "),i(95,"mat-icon",35),o(96,"arrow_forward"),n()()()()(),i(97,"mat-step",51)(98,"div",52)(99,"div")(100,"h3",28),o(101," Service Images "),n(),i(102,"p",29),o(103," Add images to showcase your service (optional). You can upload up to 5 images, max 5MB each. "),n()(),u(104,Ot,6,0,"div"),i(105,"div",53)(106,"div",21)(107,"mat-icon",54),o(108,"cloud_upload"),n(),i(109,"h4",10),o(110,"Upload Images"),n(),i(111,"p",55),o(112,"Drag and drop images here, or click to select files"),n(),i(113,"input",56,1),p("change",function(s){_(e);let d=c();return v(d.onImageSelect(s))}),n(),i(115,"div",57)(116,"button",34),p("click",function(){_(e);let s=V(114);return v(s.click())}),i(117,"mat-icon",18),o(118,"add_photo_alternate"),n(),o(119," Select Images "),n()(),i(120,"p",58),o(121),n()()(),u(122,Tt,6,0,"div"),u(123,Ft,5,0,"div",59),i(124,"div",49)(125,"button",50),p("click",function(){_(e);let s=V(14),d=c();return v(d.previousStep(s))}),i(126,"mat-icon",18),o(127,"arrow_back"),n(),o(128," Back "),n(),i(129,"button",34),p("click",function(){_(e);let s=c();return v(s.onSubmit())}),u(130,Vt,4,1,"ng-container")(131,Bt,4,2,"ng-container"),n()()()()()()()}if(r&2){let e=c();l(8),h(" ",e.pageTitle()," "),l(2),g(e.isEditMode()?10:11),l(3),f("linear",!0),l(2),f("stepControl",e.serviceInfoForm),l(),f("formGroup",e.serviceInfoForm),l(6),g(e.isEditMode()?-1:22),l(5),g(e.name!=null&&e.name.hasError("required")&&(e.name!=null&&e.name.touched)?27:-1),l(),g(e.name!=null&&e.name.hasError("minlength")&&(e.name!=null&&e.name.touched)?28:-1),l(),g(e.name!=null&&e.name.hasError("maxlength")&&(e.name!=null&&e.name.touched)?29:-1),l(6),f("disabled",!e.isServiceInfoValid()),l(4),f("stepControl",e.servicePricingForm),l(),f("formGroup",e.servicePricingForm),l(14),g(e.price!=null&&e.price.hasError("min")&&(e.price!=null&&e.price.touched)?54:-1),l(5),P(e.pricingTypes),l(34),f("disabled",!e.isServicePricingValid()),l(11),g(e.isEditMode()&&e.existingImages().length>0?104:-1),l(12),f("disabled",e.selectedImages().length+e.existingImages().length>=5),l(5),h(" ",e.selectedImages().length+e.existingImages().length," of 5 images selected "),l(),g(e.selectedImages().length>0?122:-1),l(),g(e.uploadingImages()?123:-1),l(6),f("disabled",!e.canSubmitService()),l(),g(e.submitting()?130:131)}}var N=class r{authService=w(z);router=w(j);route=w(ne);businessService=w(A);fb=w(be);userBusinesses=x([]);currentService=x(null);loading=x(!1);error=x(null);submitting=x(!1);isEditMode=x(!1);serviceId=x("");uploadingImages=x(!1);selectedImages=x([]);imagePreviewUrls=x([]);existingImages=x([]);serviceInfoForm;servicePricingForm;pricingTypes=["fixed","hourly","project","custom"];hasBusinesses=O(()=>this.userBusinesses().length>0);canSubmitService=O(()=>this.hasBusinesses()&&!this.submitting());pageTitle=O(()=>this.isEditMode()?"Edit Service":"Create New Service");submitButtonText=O(()=>this.isEditMode()?"Update Service":"Create Service");constructor(){this.serviceInfoForm=this.fb.group({business_id:["",[D.required]],name:["",[D.required,D.minLength(2),D.maxLength(100)]],description:[""]}),this.servicePricingForm=this.fb.group({price:[null,[D.min(0)]],pricing_type:["fixed"],duration:[""],is_active:[!0],is_featured:[!1],features:[""],tags:[""]}),this.serviceInfoForm.get("name")?.valueChanges.subscribe(t=>{})}ngOnInit(){return k(this,null,function*(){let t=this.route.snapshot.paramMap.get("id");if(t&&(this.isEditMode.set(!0),this.serviceId.set(t)),yield this.loadUserBusinesses(),!this.hasBusinesses()){this.router.navigate(["/dashboard/businesses/create-business"]);return}if(this.isEditMode())yield this.loadService();else{let e=this.route.snapshot.queryParamMap.get("businessId");if(e)this.userBusinesses().find(d=>d._id===e)&&this.serviceInfoForm.get("business_id")?.setValue(e);else{let a=this.userBusinesses();a.length===1&&this.serviceInfoForm.get("business_id")?.setValue(a[0]._id)}}})}loadUserBusinesses(){return k(this,null,function*(){this.loading.set(!0),this.error.set(null);try{let t=yield this.businessService.getMyBusinessesAsync();this.userBusinesses.set(t)}catch(t){console.error("Error loading user businesses:",t),this.error.set(t?.message||"Failed to load businesses")}finally{this.loading.set(!1)}})}loadService(){return k(this,null,function*(){this.loading.set(!0),this.error.set(null);try{let t=yield this.businessService.getServiceAsync(this.serviceId());if(!t)throw new Error("Service not found");this.currentService.set(t),this.populateForm(t)}catch(t){console.error("Error loading service:",t),this.error.set(t?.message||"Failed to load service")}finally{this.loading.set(!1)}})}populateForm(t){this.serviceInfoForm.patchValue({business_id:typeof t.business_id=="string"?t.business_id:t.business_id._id,name:t.name,short_description:t.short_description||"",description:t.description||""}),this.servicePricingForm.patchValue({price:t.price,pricing_type:t.pricing_type||"fixed",duration:t.duration||"",is_active:t.is_active??!0,is_featured:t.is_featured??!1,features:t.features?.join(", ")||"",tags:t.tags?.join(", ")||""}),t.images&&t.images.length>0&&this.existingImages.set([...t.images])}formatFeatures(t){return t.trim()?t.split(",").map(e=>e.trim()).filter(e=>e.length>0):[]}formatTags(t){return t.trim()?t.split(",").map(e=>e.trim()).filter(e=>e.length>0):[]}isServiceInfoValid(){return this.serviceInfoForm.valid}isServicePricingValid(){return this.servicePricingForm.valid}nextStep(t){t.next()}previousStep(t){t.previous()}onSubmit(){return k(this,null,function*(){if(!this.isServiceInfoValid()||!this.isServicePricingValid()||this.submitting()){this.markAllFormsTouched();return}this.submitting.set(!0),this.error.set(null);try{let t=this.serviceInfoForm.value,e=this.servicePricingForm.value,a,s,d={name:t.name,short_description:t.short_description||void 0,description:t.description||void 0,features:this.formatFeatures(e.features),price:e.price||void 0,pricing_type:e.pricing_type,duration:e.duration||void 0,tags:this.formatTags(e.tags),is_active:e.is_active,is_featured:e.is_featured};this.isEditMode()?(s=this.serviceId(),a=yield this.businessService.updateServiceAsync(s,d)):(a=yield this.businessService.createServiceAsync(t.business_id,d),s=a._id);try{let S=yield this.uploadImages(s);if(S.length>0&&(yield this.businessService.updateServiceAsync(s,{images:S})),this.isEditMode()){let R=(this.currentService()?.images||[]).filter(q=>!this.existingImages().includes(q));for(let q of R)try{yield this.businessService.deleteServiceImageAsync(s,q)}catch(ze){console.warn("Failed to delete image:",ze)}}}catch(S){console.error("Error handling images:",S),this.error.set(`Service saved but image upload failed: ${S.message}`)}this.router.navigate(["/dashboard/services"])}catch(t){console.error("Error saving service:",t),this.error.set(t?.message||`Failed to ${this.isEditMode()?"update":"create"} service`)}finally{this.submitting.set(!1)}})}markAllFormsTouched(){Object.keys(this.serviceInfoForm.controls).forEach(t=>{this.serviceInfoForm.get(t)?.markAsTouched()}),Object.keys(this.servicePricingForm.controls).forEach(t=>{this.servicePricingForm.get(t)?.markAsTouched()})}onCancel(){this.router.navigate(["/dashboard/services"])}goBack(){this.router.navigate(["/dashboard/services"])}loadData(){this.isEditMode()?this.loadService():this.loadUserBusinesses()}get business_id(){return this.serviceInfoForm.get("business_id")}get name(){return this.serviceInfoForm.get("name")}get short_description(){return this.serviceInfoForm.get("short_description")}get description(){return this.serviceInfoForm.get("description")}get features(){return this.serviceInfoForm.get("features")}get price(){return this.servicePricingForm.get("price")}get pricing_type(){return this.servicePricingForm.get("pricing_type")}get duration(){return this.servicePricingForm.get("duration")}get tags(){return this.servicePricingForm.get("tags")}get is_active(){return this.servicePricingForm.get("is_active")}get is_featured(){return this.servicePricingForm.get("is_featured")}onImageSelect(t){let e=t.target;if(e.files&&e.files.length>0){let a=Array.from(e.files),s=a.filter(H=>{let J=H.type.startsWith("image/"),R=H.size<=5*1024*1024;return J&&R});s.length!==a.length&&this.error.set("Some files were rejected. Please ensure all files are images under 5MB.");let S=[...this.selectedImages(),...s];S.length>5?(this.selectedImages.set(S.slice(0,5)),this.error.set("Maximum 5 images allowed. Some images were not added.")):this.selectedImages.set(S),this.generateImagePreviews()}}removeImage(t){let a=this.selectedImages().filter((s,d)=>d!==t);this.selectedImages.set(a),this.generateImagePreviews()}removeExistingImage(t){let a=this.existingImages().filter(s=>s!==t);this.existingImages.set(a)}generateImagePreviews(){let t=this.selectedImages(),e=[];t.forEach(a=>{let s=new FileReader;s.onload=d=>{let S=d.target?.result;e.push(S),e.length===t.length&&this.imagePreviewUrls.set(e)},s.readAsDataURL(a)}),t.length===0&&this.imagePreviewUrls.set([])}uploadImages(t){return k(this,null,function*(){let e=this.selectedImages();if(e.length===0)return this.existingImages();this.uploadingImages.set(!0);try{let a=yield this.businessService.uploadServiceImagesAsync(t,e);return[...this.existingImages(),...a.images]}catch(a){throw console.error("Error uploading images:",a),new Error("Failed to upload images")}finally{this.uploadingImages.set(!1)}})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=T({type:r,selectors:[["app-create-service"]],decls:5,vars:1,consts:[["stepper",""],["fileInput",""],[1,"min-h-screen","bg-gray-50"],[1,"flex","justify-center","items-center","py-20"],[1,"max-w-2xl","mx-auto","px-4","sm:px-6","lg:px-8","py-12"],[1,"max-w-3xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-blue-600"],[1,"text-center","py-12","bg-white","rounded-lg","shadow-sm","border","border-gray-200"],[1,"text-red-400","mb-4"],[1,"text-6xl"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"space-x-4"],[1,"bg-gray-600","text-white","px-4","py-2","rounded-lg","hover:bg-gray-700","transition-colors",3,"click"],[1,"bg-blue-600","text-white","px-4","py-2","rounded-lg","hover:bg-blue-700","transition-colors",3,"click"],[1,"mx-auto","h-12","w-12","text-gray-400","mb-4"],[2,"font-size","48px","height","48px","width","48px"],[1,"text-sm","text-gray-500","mb-6"],["routerLink","/dashboard/businesses/create-business",1,"bg-gray-900","hover:bg-gray-800","text-white","px-6","py-2","rounded-lg","font-medium","transition-colors","flex","items-center"],[1,"mr-2"],[1,"mb-8"],[1,"mb-4","flex","items-center","text-gray-600","hover:text-gray-800","transition-colors",3,"click"],[1,"text-center"],[1,"text-3xl","font-bold","text-gray-900","mb-2"],[1,"text-gray-600"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200"],[1,"service-stepper",3,"linear"],["label","Service Information",3,"stepControl"],[1,"p-6","space-y-6",3,"formGroup"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[1,"text-gray-600","mb-6"],["appearance","outline",1,"w-full"],["matInput","","formControlName","name","placeholder","e.g., Web Design, Logo Creation","required",""],["matInput","","formControlName","description","rows","4","placeholder","Detailed description of your service"],[1,"flex","justify-end"],["type","button",1,"bg-gray-900","hover:bg-gray-800","disabled:bg-gray-300","disabled:cursor-not-allowed","text-white","px-6","py-2","rounded-lg","font-medium","transition-colors","flex","items-center",3,"click","disabled"],[1,"ml-2"],["label","Pricing & Features",3,"stepControl"],[1,"text-md","font-medium","text-gray-900","mb-3"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["appearance","outline"],["matInput","","type","number","formControlName","price","min","0","step","0.01","placeholder","0.00"],["formControlName","pricing_type"],[3,"value"],["matInput","","formControlName","duration","placeholder","e.g., 2-3 weeks, 1 hour"],["matInput","","formControlName","features","rows","3","placeholder","Feature 1, Feature 2, Feature 3"],["matInput","","formControlName","tags","placeholder","tag1, tag2, tag3"],[1,"space-y-4"],["formControlName","is_active"],["formControlName","is_featured"],[1,"flex","justify-between"],["type","button",1,"bg-gray-300","hover:bg-gray-400","text-gray-700","px-6","py-2","rounded-lg","font-medium","transition-colors","flex","items-center",3,"click"],["label","Images & Finish"],[1,"p-6","space-y-6"],[1,"border-2","border-dashed","border-gray-300","rounded-lg","p-6"],[1,"text-4xl","text-gray-400","mb-4"],[1,"text-gray-600","mb-4"],["type","file","multiple","","accept","image/*",1,"hidden",3,"change"],[1,"flex","justify-center"],[1,"text-sm","text-gray-500","mt-2"],[1,"flex","items-center","justify-center","py-4"],["formControlName","business_id","required",""],[1,"grid","grid-cols-2","md:grid-cols-3","lg:grid-cols-4","gap-4","mb-6"],[1,"relative","group"],[1,"w-full","h-32","object-cover","rounded-lg","border","border-gray-200",3,"src","alt"],["type","button",1,"absolute","top-2","right-2","bg-red-500","text-white","rounded-full","p-1","opacity-0","group-hover:opacity-100","transition-opacity",3,"click"],[1,"text-sm"],[1,"grid","grid-cols-2","md:grid-cols-3","lg:grid-cols-4","gap-4"],[1,"animate-spin","mr-2"]],template:function(e,a){e&1&&(i(0,"div",2),u(1,_t,2,0,"div",3)(2,vt,12,1,"div",4)(3,ft,13,0,"div",4)(4,Lt,132,21,"div",5),n()),e&2&&(l(),g(a.loading()?1:a.error()?2:a.hasBusinesses()?4:3))},dependencies:[L,$,oe,ye,ge,de,pe,me,ue,he,Ce,_e,ve,ke,Pe,Me,Ee,we,Fe,Te,Ie,Oe,ae,le,se,ce,Be,Ve,Ne,Le,De,ie],encapsulation:2})};var Oi=[{path:"",component:U,children:[{path:"list-services",component:G},{path:"",redirectTo:"list-services",pathMatch:"full"},{path:"create-service",component:N},{path:"edit-service/:id",component:N}]}];export{Oi as SERVICES_ROUTES};
