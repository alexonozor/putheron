import{a as ee,b as te}from"./chunk-5WOC22XK.js";import{h as Q,l as X,m as Y}from"./chunk-3E6WONAP.js";import"./chunk-U2AVJWKL.js";import"./chunk-V5XDW2Q5.js";import{d as $,e as W,h as J,k as K}from"./chunk-K7KKK75I.js";import{A as U,C as Z,c as A,e as v,h as q,i as G,m as j,q as H,s as O}from"./chunk-U7A7OHU6.js";import"./chunk-RNGT6N3O.js";import"./chunk-2KVGUUAN.js";import"./chunk-E366GW6U.js";import{a as I,b as z}from"./chunk-NALWU7JT.js";import{b as R,c as D,d as L}from"./chunk-MLJYHTLM.js";import{a as B}from"./chunk-4GWWNNYU.js";import"./chunk-EPCACDVR.js";import"./chunk-ZKKR2XMO.js";import"./chunk-LDSTDJZ6.js";import"./chunk-QD7SSFII.js";import{a as V,b as N}from"./chunk-QFHPWKDD.js";import"./chunk-O2FJLJYH.js";import{e as E,g as T,h as F}from"./chunk-72SEU4B5.js";import"./chunk-JFMUERLE.js";import{t as M}from"./chunk-FI3M32ZM.js";import{$a as s,$b as p,Eb as x,Fb as l,Gb as d,Lb as u,Mb as t,Nb as i,Ob as m,Rc as w,Vb as S,Zb as b,fa as f,ka as P,la as C,nc as r,oc as y,qb as k,ua as c,yc as _}from"./chunk-M7BUBJMW.js";import{e as g}from"./chunk-JKOY2XUY.js";var ie=()=>["/auth/forgot-password"],ne=()=>["/auth/login"];function re(n,o){n&1&&(t(0,"div",10),m(1,"mat-spinner",22),t(2,"p",23),r(3,"Verifying reset token..."),i()())}function se(n,o){n&1&&(t(0,"div",11)(1,"div",24)(2,"h1",25),r(3,"Invalid Reset Link"),i(),t(4,"p",23),r(5,"This password reset link is invalid or has expired."),i()(),t(6,"button",26),r(7," Request New Reset Link "),i(),t(8,"div",27)(9,"p",28),r(10," Remember your password? "),t(11,"a",29),r(12," Back to Login "),i()()()()),n&2&&(s(6),u("routerLink",_(2,ie)),s(5),u("routerLink",_(3,ne)))}function ae(n,o){n&1&&r(0," New password is required ")}function le(n,o){n&1&&r(0," Password must be at least 8 characters long ")}function de(n,o){if(n&1&&(t(0,"mat-error"),l(1,ae,1,0)(2,le,1,0),i()),n&2){let e=p(2);s(),d(e.newPasswordControl!=null&&e.newPasswordControl.hasError("required")?1:e.newPasswordControl!=null&&e.newPasswordControl.hasError("minlength")?2:-1)}}function me(n,o){n&1&&r(0," Please confirm your password ")}function ce(n,o){if(n&1&&(t(0,"mat-error"),l(1,me,1,0),i()),n&2){let e=p(2);s(),d(e.confirmPasswordControl!=null&&e.confirmPasswordControl.hasError("required")?1:-1)}}function ue(n,o){n&1&&(t(0,"mat-error"),r(1," Passwords do not match "),i())}function pe(n,o){n&1&&r(0," Log in ")}function we(n,o){n&1&&(t(0,"span",38),m(1,"mat-spinner",39),r(2," Resetting Password... "),i())}function fe(n,o){if(n&1){let e=S();t(0,"div",30)(1,"h1",25),r(2,"Reset Password"),i(),t(3,"p",23),r(4,"Enter your new password"),i()(),t(5,"form",31),b("ngSubmit",function(){P(e);let h=p();return C(h.onSubmit())}),t(6,"div")(7,"mat-form-field",32)(8,"mat-label"),r(9,"New password"),i(),m(10,"input",33),t(11,"button",34),b("click",function(){P(e);let h=p();return C(h.togglePasswordVisibility())}),t(12,"mat-icon"),r(13),i()(),l(14,de,3,1,"mat-error"),i(),t(15,"p",35),r(16," At least 8 characters long. Uppercase, lowercase, number and special character "),i()(),t(17,"div")(18,"mat-form-field",32)(19,"mat-label"),r(20,"Confirm new password"),i(),m(21,"input",36),t(22,"button",34),b("click",function(){P(e);let h=p();return C(h.toggleConfirmPasswordVisibility())}),t(23,"mat-icon"),r(24),i()(),l(25,ce,2,1,"mat-error"),l(26,ue,2,0,"mat-error"),i(),t(27,"p",35),r(28,"Password must be identical."),i()(),t(29,"button",37),l(30,pe,1,0)(31,we,3,0,"span",38),i()()}if(n&2){let e=p();s(5),u("formGroup",e.resetPasswordForm),s(5),u("type",e.showPassword()?"text":"password")("disabled",e.loading()),s(),x("aria-label","Toggle password visibility")("aria-pressed",e.showPassword()),s(2),y(e.showPassword()?"visibility_off":"visibility"),s(),d(e.newPasswordControl!=null&&e.newPasswordControl.invalid&&(e.newPasswordControl!=null&&e.newPasswordControl.touched)?14:-1),s(7),u("type",e.showConfirmPassword()?"text":"password")("disabled",e.loading()),s(),x("aria-label","Toggle confirm password visibility")("aria-pressed",e.showConfirmPassword()),s(2),y(e.showConfirmPassword()?"visibility_off":"visibility"),s(),d(e.confirmPasswordControl!=null&&e.confirmPasswordControl.invalid&&(e.confirmPasswordControl!=null&&e.confirmPasswordControl.touched)?25:-1),s(),d(e.resetPasswordForm.hasError("passwordMismatch")&&(e.confirmPasswordControl!=null&&e.confirmPasswordControl.touched)?26:-1),s(3),u("disabled",!e.isFormValid()||e.loading()),s(),d(e.loading()?31:30)}}function he(n){let o=n.get("newPassword"),e=n.get("confirmPassword");return!o||!e||o.value===e.value?null:{passwordMismatch:!0}}var oe=class n{authService=f(B);router=f(T);route=f(E);fb=f(U);snackBar=f(ee);loading=c(!1);verifyingToken=c(!1);tokenValid=c(!1);userEmail=c("");showPassword=c(!1);showConfirmPassword=c(!1);currentPassword=c("");formValid=c(!1);resetToken="";resetPasswordForm;isFormValid=w(()=>this.formValid());hasMinLength=w(()=>this.currentPassword().length>=8);hasUppercase=w(()=>{let o=this.currentPassword();return/[A-Z]/.test(o)});hasLowercase=w(()=>{let o=this.currentPassword();return/[a-z]/.test(o)});hasNumber=w(()=>{let o=this.currentPassword();return/\d/.test(o)});hasSpecialChar=w(()=>{let o=this.currentPassword();return/[@$!%*?&]/.test(o)});constructor(){this.resetPasswordForm=this.fb.group({newPassword:["",[v.required,v.minLength(8),v.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/)]],confirmPassword:["",[v.required]]},{validators:he}),this.resetPasswordForm.get("newPassword")?.valueChanges.subscribe(o=>{this.currentPassword.set(o||"")}),this.resetPasswordForm.statusChanges.subscribe(()=>{this.formValid.set(this.resetPasswordForm.valid)}),this.formValid.set(this.resetPasswordForm.valid)}ngOnInit(){return g(this,null,function*(){this.route.queryParams.subscribe(o=>g(this,null,function*(){this.resetToken=o.token,this.resetToken?yield this.verifyToken():this.snackBar.open("Invalid reset link. Please request a new password reset.","Close",{duration:5e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-error"]})}))})}verifyToken(){return g(this,null,function*(){this.verifyingToken.set(!0);try{let o=yield this.authService.verifyResetToken(this.resetToken);o.success?(this.tokenValid.set(!0),this.userEmail.set(o?.data?.email||"")):(this.snackBar.open(o.message||"Invalid or expired reset token.","Close",{duration:5e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-error"]}),this.tokenValid.set(!1))}catch(o){this.snackBar.open(o?.message||"Invalid or expired reset token.","Close",{duration:5e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-error"]}),this.tokenValid.set(!1)}finally{this.verifyingToken.set(!1)}})}onSubmit(){return g(this,null,function*(){if(!this.resetPasswordForm.valid){this.resetPasswordForm.hasError("passwordMismatch")?this.snackBar.open("Passwords do not match","Close",{duration:5e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-error"]}):this.snackBar.open("Please check all fields and try again","Close",{duration:5e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-error"]});return}let{newPassword:o,confirmPassword:e}=this.resetPasswordForm.value;this.loading.set(!0);try{let a=yield this.authService.resetPassword(this.resetToken,o,e);a.success?(this.snackBar.open(a.message||"Password has been reset successfully!","Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-success"]}),setTimeout(()=>{this.router.navigate(["/auth/login"],{queryParams:{message:"Password reset successful. Please log in with your new password."}})},2e3)):this.snackBar.open(a.message||"Failed to reset password. Please try again.","Close",{duration:5e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-error"]})}catch(a){this.snackBar.open(a?.message||"An unexpected error occurred. Please try again.","Close",{duration:5e3,horizontalPosition:"center",verticalPosition:"top",panelClass:["snackbar-error"]})}finally{this.loading.set(!1)}})}togglePasswordVisibility(){this.showPassword.set(!this.showPassword())}toggleConfirmPasswordVisibility(){this.showConfirmPassword.set(!this.showConfirmPassword())}get newPasswordControl(){return this.resetPasswordForm.get("newPassword")}get confirmPasswordControl(){return this.resetPasswordForm.get("confirmPassword")}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=k({type:n,selectors:[["app-reset-password"]],decls:41,vars:3,consts:[[1,"min-h-screen","flex"],[1,"w-full","lg:w-1/2","flex","items-center","justify-center","px-6","py-12","bg-white","relative","overflow-hidden"],[1,"lg:hidden","absolute","top-0","right-0","w-28","h-46","pointer-events-none"],["src","/assets/images/Layer-v.svg","alt","",1,"w-full","h-full"],[1,"lg:hidden","absolute","bottom-0","left-0","w-47","h-25","pointer-events-none"],["src","/assets/images/Layer-x.svg","alt","",1,"w-full","h-full"],[1,"w-full","max-w-md","relative","z-10"],[1,"lg:mb-8","mb-2","text-center"],["routerLink","/",1,"inline-block"],["src","/assets/logos/colored-logo.svg","alt","VouchHer",1,"h-18","lg:h-18","w-auto"],[1,"text-center","space-y-4","py-12"],[1,"text-center","space-y-6"],[1,"hidden","lg:flex","lg:w-1/2","relative","bg-primary-600","items-center","justify-center","overflow-hidden"],[1,"absolute","inset-0"],["src","/assets/images/login-right-bakground.svg","alt","",1,"w-full","h-full","object-cover"],[1,"relative","z-10","flex","flex-col","items-center","justify-center","text-center","px-12","w-full","max-w-lg"],["src","/assets/logos/white-logo.svg","alt","VouchHer",1,"h-16","w-auto","mb-12"],[1,"text-white","text-2xl","font-bold","mb-6","text-[#20AA62]"],[1,"space-y-4","text-white","text-left","w-full"],[1,"font-semibold","text-lg","mb-2"],[1,"space-y-2","text-sm"],[1,"font-semibold","text-lg","mb-2","mt-6"],["diameter","40",1,"mx-auto"],[1,"text-gray-600"],[1,"mb-8"],[1,"text-2xl","lg:text-3xl","font-bold","text-gray-900","mb-2"],["mat-flat-button","","color","primary",1,"w-full","!py-3","!text-base","!font-medium","!rounded-lg",3,"routerLink"],[1,"text-center","pt-4"],[1,"text-sm","text-gray-600"],[1,"font-medium","text-[#6B0FAE]","hover:text-primary-700","ml-1",3,"routerLink"],[1,"mb-8","text-center","lg:text-left"],[1,"space-y-6",3,"ngSubmit","formGroup"],["appearance","outline",1,"w-full"],["matInput","","formControlName","newPassword","placeholder","",3,"type","disabled"],["mat-icon-button","","matSuffix","","type","button",3,"click"],[1,"text-xs","text-gray-500","mt-1"],["matInput","","formControlName","confirmPassword","placeholder","",3,"type","disabled"],["mat-flat-button","","color","primary","type","submit",1,"w-full","!py-3","!text-base","!font-medium","!rounded-lg",3,"disabled"],[1,"flex","items-center","justify-center","gap-2"],["diameter","20",1,"!text-white"]],template:function(e,a){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),m(3,"img",3),i(),t(4,"div",4),m(5,"img",5),i(),t(6,"div",6)(7,"div",7)(8,"a",8),m(9,"img",9),i()(),l(10,re,4,0,"div",10),l(11,se,13,4,"div",11),l(12,fe,32,16),i()(),t(13,"div",12)(14,"div",13),m(15,"img",14),i(),t(16,"div",15),m(17,"img",16),t(18,"h2",17),r(19," Women First Marketplace "),i(),t(20,"div",18)(21,"div")(22,"h3",19),r(23,"Find women-owned businesses in seconds"),i(),t(24,"ul",20)(25,"li"),r(26,"1. Earn extra income"),i(),t(27,"li"),r(28,"2. Collaborate and grow"),i(),t(29,"li"),r(30,"3. Get support from peers"),i()()(),t(31,"div")(32,"h3",21),r(33,"Hire qualified women with ease"),i(),t(34,"ul",20)(35,"li"),r(36,"1. List business(es)"),i(),t(37,"li"),r(38,"2. Get offers or bids"),i(),t(39,"li"),r(40,"3. Pay with ease when job is complete"),i()()()()()()()),e&2&&(s(10),d(a.verifyingToken()?10:-1),s(),d(!a.verifyingToken()&&!a.tokenValid()?11:-1),s(),d(!a.verifyingToken()&&a.tokenValid()?12:-1))},dependencies:[M,Z,j,A,q,G,H,O,F,Q,K,$,W,J,Y,X,L,D,R,N,V,z,I,te],encapsulation:2})};export{oe as ResetPasswordComponent};
