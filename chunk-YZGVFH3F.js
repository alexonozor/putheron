import{a as nt,b as rt,c as ot}from"./chunk-CO7FPQWW.js";import{a as et,b as tt}from"./chunk-5ZYUDIOR.js";import"./chunk-DI7FIG2Y.js";import"./chunk-3UNUIKCF.js";import{a as re,b as Ze,c as it}from"./chunk-DVJGIJEZ.js";import"./chunk-URZBJTPH.js";import"./chunk-GLDHM7BE.js";import"./chunk-PVDG46DZ.js";import"./chunk-BQAOSCDJ.js";import"./chunk-M23MWY4A.js";import"./chunk-HQCAXNXF.js";import"./chunk-RTVUWSKV.js";import{b as Fe}from"./chunk-LPGP55NA.js";import{d as Te}from"./chunk-OVLPSQNG.js";import{a as A,c as Be,e as Ne,h as F}from"./chunk-7UZH7J7I.js";import{b as Ke,c as Xe}from"./chunk-2CAQAZ7V.js";import{d as W,h as te,i as ie,j as ne,l as Qe,m as Je}from"./chunk-ZEPG7XYP.js";import"./chunk-667ILHIJ.js";import"./chunk-ZLE5IO2O.js";import{d as Z,e as qe,f as We,g as Ye,k as ee}from"./chunk-WUPIU6OB.js";import{A as Re,B as He,C as X,c as De,e as $,h as Ve,i as Le,m as Ae,n as $e,q as je,s as Ue,x as ze,y as Ge}from"./chunk-3JRZMC5D.js";import{a as Q}from"./chunk-UUQHZO7R.js";import{a as Y}from"./chunk-DVEYH5MF.js";import"./chunk-C3KG2QNL.js";import{a as J,b as K}from"./chunk-2WQD2DAV.js";import{a as q,t as L,u as T}from"./chunk-IZGM5G4Z.js";import"./chunk-OXNSH2WS.js";import"./chunk-QD7SSFII.js";import{a as V,b as k}from"./chunk-EPCK2AMG.js";import{d as H}from"./chunk-WF7V7INI.js";import{e as Oe,f as Ie,g as G,h as ke,l as R}from"./chunk-HNHRL3LT.js";import"./chunk-S4SH23H7.js";import{o as Ee,w as y}from"./chunk-5TL7AFVW.js";import{Bc as Me,Cc as B,Hb as u,Ic as we,Jb as p,Jc as Pe,Lb as z,Mb as E,Nb as O,Ob as m,Pb as r,Qb as o,Rb as _,Vb as _e,Vc as N,Wb as fe,Yb as I,Za as j,ab as c,ac as v,cc as d,fb as P,ga as b,la as f,ma as C,mc as D,na as ge,nc as Ce,oa as ve,pc as ye,qc as a,rb as x,rc as w,sc as S,va as g}from"./chunk-VCYZZ2B3.js";import{a as xe,b as Se,e as M}from"./chunk-JKOY2XUY.js";var oe=class i{static \u0275fac=function(e){return new(e||i)};static \u0275cmp=x({type:i,selectors:[["app-services"]],decls:1,vars:0,template:function(e,n){e&1&&_(0,"router-outlet")},dependencies:[y,Ie],encapsulation:2})};function mt(i,t){if(i&1&&_(0,"img",2),i&2){let e=d();m("src",e.service.images[0],j)("alt",e.service.name)}}function ut(i,t){i&1&&(r(0,"div",3)(1,"mat-icon",19),a(2,"build"),o()()),i&2&&(c(),Ce("font-size",48,"px")("width",48,"px")("height",48,"px"))}function pt(i,t){i&1&&(r(0,"div",6)(1,"span",20)(2,"mat-icon",16),a(3,"star"),o(),a(4," Featured "),o()()),i&2&&(c(2),Ce("font-size",14,"px")("width",14,"px")("height",14,"px"))}function gt(i,t){if(i&1&&(r(0,"span",12),a(1),o()),i&2){let e=d();c(),S("$",e.service.price)}}function vt(i,t){i&1&&(r(0,"span",12),a(1,"Custom"),o())}function _t(i,t){if(i&1&&(r(0,"span",13),a(1),o()),i&2){let e=d();c(),w(e.service.duration)}}var ce=class i{service;businessName="";statusColorClass="";statusText="";view=new P;edit=new P;delete=new P;onView(){this.view.emit(this.service._id)}onEdit(){this.edit.emit(this.service._id)}onDelete(){this.delete.emit(this.service._id)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=x({type:i,selectors:[["app-service-card"]],inputs:{service:"service",businessName:"businessName",statusColorClass:"statusColorClass",statusText:"statusText"},outputs:{view:"view",edit:"edit",delete:"delete"},decls:32,vars:10,consts:[[1,"h-full","bg-white!","hover:shadow-lg","transition-all","duration-200"],[1,"relative","aspect-video","bg-gray-100","overflow-hidden"],[1,"w-full","h-full","object-cover",3,"src","alt"],[1,"w-full","h-full","bg-gradient-to-br","from-gray-100","to-gray-200","flex","items-center","justify-center"],[1,"absolute","top-3","right-3"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","backdrop-blur-sm"],[1,"absolute","top-3","left-3"],[1,"p-6"],[1,"text-lg","font-semibold","text-gray-900","truncate","mb-1"],[1,"text-sm","text-gray-600","mb-3"],[1,"text-sm","text-gray-600","mb-4","line-clamp-2"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"flex","justify-center","gap-2"],["mat-button","","color","accent","title","View Service",3,"click"],[1,"mr-1"],["mat-button","","color","accent","title","Edit Service",3,"click"],["mat-button","","color","warn","title","Delete Service",3,"click"],[1,"text-gray-400"],[1,"bg-yellow-100","text-yellow-800","inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","backdrop-blur-sm"]],template:function(e,n){e&1&&(r(0,"mat-card",0)(1,"div",1),u(2,mt,1,2,"img",2)(3,ut,3,6,"div",3),r(4,"div",4)(5,"span",5),a(6),o()(),u(7,pt,5,6,"div",6),o(),r(8,"mat-card-content",7)(9,"h3",8),a(10),o(),r(11,"p",9),a(12),o(),r(13,"p",10),a(14),o(),r(15,"div",11),u(16,gt,2,1,"span",12)(17,vt,2,0,"span",12),u(18,_t,2,1,"span",13),o()(),r(19,"mat-card-actions",14)(20,"button",15),v("click",function(){return n.onView()}),r(21,"mat-icon",16),a(22,"visibility"),o(),a(23," View "),o(),r(24,"button",17),v("click",function(){return n.onEdit()}),r(25,"mat-icon",16),a(26,"edit"),o(),a(27," Edit "),o(),r(28,"button",18),v("click",function(){return n.onDelete()}),r(29,"mat-icon",16),a(30,"delete"),o(),a(31," Delete "),o()()()),e&2&&(c(2),p(n.service.images&&n.service.images.length>0?2:3),c(3),ye(n.statusColorClass),c(),S(" ",n.statusText," "),c(),p(n.service.is_featured?7:-1),c(3),w(n.service.name),c(2),w(n.businessName),c(2),S(" ",n.service.short_description||n.service.description||"No description available"," "),c(2),p(n.service.price!==void 0&&n.service.price!==null?16:17),c(2),p(n.service.duration?18:-1))},dependencies:[y,F,A,Ne,Be,T,L,k,V],styles:["[_nghost-%COMP%]{display:block}"]})};var le=class i{services=[];businessNameMap={};set displayedColumns(t){this.columns.set(this.getColumnDefinitions(t))}view=new P;edit=new P;delete=new P;columns=g([]);trackByFn(t){return t}getColumnDefinitions(t){let e={image:{header:"",field:"images",width:"60px",formatter:n=>{let s=n.images&&n.images.length>0?n.images[0]:null;return s?`<img src="${s}" alt="${n.name}" class="w-12 h-12 object-cover rounded">`:`<div class="w-12 h-12 bg-gray-100 flex items-center justify-center rounded">
            <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4"></path>
            </svg>
          </div>`}},name:{header:"Service Name",field:"name",width:"220px",formatter:n=>{let s=n.is_featured?`<span class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
            <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>
            Featured
          </span>`:"";return`<div class="flex items-center gap-2">
            <span>${n.name}</span>
          </div>`}},business:{header:"Business",field:"business_id",width:"160px",formatter:n=>`<span class="text-sm text-gray-600">${typeof n.business_id=="object"?n.business_id.name:this.businessNameMap[n._id]||"Unknown"}</span>`},description:{header:"Description",field:"short_description",width:"200px",formatter:n=>{let s=n.short_description||n.description||"No description",l=s.length>40?s.substring(0,40)+"...":s;return`<span class="text-sm text-gray-700 line-clamp-1" title="${s}">${l}</span>`}},status:{header:"Status",field:"is_active",width:"110px",formatter:n=>{let s=n.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",l=n.is_active?"Active":"Inactive";return`<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s}">
            ${l}
          </span>`}},price:{header:"Price",field:"price",width:"100px",formatter:n=>n.price!==void 0&&n.price!==null?`<span class="text-sm font-medium">$${n.price}</span>`:'<span class="text-sm text-gray-500">Custom</span>'},date:{header:"Created",field:"createdAt",width:"110px",formatter:n=>`<span class="text-sm text-gray-500">${new Date(n.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}</span>`},actions:{header:"Actions",field:"actions",width:"80px",pinned:"right",right:"0px",type:"button",buttons:[{type:"icon",icon:"more_vert",tooltip:"Options",children:[{icon:"visibility",text:"View",click:n=>this.onView(n._id)},{icon:"edit",text:"Edit",click:n=>this.onEdit(n._id)},{icon:"delete",text:"Delete",click:n=>this.onDelete(n._id)}]}]}};return t.map(n=>e[n]||{header:n,field:n})}onView(t){this.view.emit(t)}onEdit(t){this.edit.emit(t)}onDelete(t){this.delete.emit(t)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=x({type:i,selectors:[["app-service-list-card"]],inputs:{services:"services",businessNameMap:"businessNameMap",displayedColumns:"displayedColumns"},outputs:{view:"view",edit:"edit",delete:"delete"},decls:2,vars:3,consts:[[1,"bg-white!"],[1,"w-full",3,"data","columns","trackBy"]],template:function(e,n){e&1&&(r(0,"mat-card",0),_(1,"mtx-grid",1),o()),e&2&&(c(),m("data",n.services)("columns",n.columns())("trackBy",n.trackByFn))},dependencies:[y,F,A,T,k,Te,Fe,tt,et],styles:["[_nghost-%COMP%]{display:block}"]})};var ht=i=>({label:"Clear Filters",callback:i}),he=i=>[i],bt=i=>({label:"Create Business",callback:i,icon:"add"}),xt=i=>({label:"Create Your First Service",callback:i,icon:"add"}),St=()=>["image","name","business","description","status","price","date","actions"],lt=(i,t)=>t._id;function yt(i,t){if(i&1&&(r(0,"mat-option",13),a(1),o()),i&2){let e=t.$implicit;m("value",e._id),c(),w(e.name)}}function Mt(i,t){i&1&&(r(0,"div",15)(1,"div",18),ge(),r(2,"svg",19),_(3,"path",20),o(),ve(),r(4,"div")(5,"h3",21),a(6,"No businesses found"),o(),r(7,"p",22),a(8,"You need to create a business before you can add services."),o()()()())}function wt(i,t){if(i&1&&(r(0,"div",16)(1,"div",18),ge(),r(2,"svg",23),_(3,"path",24),o(),ve(),r(4,"div")(5,"h3",25),a(6,"Error"),o(),r(7,"p",26),a(8),o()()()()),i&2){let e=d();c(8),w(e.error())}}function Pt(i,t){if(i&1&&(r(0,"div",17),_(1,"mat-spinner",27),o()),i&2){let e=d();c(),m("diameter",e.isMobile()?40:60)("strokeWidth",4)}}function Et(i,t){if(i&1&&_(0,"app-empty-state",29),i&2){let e=d(3);m("buttons",B(3,he,B(1,ht,e.handleClearFilters)))}}function Ot(i,t){if(i&1&&_(0,"app-empty-state",30),i&2){let e=d(3);m("buttons",B(3,he,B(1,bt,e.handleCreateBusiness)))}}function It(i,t){if(i&1&&_(0,"app-empty-state",31),i&2){let e=d(3);m("buttons",B(3,he,B(1,xt,e.handleCreateService)))}}function kt(i,t){if(i&1&&(r(0,"div",28),u(1,Et,1,5,"app-empty-state",29)(2,Ot,1,5,"app-empty-state",30)(3,It,1,5,"app-empty-state",31),o()),i&2){let e=d(2);c(),p(e.searchTerm()||e.selectedBusiness()!=="all"?1:e.userBusinesses().length===0?2:3)}}function Tt(i,t){if(i&1){let e=I();r(0,"app-service-card",35),v("view",function(s){f(e);let l=d(4);return C(l.viewService(s))})("edit",function(s){f(e);let l=d(4);return C(l.editService(s))})("delete",function(s){f(e);let l=d(4);return C(l.deleteService(s))}),o()}if(i&2){let e=t.$implicit,n=d(4);m("service",e)("businessName",n.getBusinessName(e))("statusColorClass",n.getStatusColor(e.is_active))("statusText",n.getStatusText(e.is_active))}}function Ft(i,t){if(i&1&&(r(0,"div",28)(1,"div",33),E(2,Tt,1,4,"app-service-card",34,lt),o()()),i&2){let e=d(3);c(2),O(e.filteredServices())}}function Bt(i,t){if(i&1){let e=I();r(0,"div",32)(1,"app-service-list-card",36),v("view",function(s){f(e);let l=d(3);return C(l.viewService(s))})("edit",function(s){f(e);let l=d(3);return C(l.editService(s))})("delete",function(s){f(e);let l=d(3);return C(l.deleteService(s))}),o()()}if(i&2){let e=d(3);c(),m("services",e.filteredServices())("businessNameMap",e.getBusinessNameMap())("displayedColumns",Me(3,St))}}function Nt(i,t){if(i&1&&(u(0,Ft,4,0,"div",28),u(1,Bt,2,4,"div",32)),i&2){let e=d(2);p(e.viewMode()==="grid"?0:-1),c(),p(e.viewMode()==="list"?1:-1)}}function Dt(i,t){if(i&1&&u(0,kt,4,1,"div",28)(1,Nt,2,2),i&2){let e=d();p(e.filteredServices().length===0?0:1)}}var de=class i{authService=b(Y);router=b(G);businessService=b(Q);breakpointObserver=b(H);userServices=g([]);userBusinesses=g([]);loading=g(!1);error=g(null);searchTerm=g("");viewMode=g("grid");selectedBusiness=g("all");isMobile=g(!1);user=this.authService.user;filteredServices=N(()=>{let t=this.userServices(),e=this.searchTerm().toLowerCase().trim(),n=this.selectedBusiness();return n!=="all"&&(t=t.filter(s=>typeof s.business_id=="string"?s.business_id===n:s.business_id._id===n)),e&&(t=t.filter(s=>s.name.toLowerCase().includes(e)||s.description?.toLowerCase().includes(e)||s.short_description?.toLowerCase().includes(e)||s.tags?.some(l=>l.toLowerCase().includes(e)))),t});ngOnInit(){if(!this.user()){this.router.navigate(["/auth"]);return}this.breakpointObserver.observe([q.Handset]).subscribe(t=>{this.isMobile.set(t.matches)}),this.loadData()}loadData(){return M(this,null,function*(){this.loading.set(!0),this.error.set(null);try{let t=yield this.businessService.getMyBusinessesAsync();this.userBusinesses.set(t);let e=[];for(let n of t)try{let l=(yield this.businessService.getBusinessServicesAsync(n._id)).map(h=>Se(xe({},h),{business_id:n}));e=[...e,...l]}catch(s){console.warn(`Failed to load services for business ${n._id}:`,s)}this.userServices.set(e)}catch(t){console.error("Error loading services:",t),this.error.set(t.message||"Failed to load services")}finally{this.loading.set(!1)}})}setViewMode(t){this.viewMode.set(t)}onSearchChange(t){let e=t.target;this.searchTerm.set(e.value)}clearSearch(){this.searchTerm.set("")}onBusinessFilterChange(t){let e=t.target;this.selectedBusiness.set(e.value)}navigateToCreateService(){this.router.navigate(["/dashboard/services/create-service"])}navigateToCreateBusiness(){this.router.navigate(["/dashboard/businesses/create-business"])}viewService(t){this.editService(t)}editService(t){this.router.navigate(["/dashboard/services/edit-service",t])}deleteService(t){return M(this,null,function*(){let e=this.userServices().find(s=>s._id===t);if(!(!e||!confirm(`Are you sure you want to delete "${e.name}"? This action cannot be undone.`)))try{yield this.businessService.deleteServiceAsync(t);let s=this.userServices().filter(l=>l._id!==t);this.userServices.set(s),alert("Service deleted successfully!")}catch(s){console.error("Error deleting service:",s),alert(s.message||"Failed to delete service")}})}getBusinessName(t){return typeof t.business_id=="object"&&t.business_id?.name?t.business_id.name:"Unknown Business"}getBusinessNameMap(){let t={};return this.userServices().forEach(e=>{t[e._id]=this.getBusinessName(e)}),t}formatPrice(t){if(!t.price)return"Price not set";switch(t.pricing_type){case"hourly":return`$${t.price}/hour`;case"project":return`$${t.price}/project`;case"custom":return"Custom pricing";default:return`$${t.price}`}}formatDate(t){return new Date(t).toLocaleDateString()}getStatusColor(t){return t?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}getStatusText(t){return t?"Active":"Inactive"}handleClearFilters=()=>{this.clearSearch(),this.selectedBusiness.set("all")};handleCreateBusiness=()=>{this.navigateToCreateBusiness()};handleCreateService=()=>{this.navigateToCreateService()};static \u0275fac=function(e){return new(e||i)};static \u0275cmp=x({type:i,selectors:[["app-list-services"]],decls:26,vars:7,consts:[[1,"min-h-screen","bg-gray-50"],[1,"mb-8"],[1,"lg:max-w-7xl","max-w-12xl"],[1,"px-6","pt-6"],["title","My Services","subtitle","Manage services across all your businesses",3,"backClicked"],["matButton","filled","color","primary",1,"flex","items-center",3,"click","disabled"],[1,"mr-2"],[1,"px-0","sm:px-6","pt-4"],[3,"searchChange","viewModeChange","clearSearch","searchTerm","viewMode"],[1,"w-full","sm:w-48"],["appearance","outline","subscriptSizing","dynamic",1,"w-full"],[3,"selectionChange","value"],["value","all"],[3,"value"],["matPrefix",""],[1,"mx-6","mb-6","bg-yellow-50","border-l-4","border-yellow-400","p-4","rounded-r-lg"],[1,"mb-6","bg-red-50","border-l-4","border-red-400","p-4","rounded-r-lg"],[1,"flex","items-center","justify-center","min-h-screen"],[1,"flex"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-yellow-400","mr-3"],["fill-rule","evenodd","d","M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule","evenodd"],[1,"text-sm","font-medium","text-yellow-800"],[1,"mt-1","text-sm","text-yellow-700"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-red-400","mr-3"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule","evenodd"],[1,"text-sm","font-medium","text-red-800"],[1,"mt-1","text-sm","text-red-700"],[3,"diameter","strokeWidth"],[1,"lg:max-w-7xl","max-w-12xl","px-6","pb-12"],["icon","search_off","title","No services found","description","Try adjusting your search term or filter to find what you're looking for.",3,"buttons"],["icon","business","title","Create a business first","description","You need to have at least one business before you can create services.",3,"buttons"],["icon","handshake","title","No services yet","description","Get started by creating your first service for your business.",3,"buttons"],[1,"lg:max-w-7xl","max-w-12xl","lg:px-6","px-0","pb-12"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],[3,"service","businessName","statusColorClass","statusText"],[3,"view","edit","delete","service","businessName","statusColorClass","statusText"],[3,"view","edit","delete","services","businessNameMap","displayedColumns"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"app-dashboard-subheader",4),v("backClicked",function(){return n.navigateToCreateService()}),r(5,"button",5),v("click",function(){return n.navigateToCreateService()}),r(6,"mat-icon",6),a(7,"add"),o(),a(8," New Service "),o()()(),r(9,"div",7)(10,"app-business-search-filter",8),v("searchChange",function(l){return n.searchTerm.set(l)})("viewModeChange",function(l){return n.setViewMode(l)})("clearSearch",function(){return n.clearSearch()}),r(11,"div",9)(12,"mat-form-field",10)(13,"mat-label"),a(14,"Business"),o(),r(15,"mat-select",11),v("selectionChange",function(l){return n.selectedBusiness.set(l.value)}),r(16,"mat-option",12),a(17,"All Businesses"),o(),E(18,yt,2,2,"mat-option",13,lt),o(),r(20,"mat-icon",14),a(21,"business"),o()()()()()(),u(22,Mt,9,0,"div",15),u(23,wt,9,1,"div",16),u(24,Pt,2,2,"div",17)(25,Dt,2,1),o()()),e&2&&(c(5),m("disabled",n.userBusinesses().length===0),c(5),m("searchTerm",n.searchTerm())("viewMode",n.viewMode()),c(5),m("value",n.selectedBusiness()),c(3),O(n.userBusinesses()),c(4),p(n.userBusinesses().length===0?22:-1),c(),p(n.error()?23:-1),c(),p(n.loading()?24:25))},dependencies:[y,R,He,X,te,ee,Z,Ye,ne,ie,W,k,V,T,L,F,K,J,re,Ze,ce,le,it],styles:[".services-container[_ngcontent-%COMP%]{max-width:80rem;margin:0 auto;padding:1.5rem}.services-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.services-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#111827;margin:0}.services-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#6b7280;margin-top:.5rem}.services-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:1rem}.search-filter-bar[_ngcontent-%COMP%]{background-color:#fff;padding:1.5rem;border-radius:.5rem;box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f;margin-bottom:2rem}.search-filter-bar[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto auto;gap:1rem;align-items:center}@media (max-width: 768px){.search-filter-bar[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}}.search-filter-bar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{display:flex;align-items:center;position:relative}.search-filter-bar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:.75rem;height:1.25rem;width:1.25rem;color:#9ca3af}.search-filter-bar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem .75rem 2.5rem;border:1px solid #d1d5db;border-radius:.375rem;font-size:.875rem}.search-filter-bar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 2px #3b82f680}.search-filter-bar[_ngcontent-%COMP%]   .business-filter[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.75rem 1rem;border:1px solid #d1d5db;border-radius:.375rem;font-size:.875rem;background-color:#fff}.search-filter-bar[_ngcontent-%COMP%]   .business-filter[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 2px #3b82f680}.search-filter-bar[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]{display:flex;border:1px solid #d1d5db;border-radius:.375rem;overflow:hidden}.search-filter-bar[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem .75rem;border:none;background-color:#fff;color:#6b7280;cursor:pointer;display:flex;align-items:center;gap:.25rem}.search-filter-bar[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.search-filter-bar[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff}.search-filter-bar[_ngcontent-%COMP%]   .view-toggle[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:1rem;width:1rem}.services-grid[_ngcontent-%COMP%]{display:grid;gap:1.5rem}.services-grid.grid-view[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(350px,1fr))}.services-grid.list-view[_ngcontent-%COMP%]{grid-template-columns:1fr}.service-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:.5rem;box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f;overflow:hidden;transition:box-shadow .2s ease-in-out}.service-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f}.service-card.list-view[_ngcontent-%COMP%]{display:flex;align-items:center;padding:1rem}.service-card.list-view[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{flex:1;display:grid;grid-template-columns:2fr 1fr 1fr auto;gap:1rem;align-items:center}.service-card.grid-view[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{padding:1.5rem}.service-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1rem}.service-header[_ngcontent-%COMP%]   .service-info[_ngcontent-%COMP%]{flex:1}.service-header[_ngcontent-%COMP%]   .service-info[_ngcontent-%COMP%]   .service-name[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#111827;margin:0 0 .25rem;line-height:1.4}.service-header[_ngcontent-%COMP%]   .service-info[_ngcontent-%COMP%]   .service-business[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;margin-bottom:.5rem}.service-header[_ngcontent-%COMP%]   .service-status[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:.25rem}.service-header[_ngcontent-%COMP%]   .service-status[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:.25rem;font-size:.75rem;font-weight:500}.service-header[_ngcontent-%COMP%]   .service-status[_ngcontent-%COMP%]   .status-badge.active[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534}.service-header[_ngcontent-%COMP%]   .service-status[_ngcontent-%COMP%]   .status-badge.inactive[_ngcontent-%COMP%]{background-color:#fef2f2;color:#dc2626}.service-header[_ngcontent-%COMP%]   .service-status[_ngcontent-%COMP%]   .status-badge.featured[_ngcontent-%COMP%]{background-color:#fef3c7;color:#92400e}.service-description[_ngcontent-%COMP%]{color:#6b7280;font-size:.875rem;line-height:1.5;margin-bottom:1rem;display:-webkit-box;-webkit-line-clamp:3;line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.service-features[_ngcontent-%COMP%]{margin-bottom:1rem}.service-features[_ngcontent-%COMP%]   .features-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.service-features[_ngcontent-%COMP%]   .features-list[_ngcontent-%COMP%]   .feature-tag[_ngcontent-%COMP%]{padding:.25rem .5rem;background-color:#eff6ff;color:#1d4ed8;font-size:.75rem;border-radius:.25rem}.service-price[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:1rem}.service-price[_ngcontent-%COMP%]   .price-amount[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:#111827}.service-price[_ngcontent-%COMP%]   .price-type[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;text-transform:capitalize}.service-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.service-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:.5rem 1rem;border-radius:.375rem;font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s ease-in-out}.service-actions[_ngcontent-%COMP%]   button.btn-primary[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff;border:1px solid #3b82f6}.service-actions[_ngcontent-%COMP%]   button.btn-primary[_ngcontent-%COMP%]:hover{background-color:#2563eb}.service-actions[_ngcontent-%COMP%]   button.btn-secondary[_ngcontent-%COMP%]{background-color:#fff;color:#374151;border:1px solid #d1d5db}.service-actions[_ngcontent-%COMP%]   button.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.service-actions[_ngcontent-%COMP%]   button.btn-danger[_ngcontent-%COMP%]{background-color:#dc2626;color:#fff;border:1px solid #dc2626}.service-actions[_ngcontent-%COMP%]   button.btn-danger[_ngcontent-%COMP%]:hover{background-color:#b91c1c}.service-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{margin:0 auto 1rem;height:4rem;width:4rem;color:#9ca3af}.empty-state[_ngcontent-%COMP%]   .empty-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#111827;margin-bottom:.5rem}.empty-state[_ngcontent-%COMP%]   .empty-description[_ngcontent-%COMP%]{color:#6b7280;margin-bottom:2rem}.loading-state[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:4rem 2rem}.loading-state[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite;border-radius:50%;height:2rem;width:2rem;border:2px solid #f3f4f6;border-top:2px solid #3b82f6}.loading-state[_ngcontent-%COMP%]   .loading-text[_ngcontent-%COMP%]{margin-left:1rem;color:#6b7280}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-state[_ngcontent-%COMP%]{background-color:#fef2f2;border:1px solid #fecaca;border-radius:.375rem;padding:1rem;margin-bottom:2rem}.error-state[_ngcontent-%COMP%]   .error-title[_ngcontent-%COMP%]{font-weight:600;color:#dc2626;margin-bottom:.5rem}.error-state[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#b91c1c}@media (max-width: 768px){.services-container[_ngcontent-%COMP%]{padding:1rem}.services-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.services-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{width:100%;justify-content:flex-start}.services-grid.grid-view[_ngcontent-%COMP%]{grid-template-columns:1fr}.service-card.list-view[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:.75rem}.service-actions[_ngcontent-%COMP%]{flex-direction:column}.service-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:none}}"]})};var Vt=(i,t)=>t._id;function Lt(i,t){if(i&1&&(r(0,"div",3),_(1,"mat-spinner",6),o()),i&2){let e=d();c(),m("diameter",e.isMobile()?40:60)("strokeWidth",4)}}function At(i,t){if(i&1){let e=I();r(0,"div",4)(1,"div",7)(2,"div",8)(3,"mat-icon",9),a(4,"error_outline"),o()(),r(5,"h3",10),a(6),o(),r(7,"div",11)(8,"button",12),v("click",function(){f(e);let s=d();return C(s.goBack())}),a(9," Go Back "),o(),r(10,"button",13),v("click",function(){f(e);let s=d();return C(s.loadData())}),a(11," Try Again "),o()()()()}if(i&2){let e=d();c(6),w(e.error())}}function $t(i,t){i&1&&(r(0,"div",4)(1,"div",7)(2,"div",14)(3,"mat-icon",15),a(4,"business"),o()(),r(5,"h3",10),a(6,"No businesses found"),o(),r(7,"p",16),a(8,"You need to create a business before adding services."),o(),r(9,"button",17)(10,"mat-icon",18),a(11,"add"),o(),a(12," Create Business "),o()()())}function jt(i,t){if(i&1&&(r(0,"mat-option",39),a(1),o()),i&2){let e=t.$implicit;m("value",e._id),c(),S(" ",e.name," ")}}function Ut(i,t){i&1&&(r(0,"mat-error"),a(1,"Please select a business"),o())}function zt(i,t){if(i&1&&(r(0,"mat-form-field",27)(1,"mat-label"),a(2,"Business"),o(),r(3,"mat-select",59),E(4,jt,2,2,"mat-option",39,Vt),o(),u(6,Ut,2,0,"mat-error"),o()),i&2){let e=d(2);c(4),O(e.userBusinesses()),c(2),p(e.business_id!=null&&e.business_id.hasError("required")&&(e.business_id!=null&&e.business_id.touched)?6:-1)}}function Gt(i,t){i&1&&(r(0,"mat-error"),a(1,"Service name is required"),o())}function Rt(i,t){i&1&&(r(0,"mat-error"),a(1,"Service name must be at least 2 characters"),o())}function Ht(i,t){i&1&&(r(0,"mat-error"),a(1,"Service name cannot exceed 100 characters"),o())}function qt(i,t){i&1&&(r(0,"mat-error"),a(1,"Price cannot be negative"),o())}function Wt(i,t){if(i&1&&(r(0,"mat-option",39),a(1),we(2,"titlecase"),o()),i&2){let e=t.$implicit;m("value",e),c(),S(" ",Pe(2,2,e)," ")}}function Yt(i,t){if(i&1){let e=I();r(0,"div",61),_(1,"img",62),r(2,"button",63),v("click",function(){let s=f(e).$implicit,l=d(3);return C(l.removeExistingImage(s))}),r(3,"mat-icon",64),a(4,"close"),o()()()}if(i&2){let e=t.$implicit,n=t.$index;c(),m("src",e,j)("alt","Service image "+(n+1))}}function Qt(i,t){if(i&1&&(r(0,"div")(1,"h4",34),a(2,"Current Images"),o(),r(3,"div",60),E(4,Yt,5,2,"div",61,z),o()()),i&2){let e=d(2);c(4),O(e.existingImages())}}function Jt(i,t){if(i&1){let e=I();r(0,"div",61),_(1,"img",62),r(2,"button",63),v("click",function(){let s=f(e).$index,l=d(3);return C(l.removeImage(s))}),r(3,"mat-icon",64),a(4,"close"),o()()()}if(i&2){let e=t.$implicit,n=t.$index;c(),m("src",e,j)("alt","Preview "+(n+1))}}function Kt(i,t){if(i&1&&(r(0,"div")(1,"h4",34),a(2,"New Images to Upload"),o(),r(3,"div",65),E(4,Jt,5,2,"div",61,z),o()()),i&2){let e=d(2);c(4),O(e.imagePreviewUrls())}}function Xt(i,t){i&1&&(r(0,"div",57)(1,"mat-icon",66),a(2,"refresh"),o(),r(3,"span"),a(4,"Uploading images..."),o()())}function Zt(i,t){if(i&1&&(_e(0),a(1),fe()),i&2){let e=d(2);c(),S(" ",e.isEditMode()?"Updating...":"Creating..."," ")}}function ei(i,t){if(i&1&&(_e(0),a(1),fe()),i&2){let e=d(2);c(),S(" ",e.submitButtonText()," ")}}function ti(i,t){if(i&1){let e=I();r(0,"div",5)(1,"div",19)(2,"app-dashboard-subheader",20),v("backClicked",function(){f(e);let s=d();return C(s.goBack())}),o()(),r(3,"mat-card",21)(4,"mat-stepper",22,0)(6,"mat-step",23)(7,"form",24)(8,"div")(9,"h3",25),a(10," Service Details "),o(),r(11,"p",26),a(12," Provide basic information about your service. "),o()(),u(13,zt,7,1,"mat-form-field",27),r(14,"mat-form-field",27)(15,"mat-label"),a(16,"Service Name"),o(),_(17,"input",28),u(18,Gt,2,0,"mat-error"),u(19,Rt,2,0,"mat-error"),u(20,Ht,2,0,"mat-error"),o(),r(21,"mat-form-field",27)(22,"mat-label"),a(23,"Full Description"),o(),_(24,"textarea",29),o(),r(25,"div",30)(26,"button",31),v("click",function(){f(e);let s=D(5),l=d();return C(l.nextStep(s))}),a(27," Next "),r(28,"mat-icon",32),a(29,"arrow_forward"),o()()()()(),r(30,"mat-step",33)(31,"form",24)(32,"div")(33,"h3",25),a(34," Pricing & Service Features "),o(),r(35,"p",26),a(36," Set your pricing and define what's included in your service. "),o()(),r(37,"div")(38,"h4",34),a(39,"Pricing Information"),o(),r(40,"div",35)(41,"mat-form-field",36)(42,"mat-label"),a(43,"Price"),o(),_(44,"input",37),u(45,qt,2,0,"mat-error"),o(),r(46,"mat-form-field",36)(47,"mat-label"),a(48,"Pricing Type"),o(),r(49,"mat-select",38),E(50,Wt,3,4,"mat-option",39,z),o()()(),r(52,"mat-form-field",27)(53,"mat-label"),a(54,"Duration"),o(),_(55,"input",40),o()(),r(56,"div")(57,"h4",34),a(58,"Service Details"),o(),r(59,"mat-form-field",27)(60,"mat-label"),a(61,"Features"),o(),_(62,"textarea",41),r(63,"mat-hint"),a(64,"Separate features with commas"),o()(),r(65,"mat-form-field",27)(66,"mat-label"),a(67,"Tags"),o(),_(68,"input",42),r(69,"mat-hint"),a(70,"Separate tags with commas"),o()()(),r(71,"div")(72,"h4",34),a(73,"Service Status"),o(),r(74,"div",43)(75,"mat-checkbox",44),a(76," Active (visible to customers) "),o(),r(77,"mat-checkbox",45),a(78," Featured service "),o()()(),r(79,"div",46)(80,"button",47),v("click",function(){f(e);let s=D(5),l=d();return C(l.previousStep(s))}),r(81,"mat-icon",18),a(82,"arrow_back"),o(),a(83," Previous "),o(),r(84,"button",31),v("click",function(){f(e);let s=D(5),l=d();return C(l.nextStep(s))}),a(85," Next "),r(86,"mat-icon",32),a(87,"arrow_forward"),o()()()()(),r(88,"mat-step",48)(89,"div",49)(90,"div")(91,"h3",25),a(92," Service Images "),o(),r(93,"p",26),a(94," Add images to showcase your service (optional). You can upload up to 5 images, max 5MB each. "),o()(),u(95,Qt,6,0,"div"),r(96,"div",50)(97,"div",51)(98,"mat-icon",52),a(99,"cloud_upload"),o(),r(100,"h4",10),a(101,"Upload Images"),o(),r(102,"p",53),a(103,"Drag and drop images here, or click to select files"),o(),r(104,"input",54,1),v("change",function(s){f(e);let l=d();return C(l.onImageSelect(s))}),o(),r(106,"div",55)(107,"button",31),v("click",function(){f(e);let s=D(105);return C(s.click())}),r(108,"mat-icon",18),a(109,"add_photo_alternate"),o(),a(110," Select Images "),o()(),r(111,"p",56),a(112),o()()(),u(113,Kt,6,0,"div"),u(114,Xt,5,0,"div",57),r(115,"div",46)(116,"button",47),v("click",function(){f(e);let s=D(5),l=d();return C(l.previousStep(s))}),r(117,"mat-icon",18),a(118,"arrow_back"),o(),a(119," Back "),o(),r(120,"button",58),v("click",function(){f(e);let s=d();return C(s.onSubmit())}),u(121,Zt,2,1,"ng-container")(122,ei,2,1,"ng-container"),o()()()()()()()}if(i&2){let e=d();c(2),m("title",e.isEditMode()?"Edit Your Service":"Create Your Service")("subtitle",e.isEditMode()?"Update your service information and settings":"Create a new service for your business"),c(2),m("linear",!0)("orientation",e.isMobile()?"vertical":"horizontal"),c(2),m("stepControl",e.serviceInfoForm),c(),m("formGroup",e.serviceInfoForm),c(6),p(e.isEditMode()?-1:13),c(5),p(e.name!=null&&e.name.hasError("required")&&(e.name!=null&&e.name.touched)?18:-1),c(),p(e.name!=null&&e.name.hasError("minlength")&&(e.name!=null&&e.name.touched)?19:-1),c(),p(e.name!=null&&e.name.hasError("maxlength")&&(e.name!=null&&e.name.touched)?20:-1),c(6),m("disabled",!e.isServiceInfoValid()),c(4),m("stepControl",e.servicePricingForm),c(),m("formGroup",e.servicePricingForm),c(14),p(e.price!=null&&e.price.hasError("min")&&(e.price!=null&&e.price.touched)?45:-1),c(5),O(e.pricingTypes),c(34),m("disabled",!e.isServicePricingValid()),c(11),p(e.isEditMode()&&e.existingImages().length>0?95:-1),c(12),m("disabled",e.selectedImages().length+e.existingImages().length>=5),c(5),S(" ",e.selectedImages().length+e.existingImages().length," of 5 images selected "),c(),p(e.selectedImages().length>0?113:-1),c(),p(e.uploadingImages()?114:-1),c(6),m("disabled",!e.canSubmitService()),c(),p(e.submitting()?121:122)}}var U=class i{authService=b(Y);router=b(G);route=b(Oe);businessService=b(Q);fb=b(Re);breakpointObserver=b(H);userBusinesses=g([]);currentService=g(null);loading=g(!1);error=g(null);submitting=g(!1);isEditMode=g(!1);serviceId=g("");uploadingImages=g(!1);selectedImages=g([]);imagePreviewUrls=g([]);existingImages=g([]);isMobile=g(!1);serviceInfoForm;servicePricingForm;pricingTypes=["fixed","hourly","project","custom"];hasBusinesses=N(()=>this.userBusinesses().length>0);canSubmitService=N(()=>this.hasBusinesses()&&!this.submitting());pageTitle=N(()=>this.isEditMode()?"Edit Service":"Create New Service");submitButtonText=N(()=>this.isEditMode()?"Update Service":"Create Service");constructor(){this.serviceInfoForm=this.fb.group({business_id:["",[$.required]],name:["",[$.required,$.minLength(2),$.maxLength(100)]],description:[""]}),this.servicePricingForm=this.fb.group({price:[null,[$.min(0)]],pricing_type:["fixed"],duration:[""],is_active:[!0],is_featured:[!1],features:[""],tags:[""]}),this.serviceInfoForm.get("name")?.valueChanges.subscribe(t=>{})}ngOnInit(){return M(this,null,function*(){this.breakpointObserver.observe([q.Handset]).subscribe(e=>{this.isMobile.set(e.matches)});let t=this.route.snapshot.paramMap.get("id");if(t&&(this.isEditMode.set(!0),this.serviceId.set(t)),yield this.loadUserBusinesses(),!this.hasBusinesses()){this.router.navigate(["/dashboard/businesses/create-business"]);return}if(this.isEditMode())yield this.loadService();else{let e=this.route.snapshot.queryParamMap.get("businessId");if(e)this.userBusinesses().find(l=>l._id===e)&&this.serviceInfoForm.get("business_id")?.setValue(e);else{let n=this.userBusinesses();n.length===1&&this.serviceInfoForm.get("business_id")?.setValue(n[0]._id)}}})}loadUserBusinesses(){return M(this,null,function*(){this.loading.set(!0),this.error.set(null);try{let t=yield this.businessService.getMyBusinessesAsync();this.userBusinesses.set(t)}catch(t){console.error("Error loading user businesses:",t),this.error.set(t?.message||"Failed to load businesses")}finally{this.loading.set(!1)}})}loadService(){return M(this,null,function*(){this.loading.set(!0),this.error.set(null);try{let t=yield this.businessService.getServiceAsync(this.serviceId());if(!t)throw new Error("Service not found");this.currentService.set(t),this.populateForm(t)}catch(t){console.error("Error loading service:",t),this.error.set(t?.message||"Failed to load service")}finally{this.loading.set(!1)}})}populateForm(t){this.serviceInfoForm.patchValue({business_id:typeof t.business_id=="string"?t.business_id:t.business_id._id,name:t.name,short_description:t.short_description||"",description:t.description||""}),this.servicePricingForm.patchValue({price:t.price,pricing_type:t.pricing_type||"fixed",duration:t.duration||"",is_active:t.is_active??!0,is_featured:t.is_featured??!1,features:t.features?.join(", ")||"",tags:t.tags?.join(", ")||""}),t.images&&t.images.length>0&&this.existingImages.set([...t.images])}formatFeatures(t){return t.trim()?t.split(",").map(e=>e.trim()).filter(e=>e.length>0):[]}formatTags(t){return t.trim()?t.split(",").map(e=>e.trim()).filter(e=>e.length>0):[]}isServiceInfoValid(){return this.serviceInfoForm.valid}isServicePricingValid(){return this.servicePricingForm.valid}nextStep(t){t.next()}previousStep(t){t.previous()}onSubmit(){return M(this,null,function*(){if(!this.isServiceInfoValid()||!this.isServicePricingValid()||this.submitting()){this.markAllFormsTouched();return}this.submitting.set(!0),this.error.set(null);try{let t=this.serviceInfoForm.value,e=this.servicePricingForm.value,n,s,l={name:t.name,short_description:t.short_description||void 0,description:t.description||void 0,features:this.formatFeatures(e.features),price:e.price||void 0,pricing_type:e.pricing_type,duration:e.duration||void 0,tags:this.formatTags(e.tags),is_active:e.is_active,is_featured:e.is_featured};this.isEditMode()?(s=this.serviceId(),n=yield this.businessService.updateServiceAsync(s,l)):(n=yield this.businessService.createServiceAsync(t.business_id,l),s=n._id);try{let h=yield this.uploadImages(s);if(h.length>0&&(yield this.businessService.updateServiceAsync(s,{images:h})),this.isEditMode()){let ue=(this.currentService()?.images||[]).filter(pe=>!this.existingImages().includes(pe));for(let pe of ue)try{yield this.businessService.deleteServiceImageAsync(s,pe)}catch(dt){console.warn("Failed to delete image:",dt)}}}catch(h){console.error("Error handling images:",h),this.error.set(`Service saved but image upload failed: ${h.message}`)}this.router.navigate(["/dashboard/services"])}catch(t){console.error("Error saving service:",t),this.error.set(t?.message||`Failed to ${this.isEditMode()?"update":"create"} service`)}finally{this.submitting.set(!1)}})}markAllFormsTouched(){Object.keys(this.serviceInfoForm.controls).forEach(t=>{this.serviceInfoForm.get(t)?.markAsTouched()}),Object.keys(this.servicePricingForm.controls).forEach(t=>{this.servicePricingForm.get(t)?.markAsTouched()})}onCancel(){this.router.navigate(["/dashboard/services"])}goBack(){this.router.navigate(["/dashboard/services"])}loadData(){this.isEditMode()?this.loadService():this.loadUserBusinesses()}get business_id(){return this.serviceInfoForm.get("business_id")}get name(){return this.serviceInfoForm.get("name")}get short_description(){return this.serviceInfoForm.get("short_description")}get description(){return this.serviceInfoForm.get("description")}get features(){return this.serviceInfoForm.get("features")}get price(){return this.servicePricingForm.get("price")}get pricing_type(){return this.servicePricingForm.get("pricing_type")}get duration(){return this.servicePricingForm.get("duration")}get tags(){return this.servicePricingForm.get("tags")}get is_active(){return this.servicePricingForm.get("is_active")}get is_featured(){return this.servicePricingForm.get("is_featured")}onImageSelect(t){let e=t.target;if(e.files&&e.files.length>0){let n=Array.from(e.files),s=n.filter(me=>{let be=me.type.startsWith("image/"),ue=me.size<=5*1024*1024;return be&&ue});s.length!==n.length&&this.error.set("Some files were rejected. Please ensure all files are images under 5MB.");let h=[...this.selectedImages(),...s];h.length>5?(this.selectedImages.set(h.slice(0,5)),this.error.set("Maximum 5 images allowed. Some images were not added.")):this.selectedImages.set(h),this.generateImagePreviews()}}removeImage(t){let n=this.selectedImages().filter((s,l)=>l!==t);this.selectedImages.set(n),this.generateImagePreviews()}removeExistingImage(t){let n=this.existingImages().filter(s=>s!==t);this.existingImages.set(n)}generateImagePreviews(){let t=this.selectedImages(),e=[];t.forEach(n=>{let s=new FileReader;s.onload=l=>{let h=l.target?.result;e.push(h),e.length===t.length&&this.imagePreviewUrls.set(e)},s.readAsDataURL(n)}),t.length===0&&this.imagePreviewUrls.set([])}uploadImages(t){return M(this,null,function*(){let e=this.selectedImages();if(e.length===0)return this.existingImages();this.uploadingImages.set(!0);try{let n=yield this.businessService.uploadServiceImagesAsync(t,e);return[...this.existingImages(),...n.images]}catch(n){throw console.error("Error uploading images:",n),new Error("Failed to upload images")}finally{this.uploadingImages.set(!1)}})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=x({type:i,selectors:[["app-create-service"]],decls:5,vars:1,consts:[["stepper",""],["fileInput",""],[1,"min-h-screen","bg-gray-50"],[1,"flex","justify-center","items-center","min-h-screen"],[1,"max-w-2xl","mx-auto","px-4","sm:px-6","lg:px-8","py-12"],[1,"lg:max-w-6xl","max-w-12xl","px-0","lg:px-8","py-8"],[3,"diameter","strokeWidth"],[1,"text-center","py-12","bg-white","rounded-lg","shadow-sm","border","border-gray-200"],[1,"text-red-400","mb-4"],[1,"text-6xl"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"space-x-4"],[1,"bg-gray-600","text-white","px-4","py-2","rounded-lg","hover:bg-gray-700","transition-colors",3,"click"],[1,"bg-blue-600","text-white","px-4","py-2","rounded-lg","hover:bg-blue-700","transition-colors",3,"click"],[1,"mx-auto","h-12","w-12","text-gray-400","mb-4"],[2,"font-size","48px","height","48px","width","48px"],[1,"text-sm","text-gray-500","mb-6"],["routerLink","/dashboard/businesses/create-business",1,"bg-gray-900","hover:bg-gray-800","text-white","px-6","py-2","rounded-lg","font-medium","transition-colors","flex","items-center"],[1,"mr-2"],[1,"px-6"],[3,"backClicked","title","subtitle"],[1,"w-full"],[1,"service-stepper",3,"linear","orientation"],["label","Service Information",3,"stepControl"],[1,"lg:p-6","space-y-6",3,"formGroup"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[1,"text-gray-600","mb-6"],["appearance","outline",1,"w-full"],["matInput","","formControlName","name","placeholder","e.g., Web Design, Logo Creation","required",""],["matInput","","formControlName","description","rows","4","placeholder","Detailed description of your service"],[1,"flex","justify-end"],["type","button","matButton","filled","color","primary","mat-raised-button","",1,"flex","items-center",3,"click","disabled"],[1,"ml-2"],["label","Pricing & Features",3,"stepControl"],[1,"text-md","font-medium","text-gray-900","mb-3"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["appearance","outline"],["matInput","","type","number","formControlName","price","min","0","step","0.01","placeholder","0.00"],["formControlName","pricing_type"],[3,"value"],["matInput","","formControlName","duration","placeholder","e.g., 2-3 weeks, 1 hour"],["matInput","","formControlName","features","rows","3","placeholder","Feature 1, Feature 2, Feature 3"],["matInput","","formControlName","tags","placeholder","tag1, tag2, tag3"],[1,"space-y-4"],["formControlName","is_active"],["formControlName","is_featured"],[1,"flex","justify-between"],["type","button","mat-stroked-button","","color","accent",1,"flex","items-center",3,"click"],["label","Images & Finish"],[1,"lg:p-6","space-y-6"],[1,"border-2","border-dashed","border-gray-300","rounded-lg","p-6"],[1,"text-center"],[1,"text-4xl","text-gray-400","mb-4"],[1,"text-gray-600","mb-4"],["type","file","multiple","","accept","image/*",1,"hidden",3,"change"],[1,"flex","justify-center"],[1,"text-sm","text-gray-500","mt-2"],[1,"flex","items-center","justify-center","py-4"],["type","button","matButton","filled","color","primary",3,"click","disabled"],["formControlName","business_id","required",""],[1,"grid","grid-cols-2","md:grid-cols-3","lg:grid-cols-4","gap-4","mb-6"],[1,"relative","group"],[1,"w-full","h-32","object-cover","rounded-lg","border","border-gray-200",3,"src","alt"],["type","button",1,"absolute","top-2","right-2","bg-red-500","text-white","rounded-full","p-1","opacity-0","group-hover:opacity-100","transition-opacity",3,"click"],[1,"text-sm"],[1,"grid","grid-cols-2","md:grid-cols-3","lg:grid-cols-4","gap-4"],[1,"animate-spin","mr-2"]],template:function(e,n){e&1&&(r(0,"div",2),u(1,Lt,2,2,"div",3)(2,At,12,1,"div",4)(3,$t,13,0,"div",4)(4,ti,123,22,"div",5),o()),e&2&&(c(),p(n.loading()?1:n.error()?2:n.hasBusinesses()?4:3))},dependencies:[y,R,ke,X,Ae,De,$e,Ve,Le,Ge,ze,je,Ue,te,ee,Z,We,qe,Je,Qe,ne,ie,W,k,V,F,A,Xe,Ke,ot,nt,rt,T,L,K,J,re,Ee],encapsulation:2})};var Vn=[{path:"",component:oe,children:[{path:"list-services",component:de},{path:"",redirectTo:"list-services",pathMatch:"full"},{path:"create-service",component:U},{path:"edit-service/:id",component:U}]}];export{Vn as SERVICES_ROUTES};
