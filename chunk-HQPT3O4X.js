import"./chunk-FNU2S2SM.js";import{a as ee,b as te}from"./chunk-7IB7WRLI.js";import{b as Q,f as W,g as X}from"./chunk-J73GYXEA.js";import{b as Y,c as H,f as J,i as K}from"./chunk-34MV7HGN.js";import"./chunk-EGMYPSOY.js";import{c as B,e as C,h as D,i as G,l as U,n as $,o as z,v as Z,x as j}from"./chunk-Z3TDL5JS.js";import"./chunk-YU4QUIJE.js";import"./chunk-MPYKQSNE.js";import{b as N,c as A,d as q,e as O}from"./chunk-XNH753K3.js";import{a as V}from"./chunk-FI6EVXVM.js";import{G as I,H as L}from"./chunk-T77N2UQ2.js";import"./chunk-UU5ZPPM4.js";import"./chunk-4KL26AYK.js";import{Ba as k,Ga as p,Ja as S,Ka as u,Ma as f,Pa as l,S as _,Sb as w,Ua as n,Va as o,Wa as P,X as v,Y as y,_a as E,ab as b,bb as c,gc as M,ha as m,nb as i,ob as d,pc as T,rc as R,sa as s,sc as F,xb as g}from"./chunk-YOTEMOQK.js";import{d as x}from"./chunk-QEZ3K4DX.js";var ne=()=>["/auth/forgot-password"],re=()=>["/auth/login"],oe=()=>["/auth/signup"];function se(t,r){t&1&&(n(0,"div",1),P(1,"mat-spinner",4),n(2,"p",5),i(3,"Verifying reset token..."),o()())}function ae(t,r){if(t&1&&(n(0,"div",2)(1,"div",6)(2,"mat-icon",7),i(3,"error_outline"),o(),n(4,"h2",8),i(5,"Invalid Reset Link"),o(),n(6,"p",5),i(7),o()(),n(8,"button",9),i(9," Request New Reset Link "),o(),n(10,"div",10)(11,"p",11),i(12," Remember your password? "),n(13,"a",12),i(14," Back to Login "),o()()()()),t&2){let e=c();s(7),d(e.error()),s(),u("routerLink",g(3,ne)),s(5),u("routerLink",g(4,re))}}function le(t,r){if(t&1&&(n(0,"p",14),i(1,"Resetting password for: "),n(2,"strong"),i(3),o()()),t&2){let e=c(2);s(3),d(e.userEmail())}}function de(t,r){t&1&&i(0," New password is required ")}function me(t,r){t&1&&i(0," Password must be at least 8 characters long ")}function ce(t,r){t&1&&i(0," Password must contain uppercase, lowercase, number, and special character ")}function pe(t,r){if(t&1&&(n(0,"mat-error"),p(1,de,1,0)(2,me,1,0)(3,ce,1,0),o()),t&2){let e=c(2);s(),l(e.newPasswordControl!=null&&e.newPasswordControl.hasError("required")?1:e.newPasswordControl!=null&&e.newPasswordControl.hasError("minlength")?2:e.newPasswordControl!=null&&e.newPasswordControl.hasError("pattern")?3:-1)}}function ue(t,r){t&1&&i(0," Please confirm your password ")}function we(t,r){if(t&1&&(n(0,"mat-error"),p(1,ue,1,0),o()),t&2){let e=c(2);s(),l(e.confirmPasswordControl!=null&&e.confirmPasswordControl.hasError("required")?1:-1)}}function fe(t,r){t&1&&(n(0,"mat-error"),i(1," Passwords do not match "),o())}function he(t,r){if(t&1&&(n(0,"div",25)(1,"div",31)(2,"mat-icon",32),i(3,"error"),o(),n(4,"span",33),i(5),o()()()),t&2){let e=c(2);s(5),d(e.error())}}function xe(t,r){if(t&1&&(n(0,"div",26)(1,"div",34)(2,"mat-icon",32),i(3,"check_circle"),o(),n(4,"span",33),i(5),o()(),n(6,"p",35),i(7,"You will be redirected to login in a few seconds..."),o()()),t&2){let e=c(2);s(5),d(e.successMessage())}}function _e(t,r){t&1&&i(0," Reset Password ")}function Pe(t,r){t&1&&(n(0,"span",28),P(1,"mat-spinner",36),i(2," Resetting Password... "),o())}function ge(t,r){if(t&1){let e=E();n(0,"div",3)(1,"div",13)(2,"h2",8),i(3,"Set New Password"),o(),p(4,le,4,1,"p",14),n(5,"p",5),i(6,"Please enter your new password below."),o()(),n(7,"form",15),b("ngSubmit",function(){v(e);let h=c();return y(h.onSubmit())}),n(8,"mat-form-field",16)(9,"mat-label"),i(10,"New Password"),o(),P(11,"input",17),n(12,"button",18),b("click",function(){v(e);let h=c();return y(h.togglePasswordVisibility())}),n(13,"mat-icon"),i(14),o()(),p(15,pe,4,1,"mat-error"),o(),n(16,"mat-form-field",16)(17,"mat-label"),i(18,"Confirm New Password"),o(),P(19,"input",19),n(20,"button",18),b("click",function(){v(e);let h=c();return y(h.toggleConfirmPasswordVisibility())}),n(21,"mat-icon"),i(22),o()(),p(23,we,2,1,"mat-error")(24,fe,2,0,"mat-error"),o(),n(25,"div",20)(26,"h4",21),i(27,"Password Requirements:"),o(),n(28,"div",22)(29,"div",23)(30,"mat-icon",24),i(31),o(),i(32," At least 8 characters long "),o(),n(33,"div",23)(34,"mat-icon",24),i(35),o(),i(36," One uppercase letter "),o(),n(37,"div",23)(38,"mat-icon",24),i(39),o(),i(40," One lowercase letter "),o(),n(41,"div",23)(42,"mat-icon",24),i(43),o(),i(44," One number "),o(),n(45,"div",23)(46,"mat-icon",24),i(47),o(),i(48," One special character (@$!%*?&) "),o()()(),p(49,he,6,1,"div",25)(50,xe,8,1,"div",26),n(51,"button",27),p(52,_e,1,0)(53,Pe,3,0,"span",28),o(),n(54,"div",29)(55,"a",30),i(56," Remember your password? Back to Login "),o(),n(57,"div",10)(58,"p",11),i(59," Don't have an account? "),n(60,"a",12),i(61," Sign up "),o()()()()()()}if(t&2){let e=c();s(4),l(e.userEmail()?4:-1),s(3),u("formGroup",e.resetPasswordForm),s(4),u("type",e.showPassword()?"text":"password")("disabled",e.loading()),s(),S("aria-label","Toggle password visibility")("aria-pressed",e.showPassword()),s(2),d(e.showPassword()?"visibility_off":"visibility"),s(),l(e.newPasswordControl!=null&&e.newPasswordControl.invalid&&(e.newPasswordControl!=null&&e.newPasswordControl.touched)?15:-1),s(4),u("type",e.showConfirmPassword()?"text":"password")("disabled",e.loading()),s(),S("aria-label","Toggle confirm password visibility")("aria-pressed",e.showConfirmPassword()),s(2),d(e.showConfirmPassword()?"visibility_off":"visibility"),s(),l(e.confirmPasswordControl!=null&&e.confirmPasswordControl.invalid&&(e.confirmPasswordControl!=null&&e.confirmPasswordControl.touched)?23:-1),s(),l(e.resetPasswordForm.hasError("passwordMismatch")&&(e.confirmPasswordControl!=null&&e.confirmPasswordControl.touched)?24:-1),s(5),f("text-green-600",e.hasMinLength())("text-gray-500",!e.hasMinLength()),s(2),d(e.hasMinLength()?"check_circle":"radio_button_unchecked"),s(2),f("text-green-600",e.hasUppercase())("text-gray-500",!e.hasUppercase()),s(2),d(e.hasUppercase()?"check_circle":"radio_button_unchecked"),s(2),f("text-green-600",e.hasLowercase())("text-gray-500",!e.hasLowercase()),s(2),d(e.hasLowercase()?"check_circle":"radio_button_unchecked"),s(2),f("text-green-600",e.hasNumber())("text-gray-500",!e.hasNumber()),s(2),d(e.hasNumber()?"check_circle":"radio_button_unchecked"),s(2),f("text-green-600",e.hasSpecialChar())("text-gray-500",!e.hasSpecialChar()),s(2),d(e.hasSpecialChar()?"check_circle":"radio_button_unchecked"),s(2),l(e.error()?49:-1),s(),l(e.successMessage()?50:-1),s(),u("disabled",!e.isFormValid()||e.loading()),s(),l(e.loading()?53:52),s(3),u("routerLink",g(46,re)),s(5),u("routerLink",g(47,oe))}}function Ce(t){let r=t.get("newPassword"),e=t.get("confirmPassword");return!r||!e||r.value===e.value?null:{passwordMismatch:!0}}var ie=class t{authService=_(V);router=_(R);route=_(T);fb=_(Z);error=m("");successMessage=m("");loading=m(!1);verifyingToken=m(!1);tokenValid=m(!1);userEmail=m("");showPassword=m(!1);showConfirmPassword=m(!1);currentPassword=m("");formValid=m(!1);resetToken="";resetPasswordForm;isFormValid=w(()=>this.formValid());hasMinLength=w(()=>this.currentPassword().length>=8);hasUppercase=w(()=>{let r=this.currentPassword();return/[A-Z]/.test(r)});hasLowercase=w(()=>{let r=this.currentPassword();return/[a-z]/.test(r)});hasNumber=w(()=>{let r=this.currentPassword();return/\d/.test(r)});hasSpecialChar=w(()=>{let r=this.currentPassword();return/[@$!%*?&]/.test(r)});constructor(){this.resetPasswordForm=this.fb.group({newPassword:["",[C.required,C.minLength(8),C.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/)]],confirmPassword:["",[C.required]]},{validators:Ce}),this.resetPasswordForm.get("newPassword")?.valueChanges.subscribe(r=>{this.currentPassword.set(r||"")}),this.resetPasswordForm.statusChanges.subscribe(()=>{this.formValid.set(this.resetPasswordForm.valid)}),this.formValid.set(this.resetPasswordForm.valid)}ngOnInit(){return x(this,null,function*(){this.route.queryParams.subscribe(r=>x(this,null,function*(){this.resetToken=r.token,this.resetToken?yield this.verifyToken():this.error.set("Invalid reset link. Please request a new password reset.")}))})}verifyToken(){return x(this,null,function*(){this.verifyingToken.set(!0);try{let r=yield this.authService.verifyResetToken(this.resetToken);r.success?(this.tokenValid.set(!0),this.userEmail.set(r?.data?.email||"")):(this.error.set(r.message||"Invalid or expired reset token."),this.tokenValid.set(!1))}catch(r){this.error.set(r?.message||"Invalid or expired reset token."),this.tokenValid.set(!1)}finally{this.verifyingToken.set(!1)}})}onSubmit(){return x(this,null,function*(){if(this.clearMessages(),!this.resetPasswordForm.valid){this.resetPasswordForm.hasError("passwordMismatch")?this.error.set("Passwords do not match"):this.error.set("Please check all fields and try again");return}let{newPassword:r,confirmPassword:e}=this.resetPasswordForm.value;this.loading.set(!0);try{let a=yield this.authService.resetPassword(this.resetToken,r,e);a.success?(this.successMessage.set(a.message||"Password has been reset successfully!"),setTimeout(()=>{this.router.navigate(["/auth/login"],{queryParams:{message:"Password reset successful. Please log in with your new password."}})},3e3)):this.error.set(a.message||"Failed to reset password. Please try again.")}catch(a){this.error.set(a?.message||"An unexpected error occurred. Please try again.")}finally{this.loading.set(!1)}})}clearMessages(){this.error.set(""),this.successMessage.set("")}togglePasswordVisibility(){this.showPassword.set(!this.showPassword())}toggleConfirmPasswordVisibility(){this.showConfirmPassword.set(!this.showConfirmPassword())}get newPasswordControl(){return this.resetPasswordForm.get("newPassword")}get confirmPasswordControl(){return this.resetPasswordForm.get("confirmPassword")}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=k({type:t,selectors:[["app-reset-password"]],decls:4,vars:3,consts:[[1,"reset-password-container"],[1,"text-center","space-y-4"],[1,"text-center","space-y-6"],[1,"reset-form-container"],["diameter","40"],[1,"text-gray-600"],[1,"mb-6"],[1,"text-6xl","text-red-500","mb-4"],[1,"text-2xl","font-bold","text-gray-900","mb-2"],["mat-raised-button","","color","primary",1,"w-full","py-3","text-base","font-medium",3,"routerLink"],[1,"mt-4","pt-4","border-t","border-gray-200"],[1,"text-sm","text-gray-600"],["mat-button","","color","primary",1,"text-sm","font-medium","ml-1",3,"routerLink"],[1,"text-center","mb-8"],[1,"text-gray-600","mb-2"],[1,"space-y-6",3,"ngSubmit","formGroup"],["appearance","outline",1,"w-full"],["matInput","","formControlName","newPassword","placeholder","Enter your new password",3,"type","disabled"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["matInput","","formControlName","confirmPassword","placeholder","Confirm your new password",3,"type","disabled"],[1,"mb-4","p-4","bg-gray-50","border","border-gray-200","rounded-lg"],[1,"text-sm","font-medium","text-gray-700","mb-3"],[1,"space-y-2"],[1,"flex","items-center","text-sm"],[1,"text-sm","mr-2"],[1,"mb-4","p-3","bg-red-50","border","border-red-200","rounded-lg"],[1,"mb-4","p-3","bg-green-50","border","border-green-200","rounded-lg"],["mat-raised-button","","color","primary","type","submit",1,"w-full","py-3","text-base","font-medium","mb-4",3,"disabled"],[1,"flex","items-center","justify-center","gap-2"],[1,"space-y-3","text-center"],["mat-button","","color","primary",1,"text-sm",3,"routerLink"],[1,"flex","items-center","text-red-700"],[1,"mr-2","text-sm"],[1,"text-sm"],[1,"flex","items-center","text-green-700"],[1,"text-sm","text-green-600","mt-2"],["diameter","16"]],template:function(e,a){e&1&&(n(0,"div",0),p(1,se,4,0,"div",1)(2,ae,15,5,"div",2)(3,ge,62,48,"div",3),o()),e&2&&(s(),l(a.verifyingToken()?1:-1),s(),l(!a.verifyingToken()&&!a.tokenValid()?2:-1),s(),l(!a.verifyingToken()&&a.tokenValid()?3:-1))},dependencies:[M,j,U,B,D,G,$,z,F,Q,K,Y,H,J,X,W,O,q,A,N,L,I,te,ee],encapsulation:2})};export{ie as ResetPasswordComponent};
