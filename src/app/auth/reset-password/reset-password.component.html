<div class="min-h-screen flex">
  <!-- Left Side - Reset Password Form -->
  <div class="w-full lg:w-1/2 flex items-center justify-center px-6 py-12 bg-white relative overflow-hidden">
    <!-- Mobile SVG Decorations -->
    <div class="lg:hidden absolute top-0 right-0 w-28 h-46 pointer-events-none">
      <img src="/assets/images/Layer-v.svg" alt="" class="w-full h-full">
    </div>
    <div class="lg:hidden absolute bottom-0 left-0 w-47 h-25 pointer-events-none">
      <img src="/assets/images/Layer-x.svg" alt="" class="w-full h-full">
    </div>

    <div class="w-full max-w-md relative z-10">
      <!-- Logo - Centered on mobile and desktop -->
      <div class="lg:mb-8 mb-2  text-center">
        <a routerLink="/" class="inline-block">
          <img src="/assets/logos/colored-logo.svg" alt="VouchHer" class="h-18 lg:h-18 w-auto">
        </a>
      </div>

      <!-- Loading Token Verification -->
      @if (verifyingToken()) {
        <div class="text-center space-y-4 py-12">
          <mat-spinner diameter="40" class="mx-auto"></mat-spinner>
          <p class="text-gray-600">Verifying reset token...</p>
        </div>
      }

      <!-- Invalid Token -->
      @if (!verifyingToken() && !tokenValid()) {
        <div class="text-center space-y-6">
          <div class="mb-8">
            <h1 class="text-2xl lg:text-3xl font-bold text-gray-900 mb-2">Invalid Reset Link</h1>
            <p class="text-gray-600">This password reset link is invalid or has expired.</p>
          </div>
          
          <button 
            mat-flat-button 
            color="primary"
            [routerLink]="['/auth/forgot-password']"
            class="w-full !py-3 !text-base !font-medium !rounded-lg"
          >
            Request New Reset Link
          </button>

          <div class="text-center pt-4">
            <p class="text-sm text-gray-600">
              Remember your password? 
              <a 
                [routerLink]="['/auth/login']"
                class="font-medium text-[#6B0FAE] hover:text-primary-700 ml-1"
              >
                Back to Login
              </a>
            </p>
          </div>
        </div>
      }

      <!-- Valid Token - Reset Form -->
      @if (!verifyingToken() && tokenValid()) {
        <!-- Header - Centered on mobile -->
        <div class="mb-8 text-center lg:text-left">
          <h1 class="text-2xl lg:text-3xl font-bold text-gray-900 mb-2">Reset Password</h1>
          <p class="text-gray-600">Enter your new password</p>
        </div>

        <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()" class="space-y-6">
          <!-- New Password Field -->
          <div>
            <mat-form-field appearance="outline" class="w-full">
              <mat-label>New password</mat-label>
              <input 
                matInput 
                [type]="showPassword() ? 'text' : 'password'" 
                formControlName="newPassword"
                placeholder=""
                [disabled]="loading()"
              />
              <button 
                mat-icon-button 
                matSuffix 
                type="button"
                (click)="togglePasswordVisibility()"
                [attr.aria-label]="'Toggle password visibility'"
                [attr.aria-pressed]="showPassword()"
              >
                <mat-icon>{{ showPassword() ? 'visibility_off' : 'visibility' }}</mat-icon>
              </button>
              @if (newPasswordControl?.invalid && newPasswordControl?.touched) {
                <mat-error>
                  @if (newPasswordControl?.hasError('required')) {
                    New password is required
                  } @else if (newPasswordControl?.hasError('minlength')) {
                    Password must be at least 8 characters long
                  }
                </mat-error>
              }
            </mat-form-field>
            <p class="text-xs text-gray-500 mt-1">
              At least 8 characters long. Uppercase, lowercase, number and special character
            </p>
          </div>

          <!-- Confirm Password Field -->
          <div>
            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Confirm new password</mat-label>
              <input 
                matInput 
                [type]="showConfirmPassword() ? 'text' : 'password'" 
                formControlName="confirmPassword"
                placeholder=""
                [disabled]="loading()"
              />
              <button 
                mat-icon-button 
                matSuffix 
                type="button"
                (click)="toggleConfirmPasswordVisibility()"
                [attr.aria-label]="'Toggle confirm password visibility'"
                [attr.aria-pressed]="showConfirmPassword()"
              >
                <mat-icon>{{ showConfirmPassword() ? 'visibility_off' : 'visibility' }}</mat-icon>
              </button>
              @if (confirmPasswordControl?.invalid && confirmPasswordControl?.touched) {
                <mat-error>
                  @if (confirmPasswordControl?.hasError('required')) {
                    Please confirm your password
                  }
                </mat-error>
              }
              @if (resetPasswordForm.hasError('passwordMismatch') && confirmPasswordControl?.touched) {
                <mat-error>
                  Passwords do not match
                </mat-error>
              }
            </mat-form-field>
            <p class="text-xs text-gray-500 mt-1">Password must be identical.</p>
          </div>

          <!-- Submit Button -->
          <button 
            mat-flat-button 
            color="primary" 
            type="submit"
            class="w-full !py-3 !text-base !font-medium !rounded-lg"
            [disabled]="!isFormValid() || loading()"
          >
            @if (!(loading())) {
              Log in
            } @else {
              <span class="flex items-center justify-center gap-2">
                <mat-spinner diameter="20" class="!text-white"></mat-spinner>
                Resetting Password...
              </span>
            }
          </button>
        </form>
      }
    </div>
  </div>

  <!-- Right Side - Background Image (Hidden on mobile) -->
  <div class="hidden lg:flex lg:w-1/2 relative bg-primary-600 items-center justify-center overflow-hidden">
    <!-- Background SVG -->
    <div class="absolute inset-0">
      <img 
        src="/assets/images/login-right-bakground.svg" 
        alt="" 
        class="w-full h-full object-cover"
      />
    </div>
    
    <!-- Content Overlay -->
    <div class="relative z-10 flex flex-col items-center justify-center text-center px-12 w-full max-w-lg">
      <img 
        src="/assets/logos/white-logo.svg" 
        alt="VouchHer" 
        class="h-16 w-auto mb-12"
      />
      <h2 class="text-white text-2xl font-bold mb-6 text-[#20AA62]">
        Women First Marketplace
      </h2>
      
      <div class="space-y-4 text-white text-left w-full">
        <div>
          <h3 class="font-semibold text-lg mb-2">Find women-owned businesses in seconds</h3>
          <ul class="space-y-2 text-sm">
            <li>1. Earn extra income</li>
            <li>2. Collaborate and grow</li>
            <li>3. Get support from peers</li>
          </ul>
        </div>
        
        <div>
          <h3 class="font-semibold text-lg mb-2 mt-6">Hire qualified women with ease</h3>
          <ul class="space-y-2 text-sm">
            <li>1. List business(es)</li>
            <li>2. Get offers or bids</li>
            <li>3. Pay with ease when job is complete</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
