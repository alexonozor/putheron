<div class="sidebar-content bg-white h-full flex flex-col">
  <!-- User Profile Section - Fixed at top -->
  <div class="p-4 border-b border-gray-200 flex-shrink-0">
    <div class="flex items-center space-x-3 pr-12">
      <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold">
        {{ getUserInitials() }}
      </div>
      <div class="flex-1">
        <h3 class="font-semibold text-gray-900">{{ (user()?.first_name + ' ' + (user()?.last_name || '')).trim() || user()?.email }}</h3>
        <p class="text-sm text-gray-500">{{ user()?.email }}</p>
        <div class="flex items-center mt-1">
          <mat-chip-set>
            @if (isBusinessOwner()) {
              <mat-chip>
                <mat-icon matChipAvatar>business</mat-icon>
                Business Owner
              </mat-chip>
            } @else {
              <mat-chip>
                <mat-icon matChipAvatar>person</mat-icon>
                Client
              </mat-chip>
            }
          </mat-chip-set>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Navigation Menu - Scrollable middle section -->
  <nav class="bg-white flex-1 overflow-y-auto">
    <mat-nav-list class="px-4!">
      <!-- Overview - Business Owner Only -->
      @if (isBusinessOwner()) {
        <mat-list-item 
          routerLink="/dashboard/overview"
          routerLinkActive="active-link"
          [routerLinkActiveOptions]="{exact: true}"
          (click)="navigateAndClose('/dashboard/overview')">
          <mat-icon matListItemIcon>dashboard</mat-icon>
          <span matListItemTitle>Overview</span>
        </mat-list-item>
      }
      
      <!-- Businesses - Business Owner Only -->
      @if (isBusinessOwner()) {
        <mat-list-item 
          routerLink="/dashboard/businesses"
          routerLinkActive="active-link"
          (click)="navigateAndClose('/dashboard/businesses')">
          <mat-icon matListItemIcon>store</mat-icon>
          <span matListItemTitle>Businesses</span>
          <span matListItemMeta class="badge">{{ userBusinessCount() }}</span>
        </mat-list-item>
      }
      
      <!-- Services - Business Owner Only -->
      @if (isBusinessOwner()) {
        <mat-list-item 
          routerLink="/dashboard/services"
          routerLinkActive="active-link"
          (click)="navigateAndClose('/dashboard/services')">
          <mat-icon matListItemIcon>miscellaneous_services</mat-icon>
          <span matListItemTitle>Services</span>
          <span matListItemMeta class="badge">{{ totalServices() }}</span>
        </mat-list-item>
      }
      
      <!-- Projects - Available to Both Modes -->
      <mat-list-item 
        routerLink="/dashboard/projects"
        routerLinkActive="active-link"
        (click)="navigateAndClose('/dashboard/projects')">
        <mat-icon matListItemIcon>work_outline</mat-icon>
        <span matListItemTitle>Projects</span>
        <span matListItemMeta class="badge">{{ totalProjects() }}</span>
      </mat-list-item>
      
      <!-- My Favorites - Available to Both Modes -->
      <mat-list-item 
        routerLink="/dashboard/favorites"
        routerLinkActive="active-link"
        (click)="navigateAndClose('/dashboard/favorites')">
        <mat-icon matListItemIcon>favorite_outline</mat-icon>
        <span matListItemTitle>My Favorites</span>
        <span matListItemMeta class="badge">{{ favoritesCount() }}</span>
      </mat-list-item>
      
      
      <!-- Earnings - Business Owner Only -->
      @if (isBusinessOwner()) {
        <mat-list-item 
          routerLink="/dashboard/earnings"
          routerLinkActive="active-link"
          (click)="navigateAndClose('/dashboard/earnings')">
          <mat-icon matListItemIcon>payments</mat-icon>
          <span matListItemTitle>Earnings & Payments</span>
        </mat-list-item>
      }
      
      <!-- Notifications - Available to Both Modes -->
      <mat-list-item 
        routerLink="/dashboard/notifications"
        routerLinkActive="active-link"
        (click)="navigateAndClose('/dashboard/notifications')">
        <mat-icon matListItemIcon>notifications_none</mat-icon>
        <span matListItemTitle>Notifications</span>
      </mat-list-item>
      
      <!-- Messages - Available to Both Modes -->
      <mat-list-item 
        routerLink="/dashboard/messages"
        routerLinkActive="active-link"
        (click)="navigateAndClose('/dashboard/messages')">
        <mat-icon matListItemIcon>mail_outline</mat-icon>
        <span matListItemTitle>Messages</span>
        <span matListItemMeta class="badge">0</span>
      </mat-list-item>
    </mat-nav-list>

    <mat-divider class="my-4"></mat-divider>

    <!-- Mode Switch Section -->
    <div class="space-y-3 mb-6 p-4">
      <p class="text-xs font-semibold  text-gray-500 uppercase tracking-wider">Account Mode</p>
      @if (!isBusinessOwner()) {
        <button 
          (click)="switchToBusinessMode()"
          mat-flat-button
          color="primary"
          class="w-full">
          <mat-icon class="mr-2">business</mat-icon>
          Switch to Business Owner
        </button>
      } @else {
        <button 
          (click)="switchToClientMode()"
          mat-stroked-button
          class="w-full">
          <mat-icon class="mr-2">person_outline</mat-icon>
          Switch to Client Mode
        </button>
      }
    </div>
  </nav>

  <!-- Logout - Fixed at bottom -->
  <div class="p-4 border-t border-gray-200 bg-white flex-shrink-0">
    <button 
      (click)="logout()"
      mat-button
      class="w-full text-red-600 hover:bg-red-50">
      <mat-icon class="mr-2">logout</mat-icon>
      Sign Out
    </button>
  </div>
</div>
