@if (loading) {
  <div class="p-6 text-center">
    <mat-spinner diameter="30"></mat-spinner>
    <p class="mt-2 text-gray-600">Loading withdrawals...</p>
  </div>
} @else if (withdrawals.length === 0) {
  <app-empty-state 
    icon="account_balance_wallet"
    title="No Withdrawals Yet"
    description="Your withdrawal history will appear here once you make your first withdrawal.">
  </app-empty-state>
} @else {
  <div class="overflow-x-auto">
    <table mat-table [dataSource]="withdrawals" class="w-full">
      <!-- Date Column -->
      <ng-container matColumnDef="date">
        <th mat-header-cell *matHeaderCellDef>Date</th>
        <td mat-cell *matCellDef="let element">
          {{ formatDate(element.createdAt) }}
        </td>
      </ng-container>

      <!-- Method Column -->
      <ng-container matColumnDef="method">
        <th mat-header-cell *matHeaderCellDef>Method</th>
        <td mat-cell *matCellDef="let element">
          <div class="flex items-center gap-2">
            <mat-icon class="text-blue-600">payment</mat-icon>
            <span class="font-medium">{{ element.method | titlecase }}</span>
          </div>
        </td>
      </ng-container>

      <!-- Description Column -->
      <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef>Description</th>
        <td mat-cell *matCellDef="let element" class="text-gray-600">
          Withdrawal to {{ element.method | titlecase }}
        </td>
      </ng-container>

      <!-- Amount Column -->
      <ng-container matColumnDef="amount">
        <th mat-header-cell *matHeaderCellDef class="text-right">Amount</th>
        <td mat-cell *matCellDef="let element" class="text-right font-semibold text-red-600">
          -{{ formatCurrency(element.amount) }}
        </td>
      </ng-container>

      <!-- Status Column -->
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef>Status</th>
        <td mat-cell *matCellDef="let element">
          <span [ngClass]="'inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ' + (element.status === 'completed' ? 'bg-green-100 text-green-800' : element.status === 'pending' ? 'bg-yellow-100 text-yellow-800' : element.status === 'failed' ? 'bg-red-100 text-red-800' : 'bg-gray-100 text-gray-800')">
            {{ element.status | titlecase }}
          </span>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="hover:bg-gray-50"></tr>
    </table>
  </div>
}
