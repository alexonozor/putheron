 <div class="min-h-screen bg-gray-50">
  <!-- Header Section -->
  <div class="mb-8">
    <div class="lg:max-w-7xl max-w-12xl">
      <div class="px-6 pt-6">
        <app-dashboard-subheader 
          title="My Favorite Businesses" 
          subtitle="Businesses you've saved for easy access"
          [showBackButton]="false">
          <button matButton="filled" color="primary" (click)="searchBusinesses()" class="flex items-center">
            <mat-icon class="mr-2">search</mat-icon>
            Find More Businesses
          </button>
        </app-dashboard-subheader>
      </div>

      <!-- Search Filter and View Toggle -->
      <div class="px-0 sm:px-6 pt-4">
        <app-business-search-filter 
          [searchTerm]="searchTerm()" 
          [viewMode]="viewMode()"
          [hideViewModeToggle]="false"
          (searchChange)="searchTerm.set($event)" 
          (viewModeChange)="setViewMode($event)"
          (clearSearch)="clearSearch()">
        </app-business-search-filter>
      </div>
    </div>

    <!-- Error Display -->
    @if (error()) {
    <div class="mb-6 bg-red-50 border-l-4 border-red-400 p-4 rounded-r-lg">
      <div class="flex">
        <svg class="w-5 h-5 text-red-400 mr-3" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
        </svg>
        <div>
          <h3 class="text-sm font-medium text-red-800">Error</h3>
          <p class="mt-1 text-sm text-red-700">{{ error() }}</p>
        </div>
      </div>
    </div>
    }

    <!-- Loading State -->
    @if (loading()) {
    <div class="flex items-center justify-center min-h-screen">
      <mat-spinner [diameter]="60" [strokeWidth]="4"></mat-spinner>
    </div>
    } @else {
    <!-- Content -->
    @if (validFavorites().length === 0) {
    <!-- Empty State -->
    <div class="lg:max-w-7xl max-w-12xl px-6 pb-12">
      @if (searchTerm()) {
      <app-empty-state 
        icon="search_off"
        title="No favorites found"
        description="Try adjusting your search term to find what you're looking for."
        [buttons]="[{ label: 'Clear Search', callback: clearSearch }]">
      </app-empty-state>
      } @else {
      <app-empty-state 
        icon="favorite_border"
        title="No favorites yet"
        description="Start exploring and save businesses you're interested in for easy access later."
        [buttons]="[{ label: 'Explore Businesses', callback: searchBusinesses, icon: 'search' }]">
      </app-empty-state>
      }
    </div>
    } @else {
    <!-- Favorites Grid View -->
    @if (viewMode() === 'grid') {
    <div class="lg:max-w-7xl max-w-12xl px-6 pb-12">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        @for (favorite of validFavorites(); track favorite._id) {
          @if (getBusiness(favorite)) {
          <app-business-card 
            [business]="getBusiness(favorite)"
            [statusColorClass]="'bg-green-100 text-green-800'"
            [statusText]="'Active'"
            [categoryName]="getCategoryName(getBusiness(favorite))"
            [businessTypeColor]="'bg-blue-100 text-blue-800'"
            [businessTypeText]="'Service'"
            [showFavoriteButton]="true"
            [showEditDelete]="false"
            (view)="viewBusiness(getBusiness(favorite))"
            (edit)="viewBusiness(getBusiness(favorite))"
            (delete)="viewBusiness(getBusiness(favorite))">
          </app-business-card>
          }
        }
      </div>
    </div>
    } @else {
    <!-- Favorites List View -->
    <div class="lg:max-w-7xl max-w-12xl px-6 pb-12">
      <app-business-list-card 
        [businesses]="favoritesBusinesses()"
        [displayedColumns]="['logo', 'name', 'category', 'description', 'status', 'business_type', 'actions']"
        [showEditDelete]="false"
        [deleteLabel]="'Remove from Favorites'"
        [deleteIcon]="'favorite'"
        (view)="viewBusiness($event)"
        (edit)="editBusiness($event)"
        (delete)="deleteBusiness($event)">
      </app-business-list-card>
    </div>
    }
    }
    }
  </div>
</div>
