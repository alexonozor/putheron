<div class="min-h-screen bg-gray-50">
  <!-- Header Section -->
  <div class="mb-8 lg:max-w-7xl max-w-12xl">
    <div class="lg:max-w-7xl max-w-12xl">
      <div class="px-6 pt-6">
        <app-dashboard-subheader 
          title="Projects" 
          subtitle="Manage your project requests and business inquiries"
          (backClicked)="navigateToHome()">
        </app-dashboard-subheader>
      </div>
    </div>

    <!-- Error Display -->
    @if (error()) {
    <div class="px-0 sm:px-6 mb-6">
      <div class="bg-red-50 border-l-4 border-red-400 p-4 rounded-r-lg">
        <div class="flex">
          <mat-icon class="text-red-400 mr-3">error</mat-icon>
          <div>
            <h3 class="text-sm font-medium text-red-800">Error</h3>
            <p class="mt-1 text-sm text-red-700">{{ error() }}</p>
          </div>
        </div>
      </div>
    </div>
    }

    <!-- Loading State -->
    @if (loading()) {
    <div class="flex items-center justify-center ">
      <mat-spinner [diameter]="isMobile() ? 40 : 60" [strokeWidth]="4"></mat-spinner>
    </div>
    } @else {

    <!-- Search and Filter Controls -->
    <div class="px-0 sm:px-6 pt-4 ">
      <app-business-search-filter 
        [searchTerm]="searchTerm()" 
        [viewMode]="viewMode()"
        [hideViewModeToggle]="true"
        (searchChange)="searchTerm.set($event)" 
        (viewModeChange)="setViewMode($event)"
        (clearSearch)="clearSearch()">

        <!-- Project Type Filter -->
        <div class="w-full sm:w-48">
          <mat-form-field appearance="outline" subscriptSizing="dynamic" class="w-full">
            <mat-label>Project Type</mat-label>
            <mat-select [value]="projectType()" (selectionChange)="projectType.set($event.value)">
              <mat-option value="my_requests">My Requests</mat-option>
              <mat-option value="business_inquiries">Business Inquiries</mat-option>
            </mat-select>
            <mat-icon matPrefix>folder_outline</mat-icon>
          </mat-form-field>
        </div>

        <!-- Status Filter -->
        <div class="w-full sm:w-48">
          <mat-form-field appearance="outline" subscriptSizing="dynamic" class="w-full">
            <mat-label>Status</mat-label>
            <mat-select [value]="selectedStatus()" (selectionChange)="selectedStatus.set($event.value)">
              <mat-option value="all">All Status</mat-option>
              <mat-option value="requested">Requested</mat-option>
              <mat-option value="under_review">Under Review</mat-option>
              <mat-option value="accepted">Accepted</mat-option>
              <mat-option value="started">Started</mat-option>
              <mat-option value="completed">Completed</mat-option>
              <mat-option value="rejected">Rejected</mat-option>
              <mat-option value="cancelled">Cancelled</mat-option>
            </mat-select>
            <mat-icon matPrefix>info_outline</mat-icon>
          </mat-form-field>
        </div>

      </app-business-search-filter>
    </div>

    <!-- Content Section -->
    @if (filteredProjects().length === 0) {
    <!-- Empty State -->
    <div class="px-0 sm:px-6 pt-6">
      <app-empty-state 
        icon="assignment"
        title="No projects found"
        description="Try adjusting your filters to find what you're looking for."
        [buttons]="[{ label: 'Clear Filters', callback: handleClearFilters }]">
      </app-empty-state>
    </div>
    } @else {
    <!-- List View (Table) -->
    <div class="lg:max-w-7xl max-w-12xl px-0 sm:px-6 pb-12 pt-6">
      <app-project-list-card
        [projects]="filteredProjects()"
        [displayedColumns]="displayedColumns()"
        (view)="viewProject($event)"
        (accept)="acceptProject($event)"
        (reject)="rejectProject($event)">
      </app-project-list-card>
    </div>
    }
    }
  </div>
</div>
