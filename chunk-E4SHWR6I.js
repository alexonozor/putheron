import"./chunk-FNU2S2SM.js";import{a as Z,b as $}from"./chunk-7IB7WRLI.js";import{b as U,f as X,g as Y}from"./chunk-J73GYXEA.js";import{b as H,c as J,f as K,i as Q}from"./chunk-34MV7HGN.js";import"./chunk-EGMYPSOY.js";import{c as O,e as f,h as A,i as D,l as G,n as B,o as j,v as W,x as z}from"./chunk-Z3TDL5JS.js";import"./chunk-EW3JV62K.js";import"./chunk-MPYKQSNE.js";import{b as V,c as R,d as N,e as q}from"./chunk-XNH753K3.js";import{a as P}from"./chunk-7DY7X3OU.js";import{G as T,H as k}from"./chunk-T77N2UQ2.js";import"./chunk-7XH4VAXZ.js";import"./chunk-YYV7O7JP.js";import{Ba as w,Ga as d,Ja as S,Ka as c,Pa as s,S as p,Ua as o,Va as r,Wa as h,X as x,Y as y,_a as E,ab as _,bb as u,gc as M,ha as m,nb as a,ob as g,pc as L,rc as F,sa as l,sc as I,xb as b}from"./chunk-YOTEMOQK.js";import{d as v}from"./chunk-QEZ3K4DX.js";var te=()=>["/auth/forgot-password"],ie=()=>["/auth/signup"];function ne(e,t){e&1&&a(0," Email is required ")}function oe(e,t){e&1&&a(0," Invalid email format ")}function re(e,t){if(e&1&&(o(0,"mat-error"),d(1,ne,1,0)(2,oe,1,0),r()),e&2){let i=u();l(),s(i.emailControl!=null&&i.emailControl.hasError("required")?1:i.emailControl!=null&&i.emailControl.hasError("email")?2:-1)}}function ae(e,t){e&1&&a(0," Password is required ")}function le(e,t){e&1&&a(0," Minimum 6 characters ")}function se(e,t){if(e&1&&(o(0,"mat-error"),d(1,ae,1,0)(2,le,1,0),r()),e&2){let i=u();l(),s(i.passwordControl!=null&&i.passwordControl.hasError("required")?1:i.passwordControl!=null&&i.passwordControl.hasError("minlength")?2:-1)}}function me(e,t){if(e&1&&(o(0,"div",10)(1,"div",20)(2,"mat-icon",21),a(3,"info"),r(),o(4,"span",22),a(5),r()()()),e&2){let i=u();l(5),g(i.authMessage())}}function de(e,t){if(e&1){let i=E();o(0,"div",24)(1,"button",25),_("click",function(){x(i);let C=u(2);return y(C.resendVerification())}),a(2," Resend Verification Email "),r()()}if(e&2){let i=u(2);l(),c("disabled",i.loading())}}function ce(e,t){if(e&1&&(o(0,"div",11)(1,"div",23)(2,"mat-icon",21),a(3,"error"),r(),o(4,"span",22),a(5),r()(),d(6,de,3,1,"div",24),r()),e&2){let i=u();l(5),g(i.error()),l(),s(i.showResendOption()?6:-1)}}function ue(e,t){if(e&1&&(o(0,"div",12)(1,"div",26)(2,"mat-icon",21),a(3,"check_circle"),r(),o(4,"span",22),a(5),r()()()),e&2){let i=u();l(5),g(i.successMessage())}}function pe(e,t){e&1&&a(0," Sign In ")}function ge(e,t){e&1&&(o(0,"span",14),h(1,"mat-spinner",27),a(2," Signing In... "),r())}var ee=class e{authService=p(P);router=p(F);route=p(L);fb=p(W);error=m("");successMessage=m("");authMessage=m("");loading=m(!1);showPassword=m(!1);showResendOption=m(!1);unverifiedEmail=m("");loginForm;constructor(){this.loginForm=this.fb.group({email:["",[f.required,f.email]],password:["",[f.required,f.minLength(6)]]})}ngOnInit(){this.route.queryParams.subscribe(t=>{t.message&&this.authMessage.set(t.message),t.email&&this.loginForm.patchValue({email:t.email})})}onSubmit(){return v(this,null,function*(){if(this.clearMessages(),!this.loginForm.valid){this.error.set("Please fill in all required fields correctly");return}let{email:t,password:i}=this.loginForm.value;this.loading.set(!0);try{let n=yield this.authService.signIn(t,i);n.data?(this.successMessage.set("Login successful! Redirecting..."),setTimeout(()=>{this.router.navigate(["/dashboard"])},1e3)):this.handleLoginError(n.error?.message||"Login failed. Please try again.")}catch(n){this.handleLoginError(n?.message||"An unexpected error occurred. Please try again.")}finally{this.loading.set(!1)}})}handleLoginError(t){if(t.includes("verify your email")||t.includes("email address before logging")){this.error.set(t);let i=this.loginForm.get("email")?.value;i&&(this.unverifiedEmail.set(i),this.showResendOption.set(!0))}else this.error.set(t)}resendVerification(){return v(this,null,function*(){if(this.unverifiedEmail()){this.loading.set(!0);try{let t=yield this.authService.resendEmailVerification(this.unverifiedEmail());t.success?(this.successMessage.set("Verification email sent! Please check your inbox."),this.error.set(""),this.showResendOption.set(!1)):this.error.set(t.message||"Failed to resend verification email.")}catch(t){this.error.set(t?.message||"Failed to resend verification email.")}finally{this.loading.set(!1)}}})}togglePasswordVisibility(){this.showPassword.update(t=>!t)}clearMessages(){this.error.set(""),this.successMessage.set(""),this.authMessage.set("")}get emailControl(){return this.loginForm.get("email")}get passwordControl(){return this.loginForm.get("password")}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=w({type:e,selectors:[["app-login"]],decls:36,vars:18,consts:[[1,"login-container"],[1,"text-center","mb-8"],[1,"text-2xl","font-bold","text-gray-900","mb-2"],[1,"text-gray-600"],[1,"space-y-6",3,"ngSubmit","formGroup"],["appearance","outline",1,"w-full"],["matInput","","type","email","formControlName","email","placeholder","your@email.com",3,"disabled"],["matSuffix",""],["matInput","","formControlName","password","placeholder","Enter password",3,"type","disabled"],["mat-icon-button","","matSuffix","","type","button",3,"click"],[1,"mb-4","p-3","bg-blue-50","border","border-blue-200","rounded-lg"],[1,"mb-4","p-3","bg-red-50","border","border-red-200","rounded-lg"],[1,"mb-4","p-3","bg-green-50","border","border-green-200","rounded-lg"],["mat-raised-button","","color","primary","type","submit",1,"w-full","py-3","text-base","font-medium","mb-4",3,"disabled"],[1,"flex","items-center","justify-center","gap-2"],[1,"space-y-3","text-center"],["mat-button","","color","primary",1,"text-sm",3,"routerLink"],[1,"mt-4","pt-4","border-t","border-gray-200"],[1,"text-sm","text-gray-600"],["mat-button","","color","primary",1,"text-sm","font-medium","ml-1",3,"routerLink"],[1,"flex","items-center","text-blue-700"],[1,"mr-2","text-sm"],[1,"text-sm"],[1,"flex","items-center","text-red-700"],[1,"mt-3","pt-3","border-t","border-red-200"],["mat-stroked-button","","color","primary",1,"text-sm",3,"click","disabled"],[1,"flex","items-center","text-green-700"],["diameter","16"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"div",1)(2,"h2",2),a(3,"Welcome Back"),r(),o(4,"p",3),a(5,"Sign in to your account"),r()(),o(6,"form",4),_("ngSubmit",function(){return n.onSubmit()}),o(7,"mat-form-field",5)(8,"mat-label"),a(9,"Email Address"),r(),h(10,"input",6),o(11,"mat-icon",7),a(12,"email"),r(),d(13,re,3,1,"mat-error"),r(),o(14,"mat-form-field",5)(15,"mat-label"),a(16,"Password"),r(),h(17,"input",8),o(18,"button",9),_("click",function(){return n.togglePasswordVisibility()}),o(19,"mat-icon"),a(20),r()(),d(21,se,3,1,"mat-error"),r(),d(22,me,6,1,"div",10)(23,ce,7,2,"div",11)(24,ue,6,1,"div",12),o(25,"button",13),d(26,pe,1,0)(27,ge,3,0,"span",14),r(),o(28,"div",15)(29,"a",16),a(30," Forgot your password? "),r(),o(31,"div",17)(32,"p",18),a(33," Don't have an account? "),o(34,"a",19),a(35," Sign up "),r()()()()()()),i&2&&(l(6),c("formGroup",n.loginForm),l(4),c("disabled",n.loading()),l(3),s(n.emailControl!=null&&n.emailControl.invalid&&(n.emailControl!=null&&n.emailControl.touched)?13:-1),l(4),c("type",n.showPassword()?"text":"password")("disabled",n.loading()),l(),S("aria-label","Toggle password visibility")("aria-pressed",n.showPassword()),l(2),g(n.showPassword()?"visibility_off":"visibility"),l(),s(n.passwordControl!=null&&n.passwordControl.invalid&&(n.passwordControl!=null&&n.passwordControl.touched)?21:-1),l(),s(n.authMessage()?22:-1),l(),s(n.error()?23:-1),l(),s(n.successMessage()?24:-1),l(),c("disabled",n.loading()||!n.loginForm.valid),l(),s(n.loading()?27:26),l(3),c("routerLink",b(16,te)),l(5),c("routerLink",b(17,ie)))},dependencies:[M,z,G,O,A,D,B,j,I,U,Q,H,J,K,Y,X,q,N,R,V,k,T,$,Z],styles:["[_nghost-%COMP%]{display:block}"]})};export{ee as LoginComponent};
